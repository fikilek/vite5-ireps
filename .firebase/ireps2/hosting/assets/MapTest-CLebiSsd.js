import{r as d,s as h,c as M,q as b,e as w,w as m,f as E,j as o,t as j,P as x,d as I,y as _,z as k}from"./index-D5HP0Wxa.js";import{u as B}from"./useAstsMap-W_Vr5JQm.js";import{u as D}from"./useErfs-BdV2Y9Xx.js";import{M as z}from"./index.esm-DxCoFhVD.js";import{z as p}from"./za_kzn_umgungundlovu_mpofana_w1-CZ0tBZXl.js";import"./useTrns-CcwdEWrT.js";try{let r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new r.Error().stack;n&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[n]="aa08c54d-083c-46e2-a1fe-5081335969c2",r._sentryDebugIdIdentifier="sentry-dbid-aa08c54d-083c-46e2-a1fe-5081335969c2")}catch{}const A=()=>{var c,i;const[r,n]=d.useState(),t=h();let u=M(I,"erfs");const f=d.useMemo(()=>b(u,m("address.lmMetro","==","Mpofana LM"),m("address.ward","==","1"),w("metadata.updatedAtDatetime","desc")),[u]);return d.useEffect(()=>{E(f,e=>{const s=[];e.docs.forEach(a=>{s.push({id:a.id,...a.data()})}),n(s)},e=>{console.log("firestore err",e.message)})},[]),(c=t==null?void 0:t.data)==null||c.loadGeoJson(p,p),(i=t.data)==null||i.setStyle(e=>({fillOpacity:0,strokeWeight:.1,strokeColor:"blue"})),d.useEffect(()=>{C().then(e=>{let s=new window.google.maps.LatLngBounds;e.features[0].geometry.coordinates[0][0].forEach(a=>{s.extend({lat:a[1],lng:a[0]})}),t==null||t.fitBounds(s)})},[t]),o.jsx("div",{children:o.jsx(P,{erfs:r})})},C=async()=>await(await fetch(p)).json(),P=r=>{const{erfs:n}=r,t=h(),[u,f]=d.useState({}),c=d.useRef(null);d.useEffect(()=>{t&&(c.current||(c.current=new z({map:t})))},[t]),d.useEffect(()=>{var e,s;(e=c.current)==null||e.clearMarkers(),(s=c.current)==null||s.addMarkers(Object.values(u))},[u]);const i=(e,s)=>{e&&u[s]||!e&&!u[s]||f(a=>{if(e)return{...a,[s]:e};{const l={...a};return delete l[s],l}})};return o.jsx(o.Fragment,{children:n==null?void 0:n.map(e=>{var s,a,l,g;return o.jsx(j,{position:{lat:(a=(s=e==null?void 0:e.address)==null?void 0:s.gps)==null?void 0:a.latitude,lng:(g=(l=e==null?void 0:e.address)==null?void 0:l.gps)==null?void 0:g.longitude},ref:y=>i(y,e.id),children:o.jsx(x,{background:"#FBBC04",glyphColor:"#000",borderColor:"#000"})},e.id)})})},O=()=>(D(),B(),o.jsx("div",{className:"map-test",children:o.jsx(_,{apiKey:"AIzaSyDKsugznrX_Zh0u73iZ0HsOo47QTE8KRjc",onLoad:()=>console.log("Maps API has loaded."),onError:()=>console.log("There was an error on iREPS Map"),children:o.jsx(k,{defaultZoom:13,defaultCenter:{lat:-33.860664,lng:151.208138},gestureHandling:"greedy",disableDefaultUI:!1,mapId:"eab81cec6c21fbbc",children:o.jsx(A,{})})})}));export{O as default};
//# sourceMappingURL=MapTest-CLebiSsd.js.map
