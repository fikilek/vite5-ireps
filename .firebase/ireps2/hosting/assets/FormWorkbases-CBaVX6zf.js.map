{"version":3,"file":"FormWorkbases-CBaVX6zf.js","sources":["../../src/components/forms/auth/FormWorkbases.jsx"],"sourcesContent":["import { Formik, Form, FieldArray, Field } from \"formik\";\nimport { object } from \"yup\";\nimport { useEffect } from \"react\";\nimport { toast } from \"react-toastify\";\nimport { useSignup } from \"@/hooks/useSignup\";\nimport Select from \"react-select\";\nimport { IconContext } from \"react-icons\";\nimport { MdOutlineDeleteForever } from \"react-icons/md\";\n\n// css\nimport \"@/components/forms/Form.css\";\nimport \"@/components/forms/auth/FormWorkbases.css\";\n\n// custom hooks\nimport useModal from \"@/hooks/useModal.jsx\";\nimport { useFirestore } from \"@/hooks/useFirestore\";\n\n// context\nimport useAuthContext from \"@/hooks/useAuthContext.jsx\";\n\n// components\n// import FormikControl from \"@/components/forms/formik/FormikControl\";\nimport FormFooter from \"@/components/forms/formFooter/FormFooter\";\nimport FormMsg from \"@/components/forms/formMsg/FormMsg\";\nimport FormError from \"@/components/forms/formError/FormError\";\nimport HeaderGeneric from \"@/components/header/HeaderGeneric\";\nimport FormCloseBtn from \"@/components/forms/formBtns/FormCloseBtn\";\nimport { useState } from \"react\";\n\n// other\nimport za_lmsMetros from \"@/maps/za/za_lmsMetros.json\";\n// console.log(`za_lmsMetros`, za_lmsMetros)\n\nconst FormWorkbases = (props) => {\n\t// console.log(`props`, props);\n\n\tconst { response, getDocument } = useFirestore(\"users\");\n\t// console.log(`response`, response);\n\t// console.log(`getDocument`, getDocument);\n\n\tconst { user } = useAuthContext();\n\t// console.log(`user`, user);\n\n\t// get user uid from userContext\n\tconst { uid } = props?.data?.data;\n\t// console.log(`uid`, uid);\n\n\tconst [userInfo, setUserInfo] = useState({});\n\t// console.log(`userInfo`, userInfo);\n\n\tconst { closeModal } = useModal();\n\n\tconst { updateUserObject, signupState } = useSignup();\n\n\tconst options = [];\n\tza_lmsMetros &&\n\t\tza_lmsMetros.forEach((sp) => {\n\t\t\toptions.push({\n\t\t\t\tlabel: sp.lm,\n\t\t\t\tvalue: sp.lm,\n\t\t\t\tdata: sp,\n\t\t\t});\n\t\t});\n\n\tconst initialValues = { workbases: userInfo?.workbases };\n\n\tconst onSubmit = (values) => {\n\t\t// console.log(`Form values`, values);\n\t\tupdateUserObject(values, uid);\n\t};\n\n\tconst validationSchema = object({\n\t\t// workbases: array().required(\"Workbase is required.\"),\n\t});\n\n\tuseEffect(() => {\n\t\tif (signupState.success) {\n\t\t\tcloseModal();\n\t\t\ttoast.success(\n\t\t\t\t`User workbases for \"${userInfo.surname} ${userInfo.name}\", succesfully updated.`,\n\t\t\t\t{\n\t\t\t\t\tposition: \"bottom-left\",\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}, [signupState.success, closeModal]);\n\n\tuseEffect(() => {\n\t\tif (response.success) {\n\t\t\t// console.log(`response`, response);\n\t\t\tsetUserInfo(response.document);\n\t\t}\n\t}, [response]);\n\n\tuseEffect(() => {\n\t\tgetDocument(uid);\n\t}, [uid]);\n\n\tconst clearValue = (e) => {\n\t\tconsole.log(`clearing selected value`, e);\n\t\treturn null;\n\t};\n\n\tconst customStyles = {\n\t\tcontrol: (provided) => ({\n\t\t\t...provided,\n\t\t\tbackgroundColor: \"lightgray\",\n\t\t\tpadding: \"0.11rem\",\n\t\t\t// border: \"1px solid black\",\n\t\t\t// boxShadow: \"0 2px 4px rgba(0,0,0,.2)\",\n\t\t}),\n\t\toption: (provided, state) => ({\n\t\t\t...provided,\n\t\t\tborderBottom: \"1px dotted pink\",\n\t\t\tcolor: state.isSelected ? \"white\" : \"black\",\n\t\t\tbackgroundColor: state.isSelected ? \"hotpink\" : \"white\",\n\t\t}),\n\t};\n\n\treturn (\n\t\t<div className=\"form-wrapper\">\n\t\t\t<div className=\"form-container form-workbases\">\n\t\t\t\t<Formik\n\t\t\t\t\tinitialValues={initialValues}\n\t\t\t\t\tonSubmit={onSubmit}\n\t\t\t\t\tenableReinitialize={true}\n\t\t\t\t\t// validationSchema={validationSchema}\n\t\t\t\t>\n\t\t\t\t\t{(formik) => {\n\t\t\t\t\t\t// console.log(`formik`, formik);\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t<Form>\n\t\t\t\t\t\t\t\t\t<HeaderGeneric\n\t\t\t\t\t\t\t\t\t\thl1={`${userInfo.surname} ${userInfo.name} workbases`}\n\t\t\t\t\t\t\t\t\t\thr1={<p>{userInfo.workbase}</p>}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<FormCloseBtn />\n\t\t\t\t\t\t\t\t\t</HeaderGeneric>\n\n\t\t\t\t\t\t\t\t\t<FormMsg\n\t\t\t\t\t\t\t\t\t\tmsg={`Update user workbases allowed for the user: ${userInfo.surname} ${userInfo.name}`}\n\t\t\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t\t\t<div className=\"possible-workbases\">\n\t\t\t\t\t\t\t\t\t\t{/* workbases */}\n\t\t\t\t\t\t\t\t\t\t<FieldArray\n\t\t\t\t\t\t\t\t\t\t\tname=\"workbases\"\n\t\t\t\t\t\t\t\t\t\t\trender={(arrayHelpers) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"workbase-wrapper\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdefaultValue={\"workbase\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={options}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t// isClearable={true}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={(selection) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(`selection`, selection);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tarrayHelpers.push(selection.value);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclearValue={clearValue}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyles={customStyles}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t{formik.values?.workbases &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tformik.values?.workbases.map((friend, index) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div key={index} className=\"workbase-field\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Field name={`workbases.${index}`} />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => arrayHelpers.remove(index)} // remove a friend from the list\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<IconContext.Provider\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcolor: \"blue\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t// className: \"global-class-name\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfontSize: \"2rem\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<MdOutlineDeleteForever />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</IconContext.Provider>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t{signupState.error && (\n\t\t\t\t\t\t\t\t\t\t<FormError errorMsg={signupState.error} />\n\t\t\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t\t\t<FormFooter formik={formik} signState={signupState} />\n\t\t\t\t\t\t\t\t</Form>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t);\n\t\t\t\t\t}}\n\t\t\t\t</Formik>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default FormWorkbases;\n"],"names":["FormWorkbases","props","response","getDocument","useFirestore","useAuthContext","uid","_a","userInfo","setUserInfo","useState","closeModal","useModal","updateUserObject","signupState","useSignup","options","za_lmsMetros","sp","initialValues","onSubmit","values","object","useEffect","toast","clearValue","e","customStyles","provided","state","jsx","Formik","formik","Fragment","Form","HeaderGeneric","FormCloseBtn","FormMsg","FieldArray","arrayHelpers","jsxs","Select","selection","_b","friend","index","Field","IconContext","MdOutlineDeleteForever","FormError","FormFooter"],"mappings":"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"}