import{j as e,r as l,A as E,i as R,u as _,w as F,o as q,q as O,c as G,d as K,e as H,f as $,F as m}from"./index-6XIBjwph.js";import{e as v,a as h,b as z,c as J,d as L,F as Q}from"./FilterUpdatedAtDatetime-tIUIcDib.js";import{u as V}from"./useTrns-CQLve5mV.js";import{a as X}from"./useAsts-DX4pH2K5.js";import"./useErfs-BpdIY8di.js";try{let t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},s=new t.Error().stack;s&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[s]="3e50deec-b3d2-4641-b931-840de9b61593",t._sentryDebugIdIdentifier="sentry-dbid-3e50deec-b3d2-4641-b931-840de9b61593")}catch{}const Y=()=>e.jsx("div",{className:"filter-reports",children:e.jsxs("div",{className:"filter-report-body",children:[e.jsx(v,{title:"Meters Per User Stats",name:"users"}),e.jsx(v,{title:"Meters Type Per User Stats",name:"meterType"}),e.jsx(v,{title:"Meters Anomalies Per User Stats",name:"anomalies"})]})});function Z(){for(var t="0123456789ABCDEF",s="#",r=0;r<6;r++)s+=t[Math.floor(Math.random()*16)];return s}const ee=t=>{const{astsContext:s,setAstsContext:r}=l.useContext(E),{astsStatsContext:o,setAstsStatsContext:c}=l.useContext(R),[i,S]=l.useState([]),[b,j]=l.useState(""),{getDocument:T}=V("users"),{user:N}=_(),{getAstsUsersStats:U,getMeterTypePerUserStats:D,getAnomalyPerUserStats:M}=X(),{uid:P}=N;return l.useEffect(()=>{T(P).then(u=>{const{workbase:d}=u==null?void 0:u.doc;S(d),j("")})},[]),{error:b,getAsts:u=>{let d=F("erf.address.lmMetro","==",i);u?d=[d,...u]:d=[q(d,F("astData.astState.state","==","stores"))];const w=O(G(K,t),...d,H("metadata.updatedAtDatetime","desc"));j(""),$(w,x=>{var A;const a=[];x.docs.forEach(n=>{a.push({id:n.id,...n.data()})});const B=U(a),k=D(a),I=M(a),p={};a==null||a.forEach(n=>{p[n.metadata.createdByUid]=1+(p[n.metadata.createdByUid]||0)});const g=[];for(const n in p){const f=a.find(C=>{var y;return((y=C==null?void 0:C.metadata)==null?void 0:y.createdByUid)===n}),W=(p[n]/(a==null?void 0:a.length)*100).toFixed(2);g.push({uid:n,displayName:(A=f==null?void 0:f.metadata)==null?void 0:A.createdByUser,quantity:p[n],percentage:W,fillColor:Z()})}r({...s,asts:a,statsCreatedAtDatetimeByUser:g}),c(n=>({...n,statsAstsUsers:B,meterTypePerUserStats:k,anomalyPerUserStats:I}))},x=>{console.log("firestore err",x.message),j(x.message)})}}},te=()=>{const{filtersContext:t,setFiltersContext:s}=l.useContext(m),{geographicArea:r}=t==null?void 0:t.filterCondition,o=!r,c=i=>{console.log("e.currentTarget.value",i.currentTarget.value),s({...t,filterCondition:{...t.filterCondition,geographicArea:i.currentTarget.value}})};return e.jsx("div",{className:"filter-geographic-area",children:e.jsxs("select",{className:"fga-select",onChange:c,children:[e.jsx("option",{selected:o,value:"",children:"Select Filter"}),e.jsx("option",{value:"Ward1",children:"Ward 1"}),e.jsx("option",{value:"Ward2",children:"Ward 2"}),e.jsx("option",{value:"Ward3",children:"Ward 3"}),e.jsx("option",{value:"Ward4",children:"Ward 4"}),e.jsx("option",{value:"Custom Area 1",children:"Custom Area 1"}),e.jsx("option",{value:"Custom Area 2",children:"Custom Area 2"}),e.jsx("option",{value:"Custom Area 3",children:"Custom Area 3"}),e.jsx("option",{value:"Custom Area 4",children:"Custom Area 4"})]})})},se=()=>{const{filtersContext:t,setFiltersContext:s}=l.useContext(m),{astCreation:r}=t==null?void 0:t.filterCondition,o=!r,c=i=>{s({...t,filterCondition:{...t.filterCondition,astCreation:i.currentTarget.value}})};return e.jsx("div",{className:"filter-ast-creation-process",children:e.jsxs("select",{className:"fga-select",onChange:c,children:[e.jsx("option",{selected:o,value:"",children:"Select Filter"}),e.jsx("option",{value:"audit",children:"Audits"}),e.jsx("option",{value:"installation",children:"Installations"})]})})},re=()=>{const{filtersContext:t,setFiltersContext:s}=l.useContext(m),{astState:r}=t==null?void 0:t.filterCondition,o=!r,c=i=>{s({...t,filterCondition:{...t.filterCondition,astState:i.currentTarget.value}})};return e.jsx("div",{className:"filter-ast-state",children:e.jsxs("select",{className:"fas-select",onChange:c,children:[e.jsx("option",{selected:o,value:"",children:"Select Filter"}),e.jsx("option",{value:"stores",children:"Stores"}),e.jsx("option",{value:"checkedOutPending",children:"Checked Out Pending"}),e.jsx("option",{value:"checkedOut",children:"Checked Out"}),e.jsx("option",{value:"field",children:"Field"}),e.jsx("option",{value:"service",children:"Service"}),e.jsx("option",{value:"disconnected",children:"Disconnected"}),e.jsx("option",{value:"decommissioned",children:"Decommissioned"})]})})},ae=()=>{const{filtersContext:t,setFiltersContext:s}=l.useContext(m),{astMeterType:r}=t==null?void 0:t.filterCondition,o=!r,c=i=>{s({...t,filterCondition:{...t.filterCondition,astMeterType:i.currentTarget.value}})};return e.jsx("div",{className:"meter-type",children:e.jsxs("select",{className:"mt-select",onChange:c,children:[e.jsx("option",{selected:o,value:"",children:"Select Filter"}),e.jsx("option",{value:"pre-paid",children:"Pre-paid"}),e.jsx("option",{value:"conventional",children:"Conventional"})]})})},ne=()=>{const{getAsts:t}=ee("asts");return e.jsxs("div",{className:"filter-data-filter",children:[e.jsxs("div",{className:"filter-items",children:[e.jsx(h,{title:"Filter-CreatedAtDatetime",name:"dateRange",value:"created",children:e.jsx(z,{})}),e.jsx(h,{title:"Filter-UpdatedAtDatetime",name:"dateRange",value:"updated",children:e.jsx(J,{})}),e.jsx(h,{title:"Filter-Ast Creation",name:"astCreation",value:"astCreation",children:e.jsx(se,{})}),e.jsx(h,{title:"Filter-Meter Type",name:"astMeterType",value:"astMeterType",children:e.jsx(ae,{})}),e.jsx(h,{title:"Filter-Ast State",name:"astState",value:"astState",children:e.jsx(re,{})}),e.jsx(h,{title:"Filter-Geographic Area",name:"geographicArea",value:"geographicArea",children:e.jsx(te,{})})]}),e.jsx(L,{getData:t})]})},oe=()=>e.jsx("div",{className:"filter-columns",children:e.jsxs("label",{className:"fc-select-all",children:[e.jsx("span",{children:"Select all"}),e.jsx("input",{name:"All",type:"radio"})]})}),ie=t=>{const{active:s,irepsKeyItem:r}=t;return e.jsxs("div",{className:"filters-body",children:[s==="reportFilters"?e.jsx(ne,{irepsKeyItem:r}):"",s==="reportStats"?e.jsx(Y,{irepsKeyItem:r}):""," ",s==="columnFilters"?e.jsx(oe,{irepsKeyItem:r}):""]})},xe=t=>{const{irepsKeyItem:s}=t,[r,o]=l.useState("reportFilters");return e.jsxs("div",{className:"filters",children:[e.jsx(Q,{active:r,setActive:o,irepsKeyItem:s}),e.jsx(ie,{active:r,setActive:o,irepsKeyItem:s})]})};export{xe as default};
//# sourceMappingURL=Filters-Dn0W9mJ8.js.map
