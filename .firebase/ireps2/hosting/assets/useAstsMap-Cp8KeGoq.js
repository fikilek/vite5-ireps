import{r as f,u as g,q as A,e as C,w as v,c as B,d as x,f as T,n as G,j as m,s as M,t as b,I,v as $}from"./index-B2W70YXr.js";import{u as F}from"./useTrns-DpjEOOia.js";import{T as j}from"./useErfs-nqTqG9Ui.js";try{let r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},h=new r.Error().stack;h&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[h]="8bab4538-f042-4f97-a7c3-4df5af503589",r._sentryDebugIdIdentifier="sentry-dbid-8bab4538-f042-4f97-a7c3-4df5af503589")}catch{}const k=r=>{const[h,w]=f.useState([]),[e,t]=f.useState(""),{getDocument:a}=F("users"),{user:d}=g(),s=d==null?void 0:d.uid;return f.useEffect(()=>{a(s).then(o=>{const{workbase:i}=o==null?void 0:o.doc,n=A(B(x,r),v("erf.address.lmMetro","==",i),C("metadata.updatedAtDatetime","desc"));t(""),T(n,l=>{const c=[];l.docs.forEach(u=>{c.push({id:u.id,...u.data()})}),w(c)},l=>{console.log("firestore err",l.message),t(l.message)}),t("")})},[]),{asts:h,error:e}},P=()=>{const{asts:r,error:h}=k("asts");return{asts:r,astsTableFields:[{field:"id",headerName:"System Id",width:200,hide:!0},{headerName:"Created",children:[{field:"metadata.createdByUser",columnGroupShow:"closed",headerName:"Created By",width:150,hide:!1},{field:"metadata.createdByUser",columnGroupShow:"open",headerName:"Created By",width:150,hide:!1},{field:"metadata.createdAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:e=>{const a=new G(e.value.seconds,e.value.nanoseconds).toDate();return m.jsx(M,{date:a,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:e=>e.data.metadata.createdAtDatetime,hide:!1}]},{headerName:"Updated",children:[{field:"metadata.updatedByUser",columnGroupShow:"closed",headerName:"Updated By",width:150,hide:!1},{field:"metadata.updatedByUser",columnGroupShow:"open",headerName:"Updated By",width:150,hide:!1},{field:"metadata.updatedAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:e=>{const a=new G(e.value.seconds,e.value.nanoseconds).toDate();return m.jsx(M,{date:a,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:e=>e.data.metadata.updatedAtDatetime,hide:!1}]},{field:"erf.erfNo",headerName:"Erf No",width:100,tooltipField:"Erf the ast belong to"},{headerName:"Meter Description",children:[{field:"astData.astNo",headerName:"Meter No",width:170,columnGroupShow:"closed",hide:!1},{field:"astData.astCatergory",headerName:"Catergory",columnGroupShow:"open",width:150,hide:!0},{field:"astData.astManufacturer",headerName:"Manufacturer (Brand)",columnGroupShow:"open",width:200,hide:!1},{field:"astData.astName",headerName:"Ast Technical Name",columnGroupShow:"open",width:150,hide:!1},{field:"astData.astState",headerName:"State",columnGroupShow:"open",width:150,hide:!1}]},{field:"",headerName:"Meter Media",width:150,cellRenderer:e=>m.jsx(b,{data:e,children:e.value}),cellRendererParams:{modalName:"mediaMobileAsts",width:"4rem",irepsKeyItem:"asts",displayMode:"modal"},valueGetter:e=>{var a,d,s,o;return(d=(a=e==null?void 0:e.data)==null?void 0:a.media)!=null&&d.length?(o=(s=e==null?void 0:e.data)==null?void 0:s.media)==null?void 0:o.length:0}},{field:"astData.astState.state",headerName:"Meter State",width:250,valueGetter:e=>{var a,d,s,o,i,n,l,c,u,p,N,S,y,D;let t="";return((a=e.data)==null?void 0:a.astData.astState.state)==="stores"&&(t=`${(d=e.data)==null?void 0:d.astData.astState.state} : ${(s=e.data)==null?void 0:s.astData.astState.location}`),((o=e.data)==null?void 0:o.astData.astState.state)==="service"&&(t=`service : ${(i=e.data)==null?void 0:i.erf.address.lmMetro} - ${(n=e.data)==null?void 0:n.erf.erfNo}`),((l=e.data)==null?void 0:l.astData.astState.state)==="temper"&&(t=`temper : ${(c=e.data)==null?void 0:c.erf.address.lmMetro} - ${(u=e.data)==null?void 0:u.erf.erfNo}`),(((p=e.data)==null?void 0:p.astData.astState.state)==""||((N=e.data)==null?void 0:N.astData.astState.state)==null||((S=e.data)==null?void 0:S.astData.astState.state)==null)&&(t=`service : ${(y=e.data)==null?void 0:y.erf.address.lmMetro} - ${(D=e.data)==null?void 0:D.erf.erfNo}`),t}},{field:"trns",headerName:"Trns On Meter",width:320,cellRenderer:j,hide:!1,valueGetter:e=>e.data},{field:"location.gps",columnGroupShow:"closed",headerName:"Meter on Map",cellRenderer:e=>m.jsx(b,{data:e,children:m.jsx(I.Provider,{value:{color:"blue",fontSize:"1rem"},children:m.jsx($,{})})}),cellRendererParams:{modalName:"showAstOnMap",width:"3rem"},valueGetter:e=>{var d,s,o,i,n,l;const t=Number((o=(s=(d=e.data)==null?void 0:d.location)==null?void 0:s.gps)==null?void 0:o.lat),a=Number((l=(n=(i=e.data)==null?void 0:i.location)==null?void 0:n.gps)==null?void 0:l.lng);return`${t.toFixed(3)} / ${a.toFixed(3)}`},width:140},{headerName:"Meter Specific Data",children:[{field:"astData.meter.type",headerName:"Meter Type",width:150,hide:!1},{field:"astData.meter.phase",headerName:"Meter Phase",width:150,hide:!1}]},{headerName:"Anomalies",children:[{field:"anomalies.anomaly",columnGroupShow:"closed",headerName:"Anomaly",width:200},{field:"anomalies.anomalyDetail",columnGroupShow:"open",headerName:"Anomaly Detail",width:300}]},{headerName:"Meter Location",children:[{field:"location.address",columnGroupShow:"closed",headerName:"Ast Address",width:450},{field:"location.premises",columnGroupShow:"closed",headerName:"Premises",width:120},{field:"location.insideBox",columnGroupShow:"closed",headerName:"InsideBox",width:120}]},{headerName:"Keypad",children:[{field:"astData.meter.keypad.keypadAccess",columnGroupShow:"open",headerName:"Keypad Access?",width:150},{field:"astData.meter.keypad.serialNo",columnGroupShow:"open",headerName:"Keypad Serial No",width:160},{field:"astData.meter.keypad.comment",columnGroupShow:"open",headerName:"Keypad Comment",width:300}]},{headerName:"Circuit Breaker (CB)",children:[{field:"astData.meter.cb.isThereCb",columnGroupShow:"open",headerName:"CB There?",width:150},{field:"astData.meter.cb.size",columnGroupShow:"open",headerName:"CB (Amps)",width:150},{field:"astData.meter.cb.comment",columnGroupShow:"open",headerName:"CB Comment",width:300}]},{headerName:"Seal",children:[{field:"astData.meter.seal.meterSealed",columnGroupShow:"open",headerName:"Meter Sealed?",width:150},{field:"astData.meter.seal.sealNo",columnGroupShow:"open",headerName:"Seal No",width:150},{field:"astData.meter.seal.comment",columnGroupShow:"open",headerName:"Seal Comment",width:300}]},{field:"serviceConnection.configuration",columnGroupShow:"open",headerName:"Service Connection",width:300}],error:h}};export{P as u};
//# sourceMappingURL=useAstsMap-Cp8KeGoq.js.map
