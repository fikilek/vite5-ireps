import{r as f,j as i,a5 as N,B as D,u as g,a6 as w,a7 as C,a8 as x,a9 as R,Y as v,n as E,m as y}from"./index-D5HP0Wxa.js";import{M,C as j,A as p,T}from"./ag-theme-quartz-4EG4JaG4.js";try{let t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},r=new t.Error().stack;r&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[r]="ddf8a8ac-77f1-437f-b5a6-1ef9cd34b2eb",t._sentryDebugIdIdentifier="sentry-dbid-ddf8a8ac-77f1-437f-b5a6-1ef9cd34b2eb")}catch{}M.registerModules([j]);const U=t=>{const{rowData:r,colDefs:a}=t,u=f.useMemo(()=>({sortable:!0,filter:!0,resizable:!0,floatingFilter:!0,suppressMovable:!0}),[]),s=l=>l.data.id,o={"row-disabled":l=>{var d;return(d=l==null?void 0:l.data)==null?void 0:d.disabled}};return i.jsx("div",{className:"ag-theme-quartz table table-users",children:i.jsx(p,{rowData:r,columnDefs:a,defaultColDef:u,pagination:!0,noRowsOverlayComponent:T,getRowId:s,rowClassRules:o,reactiveCustomComponents:!0})})},S=t=>{var m;const{roles:r}=(m=t==null?void 0:t.data)==null?void 0:m.customClaims,{customClaims:a,setCustomClaims:u}=f.useContext(N),[s,o]=f.useState({}),{uid:l}=t==null?void 0:t.data,d=a==null?void 0:a.uid;f.useEffect(()=>{l===d&&a.roles?o(a.roles):o(r)},[a]);const{openModal:e}=D(),{user:n}=g();l===n.uid||t.data.disabled;const c=b=>{u({uid:l,roles:s}),e({modalName:"editUserRoles",payload:t.data})};return i.jsx("div",{className:"table-users-roles",children:w&&w.map(b=>{console.log("role",b);const h=s[b.key]?"hasRole":"";return i.jsx("button",{className:`table-btn ${h}`,title:b.name,onClick:c,children:b.abbreviation},b.name)})})},A=t=>{const{value:r,options:a,onValueChange:u}=t,s=C(),o=x(s,"disableUserAcc"),l=d=>{u(d.target.value),t.api.redrawRows(),o({uid:t.data.uid,action:d.target.value==="disabled"}).then(e=>{R.success(`User acc [${t.data.displayName}] succesfully ${d.target.value==="disabled"?"DISABLED":"ENABLED"}  `,{position:"bottom-left"})}).catch(e=>{console.log("Error:",e.message)})};return i.jsx("div",{className:"table-user-acc-disable-select",children:i.jsx("select",{value:r,className:"table-btn",onChange:l,children:a&&a.map(d=>i.jsx("option",{value:d,children:d},d))})})},I=t=>{const[r,a]=f.useState([]),{user:u}=g(),{data:s}=v("users",null),o=C(),l=x(o,"listAllUsers");return f.useEffect(()=>{u&&l().then(e=>{var c;let n=[];(c=e==null?void 0:e.data)==null||c.forEach(m=>{const b=s.find(h=>m.uid===h.id);b&&n.push({...m,companyName:b.companyName,workbase:b.workbase,phoneNumber:b.phoneNumber})}),a(n)})},[s,u]),{usersTableFields:[{field:"uid",headerName:"users Id",width:250,hide:!0},{field:"disabled",headerName:"Acc Status?",width:150,editable:!0,cellEditor:A,cellEditorParams:{options:["enabled","disabled"]},valueGetter:e=>e.data.disabled?"disabled":"enabled",valueSetter:e=>(e.data.disabled=e.newValue==="disabled",!0),cellStyle:e=>{const{uid:n}=e.data;return n===u.uid?{color:"grey",fontWeight:"700",pointerEvents:"none",cursor:"none",borderLeft:"0.3rem solid grey"}:""}},{field:"workbase",headerName:"Workbase",width:180,cellRenderer:e=>i.jsx(E,{data:e,children:e.value}),cellRendererParams:{modalName:"workbases",width:"8rem"}},{field:"metadata.creationTime",headerName:"Date Created",width:180,cellRenderer:e=>{var c;const n=new Date((c=e.data.metadata)==null?void 0:c.creationTime);return i.jsx(y,{date:n,dateFormat:"yyyy-MMM-dd HH:mm"})}},{field:"metadata.lastSignInTime",headerName:"Last Signin",width:180,cellRenderer:e=>{var c;const n=new Date((c=e.data.metadata)==null?void 0:c.lastSignInTime);return i.jsx(y,{date:n,dateFormat:"yyyy-MMM-dd HH:mm"})}},{field:"displayName",headerName:"Display Name",width:170},{field:"email",headerName:"Email Adr",width:200},{field:"emailVerified",headerName:"Email Verified",width:150,cellRenderer:e=>i.jsx("p",{children:e.data.emailVerified?"Yes":"No"})},{field:"customClaims.roles",headerName:"Roles",width:220,cellRenderer:S,valueGetter:e=>e.value},{field:"phoneNumber",headerName:"Phone Number",width:150},{field:"companyName",headerName:"Company Name",width:170}],users:r}},B=()=>{const{usersTableFields:t,users:r}=I(),[a,u]=f.useState([]),{customClaims:s}=f.useContext(N);return f.useEffect(()=>{u(r)},[r]),f.useEffect(()=>{if(!s)return;const o=a.find(n=>n.uid===(s==null?void 0:s.uid)),l={...o,customClaims:{...o==null?void 0:o.customClaims,roles:s==null?void 0:s.roles}},d=a.findIndex(n=>n.uid===(s==null?void 0:s.uid));if(d===-1)return;const e=a==null?void 0:a.with(d,l);u(e)},[s]),i.jsx("div",{className:"table",children:i.jsx(U,{rowData:a,colDefs:t})})};export{B as default};
//# sourceMappingURL=Users-Bt5Xzb3J.js.map
