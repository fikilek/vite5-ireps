import{u as E,n as h,ab as P,d as j,aA as V,aB as W,av as K,h as F,r as C,T as $,b as Z,w as J,q as Q,e as X,c as Y,f as x,aC as ee,an as o,ao as n,aw as N,aD as q,j as c,s as w,t as D,I as O,v as k,p as z}from"./index-CHax9ClH.js";try{let i=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},l=new i.Error().stack;l&&(i._sentryDebugIds=i._sentryDebugIds||{},i._sentryDebugIds[l]="f0900453-3499-4fc0-853e-fa3e585e859a",i._sentryDebugIdIdentifier="sentry-dbid-f0900453-3499-4fc0-853e-fa3e585e859a")}catch{}const te=i=>{const{user:l}=E();return{updateDocument:async(f,y)=>{f={...f,"metadata.updatedAtDatetime":h.now(),"metadata.updatedByUser":l.displayName,"metadata.updatedByUid":l.uid,updateHistory:!0};const a=P(j,i,y);try{return await V(a,f),{success:!0}}catch(r){return console.log("ERROR: ",r.message),{success:!1,msg:r.message}}},getDocument:async f=>{try{const y=P(j,i,f),a=await W(y);return a.exists()?{success:!0,doc:{id:a.id,...a.data()}}:{success:!1,msg:"Document does not exist"}}catch(y){return console.log("No such document!"),{success:!1,msg:y.message}}}}};let G;const re=new Uint8Array(16);function se(){if(!G&&(G=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!G))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return G(re)}const R=[];for(let i=0;i<256;++i)R.push((i+256).toString(16).slice(1));function ae(i,l=0){return R[i[l+0]]+R[i[l+1]]+R[i[l+2]]+R[i[l+3]]+"-"+R[i[l+4]]+R[i[l+5]]+"-"+R[i[l+6]]+R[i[l+7]]+"-"+R[i[l+8]]+R[i[l+9]]+"-"+R[i[l+10]]+R[i[l+11]]+R[i[l+12]]+R[i[l+13]]+R[i[l+14]]+R[i[l+15]]}const de=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),L={randomUUID:de};function b(i,l,m){if(L.randomUUID&&!l&&!i)return L.randomUUID();i=i||{};const p=i.random||(i.rng||se)();return p[6]=p[6]&15|64,p[8]=p[8]&63|128,ae(p)}function _(i){return K({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 13.5V4a2 2 0 0 1 2-2h8.5L20 7.5V20a2 2 0 0 1-2 2h-5.5"},child:[]},{tag:"polyline",attr:{points:"14 2 14 8 20 8"},child:[]},{tag:"path",attr:{d:"M10.42 12.61a2.1 2.1 0 1 1 2.97 2.97L7.95 21 4 22l.99-3.95 5.43-5.44Z"},child:[]}]})(i)}const ne=()=>({getTrnTypesStats:m=>{const p={};m==null||m.forEach(y=>{p[y.metadata.trnType]=1+(p[y.metadata.trnType]||0)});const f=[];for(const y in p){const a=(p[y]/(m==null?void 0:m.length)*100).toFixed(2);f.push({trntype:y,quantity:p[y],percentage:a,fillColor:F()})}return{stats:f,total:m==null?void 0:m.length}},getTrnTypePerUserStats:m=>{const p={};m==null||m.forEach(r=>{p[r.metadata.trnType]=1+(p[r.metadata.trnType]||0)});const f=[];for(const r in p){const s=m.filter(e=>e.metadata.trnType===r);f.push({trnType:r,trns:s,total:s==null?void 0:s.length})}const y=[];f==null||f.forEach(r=>{var e;const s={};(e=r.trns)==null||e.forEach(t=>{s[t.metadata.createdByUid]=1+(s[t.metadata.createdByUid]||0)}),y.push({...r,users:s})});const a=[];return y==null||y.forEach(r=>{var d;const{users:s,total:e}=r;let t={};for(const u in s){const A=m==null?void 0:m.find(B=>{var g;return((g=B==null?void 0:B.metadata)==null?void 0:g.createdByUid)===u}),S=(s[u]/e*100).toFixed(2);t[u]={uid:u,displayName:(d=A==null?void 0:A.metadata)==null?void 0:d.createdByUser,quantity:s[u],percentage:S,fillColor:F()}}r={...r,usersObj:t},a.push(r)}),{stats:a,total:m==null?void 0:m.length}}}),ie=i=>{const{trnsContext:l,setTrnsContext:m}=C.useContext($),{setTrnsStatsContext:p}=C.useContext(Z),[f,y]=C.useState([]),[a,r]=C.useState(""),{getDocument:s}=te("users"),{user:e}=E(),{getTrnTypesStats:t,getTrnTypePerUserStats:d}=ne(),{uid:u}=e;return C.useEffect(()=>{s(u).then(A=>{const{workbase:S}=A==null?void 0:A.doc,B=J("erf.address.lmMetro","==",S);if(!B)return;const g=Q(Y(j,i),B,X("metadata.updatedAtDatetime","desc"));r(""),x(g,T=>{const v=[];T.docs.forEach(M=>{v.push({id:M.id,...M.data()})}),y(v);const U=t(v),I=d(v);m({...l,trns:v,newTrnsData:!0}),p(M=>({...M,statsTrnType:U,trnTypePerUserStats:I}))},T=>{console.log("firestore err",T.message),r(T.message)}),r("")})},[]),{trns:f,error:a}},ce=()=>{const{user:i}=E();ie("trns");const l=b(),m=a=>(console.log("rowData",a),(a==null?void 0:a.length)<1?void 0:a&&(a==null?void 0:a.map(s=>{var g,T,v,U,I,M,H;const e=s.metadata.createdAtDatetime,t=new h(e==null?void 0:e.seconds,e==null?void 0:e.nanoseconds),d=t==null?void 0:t.toDate(),u=s.metadata.updatedAtDatetime,A=new h(u==null?void 0:u.seconds,u==null?void 0:u.nanoseconds),S=A==null?void 0:A.toDate();return{id:s.id,"Created By":s.metadata.createdByUser,"Created At":z(d,"yy-MM-dd HH:mm"),"Last Updated By":s.metadata.updatedByUser,"Last Updated At Datetime":z(S,"yy-MM-dd HH:mm"),"Erf No":(g=s==null?void 0:s.erf)==null?void 0:g.erfNo,"Street Adr":(v=(T=s==null?void 0:s.erf)==null?void 0:T.address)==null?void 0:v.street,"Google Adr Adr":(I=(U=s==null?void 0:s.erf)==null?void 0:U.address)==null?void 0:I.systemAdr,Access:(M=s==null?void 0:s.access)==null?void 0:M.meterAccess,"No Access Reason":(H=s==null?void 0:s.access)==null?void 0:H.noAccessReason}}))),p={meter:{checkin:{metadata:{updatedAtDatetime:h.now(),updatedByUser:i.displayName,updatedByUid:i.uid,createdAtDatetime:h.now(),createdByUser:i.displayName,createdByUid:i.uid,trnType:"checkin",trnNo:"",trnId:b(),trnState:"draft"},astData:{astId:b(),astNo:"",astCatergory:"meter",astState:"stores",astManufacturer:"",astName:"",meter:{phase:"",type:""}},location:{address:"",gps:{lat:"",lng:""}}},audit:{access:{meterAccess:"",noAccessReason:""},metadata:{updatedAtDatetime:h.now(),updatedByUser:i.displayName,updatedByUid:i.uid,createdAtDatetime:h.now(),createdByUser:i.displayName,createdByUid:i.uid,trnHistory:0,trnType:"audit",trnNo:"",trnId:b(),trnState:"draft"},astData:{astId:b(),astNo:"",astCatergory:"meter",astState:{state:"service",location:""},astManufacturer:"",astName:"",meter:{phase:"",type:"",keypad:{isThereKeypad:"",keypadAccess:"",serialNo:"",comment:""},cb:{isThereCb:"",size:"",comment:""},seal:{meterSealed:"",sealNo:"",comment:""}}},location:{address:"",gps:{lat:"",lng:""},premises:"",insideBox:""},anomalies:{anomaly:"",anomalyDetail:""},erf:{erfNo:"",erfId:"",erfAdr:""},serviceConnection:{configuration:"",offGridSupply:""},tidStatus:{status:"",statusComment:""}},tid:{access:{meterAccess:"",noAccessReason:""},metadata:{updatedAtDatetime:h.now(),updatedByUser:i.displayName,updatedByUid:i.uid,createdAtDatetime:ee(),createdByUser:i.displayName,createdByUid:i.uid,trnHistory:0,trnType:"tid",trnNo:"",trnId:b(),trnState:"draft"},astData:{astId:"",astNo:"",astCatergory:"meter"},tidOperation:{tidDone:"",comment:""},tidBefore:{tariff:"",krn:""},tidAfter:{tariff:"",krn:""}},installation:{access:{meterAccess:"",noAccessReason:""},installationData:{installationDate:new Date,sgc:""},metadata:{updatedAtDatetime:h.now(),updatedByUser:i.displayName,updatedByUid:i.uid,createdAtDatetime:h.now(),createdByUser:i.displayName,createdByUid:i.uid,trnHistory:0,trnType:"installation",trnId:l,trnState:"draft",createdThrough:{creatorTrnName:"installation",creatorTrnNo:"trnNo",creatorTrnId:l}},astData:{astId:"",astNo:"",astCatergory:"meter",astState:{state:"service",location:""},astManufacturer:"",astName:"",meter:{phase:"",type:"",keypad:{keypadInstalled:"",serialNo:"",comment:""},cb:{cbInstalled:"",size:"",comment:""},seal:{meterSealed:"",sealNo:"",comment:""}}},location:{address:"",gps:{lat:"",lng:""},premises:"",insideBox:""},anomalies:{anomaly:"MeterOk",anomalyDetail:"Operationally Ok"},erf:{erfNo:"",erfId:"",erfAdr:"",propertyType:""},serviceConnection:{configuration:""}},inspection:{access:{meterAccess:"",noAccessReason:""},metadata:{updatedAtDatetime:h.now(),updatedByUser:i.displayName,updatedByUid:i.uid,createdAtDatetime:h.now(),createdByUser:i.displayName,createdByUid:i.uid,trnHistory:0,trnType:"inspection",trnNo:"",trnId:b(),trnState:"draft"},inspectionData:{newMeter:""},astData:{astNo:"",astState:"",astManufacturer:"",astName:"",meter:{phase:"",type:"",keypad:{isThereKeypad:"",keypadAccess:"",serialNo:"",comment:""},cb:{isThereCb:"",size:"",comment:""},seal:{meterSealed:"",sealNo:"",comment:""}}},location:{address:"",gps:{lat:"",lng:""},premises:"",insideBox:""},anomalies:{anomaly:"",anomalyDetail:""},erf:{erfNo:"",erfId:"",erfAddress:""},serviceConnection:{configuration:""}}}},f={meter:{checkin:o().shape({astData:o().shape({astNo:n().required("Required"),astName:n().required("Required"),astManufacturer:n().required("Required"),astState:n().required("Required"),meter:o().shape({phase:n().required("Required"),type:n().required("Required")})}),location:o().shape({address:n().required("Required"),gps:o().shape({lat:N().required("Required"),lng:N().required("Required")})})}),audit:o().shape({access:o().shape({meterAccess:n().required("Required").notOneOf(["choose",""],"Required"),noAccessReason:n().when("meterAccess",(a,r)=>{var s;if(a[0]==="no")return(s=r==null?void 0:r.required("no access reason required"))==null?void 0:s.notOneOf(["choose",""],"Required");if(a[0]==="yes")return r.notRequired().oneOf(["","choose"],"Must Be 'choose' ")})}),astData:q((a,{context:r})=>o().shape({astNo:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required"):e}),astManufacturer:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required"):e}),astName:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required"):e}),meter:o().shape({phase:n().when("astNo",(s,e)=>{var u;const{astNo:t}=r.astData,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t===""||t===null||t===void 0?e==null?void 0:e.notRequired():(u=e==null?void 0:e.defined("Required"))==null?void 0:u.oneOf(["single","three"],"Required")}),type:n().when("astNo",(s,e)=>{var u;const{astNo:t}=r.astData,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t===""||t===null||t===void 0?e==null?void 0:e.notRequired():(u=e==null?void 0:e.defined("Required"))==null?void 0:u.oneOf(["pre-paid","conventional"],"Required")}),cb:o().shape({isThereCb:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;if(t==="no")return e.notRequired();if(t==="yes")return e.required("Required").oneOf(["yes","no"],"yes or no").notOneOf(["choose",""],"Required")}),size:N().when("isThereCb",(s,e)=>{const{isThereCb:t}=r.astData.meter.cb,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t==="yes"?e.required("Required").notOneOf([""],"Required"):t==="no"?e.oneOf([""],"Must Be Blank"):e}),comment:n().when("isThereCb",(s,e)=>{const{isThereCb:t}=r.astData.meter.cb,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t==="no"?e.required("Value Required").notOneOf(["choose"],"Required").defined("Required"):e})}),seal:o().shape({meterSealed:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;if(t==="no")return e.notRequired();if(t==="yes")return e.required("Required").oneOf(["yes","no"],"yes or no").notOneOf(["choose",""],"Required")}),sealNo:n().when(["meterSealed","comment"],([s,e],t)=>{const{meterAccess:d}=r.access;return d==="no"?t.notRequired():e==="seal no hard to read"||e==="seal has no seal no"||s==="no"?t.oneOf([""],"Must Be Blank"):s==="yes"?t.required("Required"):t}),comment:n().when("meterSealed",(s,e)=>{const{meterSealed:t,sealNo:d}=r.astData.meter.seal,{meterAccess:u}=r.access;return u==="no"?e.notRequired():t==="yes"&&d===""?e.required("Required").defined("Required").notOneOf(["choose"],"Required"):e})})})})),location:q((a,{context:r})=>o().shape({address:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="yes"?e.required("Required"):e.notRequired()}),gps:o().shape({lat:N().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="yes"?e.required("Required"):e.notRequired()}),lng:N().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="yes"?e.required("Required"):e.notRequired()})}),placement:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").oneOf(["Pole Top","Pole Bottom","Kiosk","Meter Room","Indoors","Boundary Wall (Outside)","Boundary Wall (Inside)"],"Required"):e.notRequired()})})),anomalies:q((a,{context:r})=>o().shape({anomaly:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").notOneOf(["choose",""],"Required"):e}),anomalyDetail:n().when("anomaly",(s,e)=>{const{anomaly:t}=r==null?void 0:r.anomalies,{meterAccess:d}=r==null?void 0:r.access;return d==="no"||t===""||t==="choose"||t===null||t===void 0?e.notRequired():e.required("Required").notOneOf(["choose"],"Required")})})),serviceConnection:q((a,{context:r})=>o().shape({configuration:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").oneOf(["Connected","Disconnected (By Credit Control)","Disconnected (By Municipality)","Blocked By Municipality","Old Meter (Not In Use)","Incomplete Service Point"],"Required").notOneOf(["choose",""],"Required"):e}),offGridSupply:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").oneOf(["yes","no"],"Required").notOneOf(["choose",""],"Required"):e})}))}),tid:o().shape({access:o().shape({meterAccess:n().required("Required").notOneOf(["choose",""],"Required"),noAccessReason:n().when("meterAccess",(a,r)=>{var s;if(a[0]==="no")return(s=r==null?void 0:r.required("no access reason required"))==null?void 0:s.notOneOf(["choose",""],"Required");if(a[0]==="yes")return r.notRequired().oneOf(["","choose"],"Must Be 'choose' ")})}),tidOperation:q((a,{context:r})=>o().shape({tidDone:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="yes"?e.required("Required").notOneOf(["choose",""],"Required"):e.notRequired()}),comment:n().when("tidDone",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"||s==="no"?e.notRequired():s[0]==="yes"?e.required("Required").notOneOf(["choose"],"Required"):e})})),tidBefore:q((a,{context:r})=>o().shape({tariff:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access,{tidDone:d}=r.tidOperation;if(t==="yes"&&d==="yes")return e.required("Required").notOneOf(["choose"],"Required");if(t==="yes"&&(d==="no"||d===""||d==="choose"))return e.notRequired()}),krn:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access,{tidDone:d}=r.tidOperation;if(t==="yes"&&d==="yes")return e.required("Required").notOneOf(["choose"],"Required");if(t==="yes"&&(d==="no"||d===""||d==="choose"))return e.notRequired()})})),tidAfter:q((a,{context:r})=>o().shape({tariff:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access,{tidDone:d}=r.tidOperation;if(t==="yes"&&d==="yes")return e.required("Required").notOneOf(["choose"],"Required");if(t==="yes"&&(d==="no"||d===""||d==="choose"))return e.notRequired()}),krn:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access,{tidDone:d}=r.tidOperation;if(t==="yes"&&d==="yes")return e.required("Required").notOneOf(["choose"],"Required");if(t==="yes"&&(d==="no"||d===""||d==="choose"))return e.notRequired()})}))}),installation:o().shape({access:o().shape({meterAccess:n().required("Required").notOneOf(["choose",""],"Required"),noAccessReason:n().when("meterAccess",(a,r)=>{var s;if(a[0]==="no")return(s=r==null?void 0:r.required("no access reason required"))==null?void 0:s.notOneOf(["choose",""],"Required");if(a[0]==="yes")return r.notRequired().oneOf(["","choose"],"Must Be 'choose' ")})}),installationData:q((a,{context:r})=>o().shape({sgc:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").notOneOf(["choose",""],"Required"):e})})),astData:q((a,{context:r})=>o().shape({astNo:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required"):e}),astManufacturer:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required"):e}),astName:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required"):e}),meter:o().shape({phase:n().when("astNo",(s,e)=>{var u;const{astNo:t}=r.astData,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t===""||t===null||t===void 0?e==null?void 0:e.notRequired():(u=e==null?void 0:e.defined("Required"))==null?void 0:u.oneOf(["single","three"],"Required")}),type:n().when("astNo",(s,e)=>{var u;const{astNo:t}=r.astData,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t===""||t===null||t===void 0?e==null?void 0:e.notRequired():(u=e==null?void 0:e.defined("Required"))==null?void 0:u.oneOf(["pre-paid","conventional"],"Required")}),keypad:o().shape({keypadInstalled:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").oneOf(["yes","no"],"Required").notOneOf(["choose",""],"Required"):e}),serialNo:n().when("keypadInstalled",(s,e)=>{const{keypadInstalled:t}=r.astData.meter.keypad,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t==="yes"?e.required("Required"):t==="no"?e.oneOf([""],"Must Be Blank"):e}),comment:n().when("keypadInstalled",(s,e)=>{const{keypadInstalled:t}=r.astData.meter.keypad,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t==="no"?e.required("Required").notOneOf(["choose"],"Required"):e})}),cb:o().shape({cbInstalled:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").oneOf(["yes","no"],"Required").notOneOf(["choose",""],"Required"):e}),size:N().when("cbInstalled",(s,e)=>{const{cbInstalled:t}=r.astData.meter.cb,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t==="yes"?e.required("Required").notOneOf([""],"Required"):t==="no"?e.oneOf([""],"Must Be Blank"):e}),comment:n().when("cbInstalled",(s,e)=>{const{cbInstalled:t}=r.astData.meter.cb,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t==="no"?e.required("Value Required").notOneOf(["choose"],"Required").defined("Required"):e})}),seal:o().shape({sealInstalled:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").oneOf(["yes","no"],"Required").notOneOf(["choose",""],"Required"):e}),sealNo:n().when("sealInstalled",(s,e)=>{const{sealInstalled:t}=r.astData.meter.seal,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t==="yes"?e.required("Required"):t==="no"?e.oneOf([""],"Must Be Blank"):e}),comment:n().when("sealInstalled",(s,e)=>{const{sealInstalled:t}=r.astData.meter.seal,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t==="no"?e.required("Required").notOneOf(["choose"],"Required"):e})})})})),location:q((a,{context:r})=>o().shape({address:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="yes"?e.required("Required"):e.notRequired()}),gps:o().shape({lat:N().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="yes"?e.required("Required"):e.notRequired()}),lng:N().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="yes"?e.required("Required"):e.notRequired()})}),premises:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").oneOf(["inside","outside"],"Required"):e.notRequired()}),insideBox:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").oneOf(["yes","no"],"Required"):e.notRequired()})})),anomalies:q((a,{context:r})=>o().shape({anomaly:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").notOneOf(["choose",""],"Required"):e}),anomalyDetail:n().when("anomaly",(s,e)=>{const{anomaly:t}=r.anomalies,{meterAccess:d}=r.access;return d==="no"||t===""||t==="choose"||t===null||t===void 0?e.notRequired():e.required("Required").notOneOf(["choose",""],"Required")})})),serviceConnection:q((a,{context:r})=>o().shape({configuration:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").oneOf(["overhead","underground"],"Required").notOneOf(["choose",""],"Required"):e})}))}),inspection:o().shape({access:o().shape({meterAccess:n().required("Required").notOneOf(["choose",""],"Required"),noAccessReason:n().when("meterAccess",(a,r)=>{var s;if(a[0]==="no")return(s=r==null?void 0:r.required("no access reason required"))==null?void 0:s.notOneOf(["choose",""],"Required");if(a[0]==="yes")return r.notRequired().oneOf(["","choose"],"Must Be 'choose' ")})}),inspectionData:q((a,{context:r})=>o().shape({newMeter:n().when("meterAccess",(s,e)=>{var d;const{meterAccess:t}=r.access;return t==="no"?e.notRequired().oneOf(["","choose"],"Must Be 'choose' "):t==="yes"?(d=e==null?void 0:e.required("required"))==null?void 0:d.notOneOf(["choose",""],"Required"):e})})),astData:q((a,{context:r})=>o().shape({astNo:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required"):e}),astManufacturer:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required"):e}),astName:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required"):e}),meter:o().shape({phase:n().when("astNo",(s,e)=>{var u;const{astNo:t}=r.astData,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t===""||t===null||t===void 0?e==null?void 0:e.notRequired():(u=e==null?void 0:e.defined("Required"))==null?void 0:u.oneOf(["single","three"],"Required")}),type:n().when("astNo",(s,e)=>{var u;const{astNo:t}=r.astData,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t===""||t===null||t===void 0?e==null?void 0:e.notRequired():(u=e==null?void 0:e.defined("Required"))==null?void 0:u.oneOf(["pre-paid","conventional"],"Required")}),keypad:o().shape({keypadAccess:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;if(t==="no")return e.notRequired();if(t==="yes")return e.required("Required").oneOf(["yes","no"],"yes or no").notOneOf(["choose",""],"Required")}),serialNo:n().when("keypadAccess",(s,e)=>{const{keypadAccess:t}=r.astData.meter.keypad,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t==="yes"?e.required("Required"):t==="no"?e.oneOf([""],"Must Be Blank"):e}),comment:n().when("keypadAccess",(s,e)=>{const{keypadAccess:t}=r.astData.meter.keypad,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t==="no"?e.required("Required").notOneOf(["choose"],"Required"):e})}),cb:o().shape({isThereCb:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;if(t==="no")return e.notRequired();if(t==="yes")return e.required("Required").oneOf(["yes","no"],"yes or no").notOneOf(["choose",""],"Required")}),size:N().when("isThereCb",(s,e)=>{const{isThereCb:t}=r.astData.meter.cb,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t==="yes"?e.required("Required").notOneOf([""],"Required"):t==="no"?e.oneOf([""],"Must Be Blank"):e}),comment:n().when("isThereCb",(s,e)=>{const{isThereCb:t}=r.astData.meter.cb,{meterAccess:d}=r.access;return d==="no"?e.notRequired():t==="no"?e.required("Value Required").notOneOf(["choose"],"Required").defined("Required"):e})}),seal:o().shape({meterSealed:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;if(t==="no")return e.notRequired();if(t==="yes")return e.required("Required").oneOf(["yes","no"],"yes or no").notOneOf(["choose",""],"Required")}),sealNo:n().when(["meterSealed","comment"],([s,e],t)=>{const{meterAccess:d}=r.access;return d==="no"?t.notRequired():e==="seal no hard to read"||e==="seal has no seal no"||s==="no"?t.oneOf([""],"Must Be Blank"):s==="yes"?t.required("Required"):t}),comment:n().when("meterSealed",(s,e)=>{var A,S;const{meterSealed:t,sealNo:d}=(S=(A=r==null?void 0:r.astData)==null?void 0:A.meter)==null?void 0:S.seal,{meterAccess:u}=r==null?void 0:r.access;return u==="no"?e.notRequired():t==="yes"&&d===""?e.required("Required").defined("Required").notOneOf(["choose"],"Required"):e})})})})),location:q((a,{context:r})=>o().shape({address:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="yes"?e.required("Required"):e.notRequired()}),gps:o().shape({lat:N().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="yes"?e.required("Required"):e.notRequired()}),lng:N().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="yes"?e.required("Required"):e.notRequired()})}),premises:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").oneOf(["inside","outside"],"Required"):e.notRequired()}),insideBox:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").oneOf(["yes","no"],"Required"):e.notRequired()})})),anomalies:q((a,{context:r})=>o().shape({anomaly:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").notOneOf(["choose",""],"Required"):e}),anomalyDetail:n().when("anomaly",(s,e)=>{const{anomaly:t}=r==null?void 0:r.anomalies,{meterAccess:d}=r==null?void 0:r.access;return d==="no"||t===""||t==="choose"||t===null||t===void 0?e.notRequired():e.required("Required").notOneOf(["choose"],"Required")})})),serviceConnection:q((a,{context:r})=>o().shape({configuration:n().when("meterAccess",(s,e)=>{const{meterAccess:t}=r.access;return t==="no"?e.notRequired():t==="yes"?e.required("Required").oneOf(["overhead","underground"],"Required").notOneOf(["choose",""],"Required"):e})}))})}},y={meter:{audit:[{field:"id",headerName:"System Id",width:200,hide:!0},{headerName:"Created",children:[{field:"metadata.createdByUser",headerName:"Created By",width:150,hide:!0},{field:"metadata.createdAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:a=>{const s=new h(a.value.seconds,a.value.nanoseconds).toDate();return c.jsx(w,{date:s,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:a=>a.data.metadata.createdAtDatetime,hide:!0}]},{headerName:"Updated",children:[{field:"metadata.updatedByUser",headerName:"Updated By",width:150,hide:!0},{field:"metadata.updatedAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:a=>{const s=new h(a.value.seconds,a.value.nanoseconds).toDate();return c.jsx(w,{date:s,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:a=>a.data.metadata.updatedAtDatetime,hide:!0}]},{headerName:"Ast Data",children:[{field:"astData.astCatergory",columnGroupShow:"open",headerName:"Ast Cat",width:150,hide:!1},{field:"astData.astNo",columnGroupShow:"closed",headerName:"Ast No",width:150,hide:!1},{field:"astData.astManufacturer",columnGroupShow:"open",headerName:"Manufacturer",width:150,hide:!1},{field:"astData.astName",columnGroupShow:"open",headerName:"Ast Name",width:150,hide:!1}]},{field:"",headerName:"Edit",cellRenderer:a=>c.jsx(D,{data:a,children:c.jsx(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:c.jsx(_,{})})}),cellRendererParams:{modalName:"meter-audit",validationSchema:f.meter.audit,width:"3rem"},width:80},{headerName:"Erf (Where ast belongs)",children:[{field:"erf.erfNo",headerName:"Erf No",width:110,cellRenderer:a=>c.jsx(D,{data:a,children:c.jsxs(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:[c.jsx(k,{})," ",a.value]})}),cellRendererParams:{modalName:"iwShowOnMap",tableBtnClass:"table-btn-icon"},hide:!1},{field:"erf.address.street",headerName:"Street Address",width:200,hide:!1},{field:"erf.address.systemAdr",headerName:"Erf Address (Google)",width:200,hide:!1}]},{field:"metadata.trnState",headerName:"State",width:100},{field:"metadata.trnType",headerName:"Trn Type",valueGetter:a=>{const{trnType:r}=a.data.metadata;return r},width:120},{headerName:"Access",children:[{field:"access.meterAccess",headerName:"Access?",width:120},{field:"access.noAccessReason",headerName:"No Access Reason",width:200}]},{headerName:"Ast Specific",children:[{field:"astData.meter.type",headerName:"Meter Type",width:150,hide:!1},{field:"astData.meter.phase",headerName:"Meter Phase",width:150,hide:!1}]},{headerName:"Anomalies",children:[{field:"anomalies.anomaly",columnGroupShow:"open",headerName:"Anomaly",width:150},{field:"anomalies.anomalyDetail",columnGroupShow:"open",headerName:"Anomaly Detail",width:300}]}],tid:[{field:"id",headerName:"System Id",width:200,hide:!0},{headerName:"Created",children:[{field:"metadata.createdByUser",headerName:"Created By",width:150,hide:!1},{field:"metadata.createdAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:a=>{const s=new h(a.value.seconds,a.value.nanoseconds).toDate();return c.jsx(w,{date:s,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:a=>a.data.metadata.createdAtDatetime,hide:!1}]},{headerName:"Updated",children:[{field:"metadata.updatedByUser",headerName:"Updated By",width:150,hide:!1},{field:"metadata.updatedAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:a=>{const s=new h(a.value.seconds,a.value.nanoseconds).toDate();return c.jsx(w,{date:s,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:a=>a.data.metadata.updatedAtDatetime,hide:!1}]},{headerName:"Ast Data",children:[{field:"astData.astNo",headerName:"Ast No",width:150,hide:!1}]},{field:"",headerName:"Edit",cellRenderer:a=>c.jsx(D,{data:a,children:c.jsx(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:c.jsx(_,{})})}),cellRendererParams:{modalName:"meter-tid",validationSchema:f.meter.tid,width:"3rem"},width:80},{field:"metadata.trnState",headerName:"State",width:100,hide:!1},{field:"metadata.trnType",headerName:"Trn Type",valueGetter:a=>{const{trnType:r}=a.data.metadata;return r},width:120},{headerName:"Access",children:[{field:"access.meterAccess",headerName:"Access",width:100,hide:!1},{field:"access.noAccessReason",headerName:"No Access Reason",width:220,hide:!1}]},{headerName:"Tid Operation",children:[{field:"tidOperation.tidDone",headerName:"Tid Done?",width:150,hide:!1},{field:"tidOperation.comment",headerName:"Comment",width:200,hide:!1}]},{headerName:"Tid Before",children:[{field:"tidBefore.tariff",headerName:"Tariff",width:150,hide:!1},{field:"tidBefore.krn",headerName:"KRN",width:150,hide:!1}]},{headerName:"Tid After",children:[{field:"tidAfter.tariff",headerName:"Tariff",width:150,hide:!1},{field:"tidAfter.krn",headerName:"KRN",width:150,hide:!1}]}],installation:[{field:"id",headerName:"System Id",width:200,hide:!0},{headerName:"Created",children:[{field:"metadata.createdByUser",headerName:"Created By",width:150,hide:!1},{field:"metadata.createdAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:a=>{const s=new h(a.value.seconds,a.value.nanoseconds).toDate();return c.jsx(w,{date:s,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:a=>a.data.metadata.createdAtDatetime,hide:!1}]},{headerName:"Updated",children:[{field:"metadata.updatedByUser",headerName:"Updated By",width:150,hide:!1},{field:"metadata.updatedAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:a=>{const s=new h(a.value.seconds,a.value.nanoseconds).toDate();return c.jsx(w,{date:s,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:a=>a.data.metadata.updatedAtDatetime,hide:!1}]},{headerName:"Ast Data",children:[{field:"astData.astCatergory",columnGroupShow:"open",headerName:"Ast Cat",width:150,hide:!1},{field:"astData.astNo",columnGroupShow:"closed",headerName:"Ast No",width:150,hide:!1},{field:"astData.astManufacturer",columnGroupShow:"open",headerName:"Manufacturer",width:150,hide:!1},{field:"astData.astName",columnGroupShow:"open",headerName:"Ast Name",width:150,hide:!1}]},{field:"",headerName:"Edit",cellRenderer:a=>c.jsx(D,{data:a,children:c.jsx(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:c.jsx(_,{})})}),cellRendererParams:{modalName:"meter-installation",validationSchema:f.meter.installation,width:"3rem"},width:80},{field:"erf.erfNo",headerName:"Erf No",width:110,cellRenderer:a=>c.jsx(D,{data:a,children:c.jsxs(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:[c.jsx(k,{})," ",a.value]})}),cellRendererParams:{modalName:"iwShowOnMap",tableBtnClass:"table-btn-icon"},hide:!1},{field:"metadata.trnState",headerName:"State",width:100},{field:"metadata.trnType",headerName:"Trn Type",valueGetter:a=>{const{trnType:r}=a.data.metadata;return r},width:120},{headerName:"Access",children:[{field:"access.meterAccess",headerName:"Access?",width:120},{field:"access.noAccessReason",headerName:"No Access Reason",width:200}]},{headerName:"Ast Specific",children:[{field:"astData.meter.type",headerName:"Meter Type",width:150,hide:!1},{field:"astData.meter.phase",headerName:"Meter Phase",width:150,hide:!1}]},{headerName:"Ast Location",children:[{field:"location.address",columnGroupShow:"closed",headerName:"Ast Address",width:450},{field:"location.premises",columnGroupShow:"closed",headerName:"Premises",width:120},{field:"location.insideBox",columnGroupShow:"closed",headerName:"InsideBox",width:120}]}],inspection:[{field:"id",headerName:"System Id",width:200,hide:!0},{headerName:"Created",children:[{field:"metadata.createdByUser",headerName:"Created By",width:150,hide:!1},{field:"metadata.createdAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:a=>{const s=new h(a.value.seconds,a.value.nanoseconds).toDate();return c.jsx(w,{date:s,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:a=>a.data.metadata.createdAtDatetime,hide:!1}]},{headerName:"Updated",children:[{field:"metadata.updatedByUser",headerName:"Updated By",width:150,hide:!1},{field:"metadata.updatedAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:a=>{const s=new h(a.value.seconds,a.value.nanoseconds).toDate();return c.jsx(w,{date:s,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:a=>a.data.metadata.updatedAtDatetime,hide:!1}]},{headerName:"Ast Data",children:[{field:"astData.astCatergory",columnGroupShow:"open",headerName:"Ast Cat",width:150,hide:!1},{field:"astData.astNo",columnGroupShow:"closed",headerName:"Ast No",width:150,hide:!1},{field:"astData.astManufacturer",columnGroupShow:"open",headerName:"Manufacturer",width:150,hide:!1},{field:"astData.astName",columnGroupShow:"open",headerName:"Ast Name",width:150,hide:!1}]},{field:"",headerName:"Edit",cellRenderer:a=>c.jsx(D,{data:a,children:c.jsx(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:c.jsx(_,{})})}),cellRendererParams:{modalName:"meter-inspection",validationSchema:f.meter.inspection,width:"3rem"},width:80},{headerName:"Erf (Where ast belongs)",children:[{field:"erf.erfNo",headerName:"Erf No",width:110,cellRenderer:a=>c.jsx(D,{data:a,children:c.jsxs(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:[c.jsx(k,{})," ",a.value]})}),cellRendererParams:{modalName:"iwShowOnMap",tableBtnClass:"table-btn-icon"},hide:!1},{field:"erf.address.systemAdr",headerName:"Erf Address (Google)",width:300,hide:!1}]},{field:"metadata.trnState",headerName:"State",width:100},{field:"metadata.trnType",headerName:"Trn Type",valueGetter:a=>{const{trnType:r}=a.data.metadata;return r},width:120},{headerName:"Access",children:[{field:"access.meterAccess",headerName:"Access?",width:120},{field:"access.noAccessReason",headerName:"No Access Reason",width:200}]},{headerName:"Ast Specific",children:[{field:"astData.meter.type",headerName:"Meter Type",width:150,hide:!1},{field:"astData.meter.phase",headerName:"Meter Phase",width:150,hide:!1}]},{headerName:"Anomalies",children:[{field:"anomalies.anomaly",columnGroupShow:"open",headerName:"Anomaly",width:150},{field:"anomalies.anomalyDetail",columnGroupShow:"open",headerName:"Anomaly Detail",width:300}]},{headerName:"Ast Location",children:[{field:"location.address",columnGroupShow:"closed",headerName:"Ast Address",width:450},{field:"location.premises",columnGroupShow:"closed",headerName:"Premises",width:120},{field:"location.insideBox",columnGroupShow:"closed",headerName:"InsideBox",width:120}]}]},all:{all:[{field:"id",headerName:"System Id",width:200,hide:!0},{headerName:"Created",children:[{field:"metadata.createdByUser",headerName:"Created By",width:150,hide:!1},{field:"metadata.createdAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:a=>{const s=new h(a.value.seconds,a.value.nanoseconds).toDate();return c.jsx(w,{date:s,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:a=>a.data.metadata.createdAtDatetime,hide:!1}]},{headerName:"Last Updated",children:[{field:"metadata.updatedByUser",headerName:"Updated By",width:150,hide:!1},{field:"metadata.updatedAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:a=>{const s=new h(a.value.seconds,a.value.nanoseconds).toDate();return c.jsx(w,{date:s,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:a=>a.data.metadata.updatedAtDatetime,hide:!1}]},{headerName:"Meter Description",children:[{field:"astData.astNo",headerName:"Meter No",width:150,hide:!1}]},{field:"",headerName:"Edit Trn",cellRenderer:a=>{var s,e;const r=(e=(s=a==null?void 0:a.data)==null?void 0:s.metadata)==null?void 0:e.trnType;return c.jsx(D,{data:a,modalName:`meter-${r}`,children:c.jsx(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:c.jsx(_,{})})})},cellRendererParams:{validationSchema:f.meter.audit,width:"3rem"},width:100,filter:!1},{headerName:"Erf (Where Meter Belongs)",children:[{field:"erf.erfNo",headerName:"Erf No",width:110,cellRenderer:a=>c.jsx(D,{data:a,children:c.jsxs(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:[c.jsx(k,{})," ",a.value]})}),cellRendererParams:{modalName:"iwShowOnMap",tableBtnClass:"table-btn-icon"},hide:!1,filter:!1},{field:"erf.address.street",headerName:"Street Address",width:300,hide:!1},{field:"erf.address.systemAdr",headerName:"Google Address",width:300,hide:!1}]},{field:"metadata.trnState",headerName:"Form State",width:120},{field:"metadata.trnType",headerName:"Trn Type",valueGetter:a=>{const{trnType:r}=a.data.metadata;return r},width:120},{headerName:"Access",children:[{field:"access.meterAccess",headerName:"Access?",width:120},{field:"access.noAccessReason",headerName:"No Access Reason",width:200}]}]}};return{trnsNewFormData:p,trnsValidationSchema:f,trnsTableFields:y,createExportRowData:m}};export{ne as a,ce as b,te as u,b as v};
//# sourceMappingURL=useTrns-BD_hA0QA.js.map
