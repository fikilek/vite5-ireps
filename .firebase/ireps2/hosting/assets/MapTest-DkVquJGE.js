import{r as d,x as b,c as y,q as M,e as w,w as m,f as x,j as o,y as E,P as j,d as I,G as _,H as k}from"./index-CkAsUE4W.js";import{u as B}from"./useAstsMap-C4ZjHTrS.js";import{u as D}from"./useErfs-CkqbHUwp.js";import{M as A}from"./index.esm-BcX3AeJG.js";import{z as p}from"./za_kzn_umgungundlovu_mpofana_w1-CZ0tBZXl.js";import"./useTrns-UP8r97rG.js";try{let r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new r.Error().stack;n&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[n]="67c86c01-c592-4476-998a-71395b2e9f1b",r._sentryDebugIdIdentifier="sentry-dbid-67c86c01-c592-4476-998a-71395b2e9f1b")}catch{}const C=()=>{var c,i;const[r,n]=d.useState(),t=b();let u=y(I,"erfs");const f=d.useMemo(()=>M(u,m("address.lmMetro","==","Mpofana LM"),m("address.ward","==","1"),w("metadata.updatedAtDatetime","desc")),[u]);return d.useEffect(()=>{x(f,e=>{const s=[];e.docs.forEach(a=>{s.push({id:a.id,...a.data()})}),n(s)},e=>{console.log("firestore err",e.message)})},[]),(c=t==null?void 0:t.data)==null||c.loadGeoJson(p,p),(i=t.data)==null||i.setStyle(e=>({fillOpacity:0,strokeWeight:.1,strokeColor:"blue"})),d.useEffect(()=>{P().then(e=>{let s=new window.google.maps.LatLngBounds;e.features[0].geometry.coordinates[0][0].forEach(a=>{s.extend({lat:a[1],lng:a[0]})}),t==null||t.fitBounds(s)})},[t]),o.jsx("div",{children:o.jsx(R,{erfs:r})})},P=async()=>await(await fetch(p)).json(),R=r=>{const{erfs:n}=r,t=b(),[u,f]=d.useState({}),c=d.useRef(null);d.useEffect(()=>{t&&(c.current||(c.current=new A({map:t})))},[t]),d.useEffect(()=>{var e,s;(e=c.current)==null||e.clearMarkers(),(s=c.current)==null||s.addMarkers(Object.values(u))},[u]);const i=(e,s)=>{e&&u[s]||!e&&!u[s]||f(a=>{if(e)return{...a,[s]:e};{const l={...a};return delete l[s],l}})};return o.jsx(o.Fragment,{children:n==null?void 0:n.map(e=>{var s,a,l,g;return o.jsx(E,{position:{lat:(a=(s=e==null?void 0:e.address)==null?void 0:s.gps)==null?void 0:a.latitude,lng:(g=(l=e==null?void 0:e.address)==null?void 0:l.gps)==null?void 0:g.longitude},ref:h=>i(h,e.id),children:o.jsx(j,{background:"#FBBC04",glyphColor:"#000",borderColor:"#000"})},e.id)})})},L=()=>(D(),B(),o.jsx("div",{className:"map-test",children:o.jsx(_,{apiKey:"AIzaSyDKsugznrX_Zh0u73iZ0HsOo47QTE8KRjc",onLoad:()=>console.log("Maps API has loaded."),onError:()=>console.log("There was an error on iREPS Map"),children:o.jsx(k,{defaultZoom:13,defaultCenter:{lat:-33.860664,lng:151.208138},gestureHandling:"greedy",disableDefaultUI:!1,mapId:"eab81cec6c21fbbc",children:o.jsx(C,{})})})}));export{L as default};
//# sourceMappingURL=MapTest-DkVquJGE.js.map
