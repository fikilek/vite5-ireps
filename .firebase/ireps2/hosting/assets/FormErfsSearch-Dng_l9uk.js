import{r as l,c as m,d as h,q as f,w as p,ay as N,y as g,am as E,an as x,a9 as d,j as s,ab as S,ad as j,ae as y,ap as C,ah as F,aq as R,aj as v}from"./index-BVpXZ-6-.js";const w={data:[],error:null,isPending:null,success:null},P=(t,r)=>{switch(r.type){default:return t;case"IS_PENDING":return{data:[],isPending:!0,success:!1,error:""};case"SUCCESS":return{data:r.payload,error:!1,isPending:!1,success:!0};case"ERROR":return{data:[],isPending:!1,success:!1,error:r.payoad}}},b=t=>{const[r,a]=l.useReducer(P,w);let e=m(h,t);return{state:r,getCollectionCount:async n=>{let c;n?c=f(e,p(...n)):c=f(e),a({type:"IS_PENDING"}),N(c).then(o=>{const i=o.data().count;console.log("count",i),a({type:"SUCCESS",payload:i})}).catch(o=>{console.log("firestore err",o.message),a({type:"ERROR",payload:o.message})})}}},q=()=>{const{closeModal:t}=g(),[r,a]=l.useState(null);console.log("erfNo",r);const{state:e,getCollection:u}=b("erfs"),n=o=>{u(["erfNo","==",o.erfNo.trim()])},c=E({erfNo:x().required("Ast No is required.")});return l.useEffect(()=>{e.success&&e.data.length>0&&(t(),d.success(`Erf No "${r}", succesfully found`,{position:"bottom-left"})),e.success&&e.data.length===0&&(t(),d.warn(`Erf No "${r}", NOT found`,{position:"top-left"}),u())},[e.success,t]),l.useEffect(()=>{e.error&&console.log("state.error",e.error)},[e.error]),s.jsx("div",{className:"form-wrapper",children:s.jsx("div",{className:"form-container erfs-search",children:s.jsx(S,{initialValues:{erfNo:""},onSubmit:n,validationSchema:c,children:o=>(a(o.values.erfNo),s.jsx(s.Fragment,{children:s.jsxs(j,{children:[s.jsx(y,{hl1:"Erfs Search"}),s.jsx(C,{msg:"Enter the Erf No to search for."}),s.jsx("div",{className:"search-erfs-form",children:s.jsx(F,{control:"input",type:"text",label:"Erf NO",name:"erfNo",placeholder:"",autoFocus:!0})}),e.error&&s.jsx(R,{errorMsg:e.error}),s.jsx(v,{formik:o,signState:e})]})}))})})})};export{q as default};
