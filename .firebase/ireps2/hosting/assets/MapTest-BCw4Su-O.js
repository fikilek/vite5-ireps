import{r as d,x as m,c as y,q as M,e as w,w as b,f as x,j as o,y as E,P as j,d as I,G as _,H as k}from"./index-B2W70YXr.js";import{u as B}from"./useAstsMap-Cp8KeGoq.js";import{u as D}from"./useErfs-nqTqG9Ui.js";import{M as A}from"./index.esm-uR7lSi4Y.js";import{z as p}from"./za_kzn_umgungundlovu_mpofana_w1-CZ0tBZXl.js";import"./useTrns-DpjEOOia.js";try{let r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new r.Error().stack;n&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[n]="9f20cb29-b0e6-4e74-b40d-97d2ea2219ed",r._sentryDebugIdIdentifier="sentry-dbid-9f20cb29-b0e6-4e74-b40d-97d2ea2219ed")}catch{}const C=()=>{var l,i;const[r,n]=d.useState(),t=m();let u=y(I,"erfs");const f=d.useMemo(()=>M(u,b("address.lmMetro","==","Mpofana LM"),b("address.ward","==","1"),w("metadata.updatedAtDatetime","desc")),[u]);return d.useEffect(()=>{x(f,e=>{const s=[];e.docs.forEach(a=>{s.push({id:a.id,...a.data()})}),n(s)},e=>{console.log("firestore err",e.message)})},[]),(l=t==null?void 0:t.data)==null||l.loadGeoJson(p,p),(i=t.data)==null||i.setStyle(e=>({fillOpacity:0,strokeWeight:.1,strokeColor:"blue"})),d.useEffect(()=>{P().then(e=>{let s=new window.google.maps.LatLngBounds;e.features[0].geometry.coordinates[0][0].forEach(a=>{s.extend({lat:a[1],lng:a[0]})}),t==null||t.fitBounds(s)})},[t]),o.jsx("div",{children:o.jsx(R,{erfs:r})})},P=async()=>await(await fetch(p)).json(),R=r=>{const{erfs:n}=r,t=m(),[u,f]=d.useState({}),l=d.useRef(null);d.useEffect(()=>{t&&(l.current||(l.current=new A({map:t})))},[t]),d.useEffect(()=>{var e,s;(e=l.current)==null||e.clearMarkers(),(s=l.current)==null||s.addMarkers(Object.values(u))},[u]);const i=(e,s)=>{e&&u[s]||!e&&!u[s]||f(a=>{if(e)return{...a,[s]:e};{const c={...a};return delete c[s],c}})};return o.jsx(o.Fragment,{children:n==null?void 0:n.map(e=>{var s,a,c,g;return o.jsx(E,{position:{lat:(a=(s=e==null?void 0:e.address)==null?void 0:s.gps)==null?void 0:a.latitude,lng:(g=(c=e==null?void 0:e.address)==null?void 0:c.gps)==null?void 0:g.longitude},ref:h=>i(h,e.id),children:o.jsx(j,{background:"#FBBC04",glyphColor:"#000",borderColor:"#000"})},e.id)})})},L=()=>(D(),B(),o.jsx("div",{className:"map-test",children:o.jsx(_,{apiKey:"AIzaSyDKsugznrX_Zh0u73iZ0HsOo47QTE8KRjc",onLoad:()=>console.log("Maps API has loaded."),onError:()=>console.log("There was an error on iREPS Map"),children:o.jsx(k,{defaultZoom:13,defaultCenter:{lat:-33.860664,lng:151.208138},gestureHandling:"greedy",disableDefaultUI:!1,mapId:"eab81cec6c21fbbc",children:o.jsx(C,{})})})}));export{L as default};
//# sourceMappingURL=MapTest-BCw4Su-O.js.map
