{"version":3,"file":"MediaAction-DGwILWgx.js","sources":["../../node_modules/react-spinners/esm/ScaleLoader.js","../../node_modules/react-webcam/dist/react-webcam.js","../../src/hooks/useImage.jsx","../../src/components/irepsInfoWindow/WindowCloseBtn.jsx","../../src/components/media/MediaActionCamera.jsx","../../src/components/media/MediaActionVoice.jsx","../../src/components/media/MediaActionVideo.jsx","../../src/images/place_holder1.png","../../src/components/media/MediaActionGallery.jsx","../../src/components/media/MediaAction.jsx"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport * as React from \"react\";\nimport { cssValue } from \"./helpers/unitConverter\";\nimport { createAnimation } from \"./helpers/animation\";\nvar scale = createAnimation(\"ScaleLoader\", \"0% {transform: scaley(1.0)} 50% {transform: scaley(0.4)} 100% {transform: scaley(1.0)}\", \"scale\");\nfunction ScaleLoader(_a) {\n    var _b = _a.loading, loading = _b === void 0 ? true : _b, _c = _a.color, color = _c === void 0 ? \"#000000\" : _c, _d = _a.speedMultiplier, speedMultiplier = _d === void 0 ? 1 : _d, _e = _a.cssOverride, cssOverride = _e === void 0 ? {} : _e, _f = _a.height, height = _f === void 0 ? 35 : _f, _g = _a.width, width = _g === void 0 ? 4 : _g, _h = _a.radius, radius = _h === void 0 ? 2 : _h, _j = _a.margin, margin = _j === void 0 ? 2 : _j, additionalprops = __rest(_a, [\"loading\", \"color\", \"speedMultiplier\", \"cssOverride\", \"height\", \"width\", \"radius\", \"margin\"]);\n    var wrapper = __assign({ display: \"inherit\" }, cssOverride);\n    var style = function (i) {\n        return {\n            backgroundColor: color,\n            width: cssValue(width),\n            height: cssValue(height),\n            margin: cssValue(margin),\n            borderRadius: cssValue(radius),\n            display: \"inline-block\",\n            animation: \"\".concat(scale, \" \").concat(1 / speedMultiplier, \"s \").concat(i * 0.1, \"s infinite cubic-bezier(0.2, 0.68, 0.18, 1.08)\"),\n            animationFillMode: \"both\",\n        };\n    };\n    if (!loading) {\n        return null;\n    }\n    return (React.createElement(\"span\", __assign({ style: wrapper }, additionalprops),\n        React.createElement(\"span\", { style: style(1) }),\n        React.createElement(\"span\", { style: style(2) }),\n        React.createElement(\"span\", { style: style(3) }),\n        React.createElement(\"span\", { style: style(4) }),\n        React.createElement(\"span\", { style: style(5) })));\n}\nexport default ScaleLoader;\n","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Webcam\"] = factory(require(\"react\"));\n\telse\n\t\troot[\"Webcam\"] = factory(root[\"React\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_react__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = \"./src/react-webcam.tsx\");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ \"./src/react-webcam.tsx\":\n/*!******************************!*\\\n  !*** ./src/react-webcam.tsx ***!\n  \\******************************/\n/*! exports provided: default */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"react\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\nvar __extends = (undefined && undefined.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = (undefined && undefined.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __rest = (undefined && undefined.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\n\n// polyfill based on https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n(function polyfillGetUserMedia() {\n    if (typeof window === 'undefined') {\n        return;\n    }\n    // Older browsers might not implement mediaDevices at all, so we set an empty object first\n    if (navigator.mediaDevices === undefined) {\n        navigator.mediaDevices = {};\n    }\n    // Some browsers partially implement mediaDevices. We can't just assign an object\n    // with getUserMedia as it would overwrite existing properties.\n    // Here, we will just add the getUserMedia property if it's missing.\n    if (navigator.mediaDevices.getUserMedia === undefined) {\n        navigator.mediaDevices.getUserMedia = function (constraints) {\n            // First get ahold of the legacy getUserMedia, if present\n            var getUserMedia = navigator.getUserMedia ||\n                navigator.webkitGetUserMedia ||\n                navigator.mozGetUserMedia ||\n                navigator.msGetUserMedia;\n            // Some browsers just don't implement it - return a rejected promise with an error\n            // to keep a consistent interface\n            if (!getUserMedia) {\n                return Promise.reject(new Error(\"getUserMedia is not implemented in this browser\"));\n            }\n            // Otherwise, wrap the call to the old navigator.getUserMedia with a Promise\n            return new Promise(function (resolve, reject) {\n                getUserMedia.call(navigator, constraints, resolve, reject);\n            });\n        };\n    }\n})();\nfunction hasGetUserMedia() {\n    return !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia);\n}\nvar Webcam = /** @class */ (function (_super) {\n    __extends(Webcam, _super);\n    function Webcam(props) {\n        var _this = _super.call(this, props) || this;\n        _this.canvas = null;\n        _this.ctx = null;\n        _this.requestUserMediaId = 0;\n        _this.unmounted = false;\n        _this.state = {\n            hasUserMedia: false\n        };\n        return _this;\n    }\n    Webcam.prototype.componentDidMount = function () {\n        var _a = this, state = _a.state, props = _a.props;\n        this.unmounted = false;\n        if (!hasGetUserMedia()) {\n            props.onUserMediaError(\"getUserMedia not supported\");\n            return;\n        }\n        if (!state.hasUserMedia) {\n            this.requestUserMedia();\n        }\n        if (props.children && typeof props.children != 'function') {\n            console.warn(\"children must be a function\");\n        }\n    };\n    Webcam.prototype.componentDidUpdate = function (nextProps) {\n        var props = this.props;\n        if (!hasGetUserMedia()) {\n            props.onUserMediaError(\"getUserMedia not supported\");\n            return;\n        }\n        var audioConstraintsChanged = JSON.stringify(nextProps.audioConstraints) !==\n            JSON.stringify(props.audioConstraints);\n        var videoConstraintsChanged = JSON.stringify(nextProps.videoConstraints) !==\n            JSON.stringify(props.videoConstraints);\n        var minScreenshotWidthChanged = nextProps.minScreenshotWidth !== props.minScreenshotWidth;\n        var minScreenshotHeightChanged = nextProps.minScreenshotHeight !== props.minScreenshotHeight;\n        if (videoConstraintsChanged ||\n            minScreenshotWidthChanged ||\n            minScreenshotHeightChanged) {\n            this.canvas = null;\n            this.ctx = null;\n        }\n        if (audioConstraintsChanged || videoConstraintsChanged) {\n            this.stopAndCleanup();\n            this.requestUserMedia();\n        }\n    };\n    Webcam.prototype.componentWillUnmount = function () {\n        this.unmounted = true;\n        this.stopAndCleanup();\n    };\n    Webcam.stopMediaStream = function (stream) {\n        if (stream) {\n            if (stream.getVideoTracks && stream.getAudioTracks) {\n                stream.getVideoTracks().map(function (track) {\n                    stream.removeTrack(track);\n                    track.stop();\n                });\n                stream.getAudioTracks().map(function (track) {\n                    stream.removeTrack(track);\n                    track.stop();\n                });\n            }\n            else {\n                stream.stop();\n            }\n        }\n    };\n    Webcam.prototype.stopAndCleanup = function () {\n        var state = this.state;\n        if (state.hasUserMedia) {\n            Webcam.stopMediaStream(this.stream);\n            if (state.src) {\n                window.URL.revokeObjectURL(state.src);\n            }\n        }\n    };\n    Webcam.prototype.getScreenshot = function (screenshotDimensions) {\n        var _a = this, state = _a.state, props = _a.props;\n        if (!state.hasUserMedia)\n            return null;\n        var canvas = this.getCanvas(screenshotDimensions);\n        return (canvas &&\n            canvas.toDataURL(props.screenshotFormat, props.screenshotQuality));\n    };\n    Webcam.prototype.getCanvas = function (screenshotDimensions) {\n        var _a = this, state = _a.state, props = _a.props;\n        if (!this.video) {\n            return null;\n        }\n        if (!state.hasUserMedia || !this.video.videoHeight)\n            return null;\n        if (!this.ctx) {\n            var canvasWidth = this.video.videoWidth;\n            var canvasHeight = this.video.videoHeight;\n            if (!this.props.forceScreenshotSourceSize) {\n                var aspectRatio = canvasWidth / canvasHeight;\n                canvasWidth = props.minScreenshotWidth || this.video.clientWidth;\n                canvasHeight = canvasWidth / aspectRatio;\n                if (props.minScreenshotHeight &&\n                    canvasHeight < props.minScreenshotHeight) {\n                    canvasHeight = props.minScreenshotHeight;\n                    canvasWidth = canvasHeight * aspectRatio;\n                }\n            }\n            this.canvas = document.createElement(\"canvas\");\n            this.canvas.width = (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.width) || canvasWidth;\n            this.canvas.height = (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.height) || canvasHeight;\n            this.ctx = this.canvas.getContext(\"2d\");\n        }\n        var _b = this, ctx = _b.ctx, canvas = _b.canvas;\n        if (ctx && canvas) {\n            // adjust the height and width of the canvas to the given dimensions\n            canvas.width = (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.width) || canvas.width;\n            canvas.height = (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.height) || canvas.height;\n            // mirror the screenshot\n            if (props.mirrored) {\n                ctx.translate(canvas.width, 0);\n                ctx.scale(-1, 1);\n            }\n            ctx.imageSmoothingEnabled = props.imageSmoothing;\n            ctx.drawImage(this.video, 0, 0, (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.width) || canvas.width, (screenshotDimensions === null || screenshotDimensions === void 0 ? void 0 : screenshotDimensions.height) || canvas.height);\n            // invert mirroring\n            if (props.mirrored) {\n                ctx.scale(-1, 1);\n                ctx.translate(-canvas.width, 0);\n            }\n        }\n        return canvas;\n    };\n    Webcam.prototype.requestUserMedia = function () {\n        var _this = this;\n        var props = this.props;\n        var sourceSelected = function (audioConstraints, videoConstraints) {\n            var constraints = {\n                video: typeof videoConstraints !== \"undefined\" ? videoConstraints : true\n            };\n            if (props.audio) {\n                constraints.audio =\n                    typeof audioConstraints !== \"undefined\" ? audioConstraints : true;\n            }\n            _this.requestUserMediaId++;\n            var myRequestUserMediaId = _this.requestUserMediaId;\n            navigator.mediaDevices\n                .getUserMedia(constraints)\n                .then(function (stream) {\n                if (_this.unmounted || myRequestUserMediaId !== _this.requestUserMediaId) {\n                    Webcam.stopMediaStream(stream);\n                }\n                else {\n                    _this.handleUserMedia(null, stream);\n                }\n            })\n                .catch(function (e) {\n                _this.handleUserMedia(e);\n            });\n        };\n        if (\"mediaDevices\" in navigator) {\n            sourceSelected(props.audioConstraints, props.videoConstraints);\n        }\n        else {\n            var optionalSource_1 = function (id) { return ({ optional: [{ sourceId: id }] }); };\n            var constraintToSourceId_1 = function (constraint) {\n                var deviceId = constraint.deviceId;\n                if (typeof deviceId === \"string\") {\n                    return deviceId;\n                }\n                if (Array.isArray(deviceId) && deviceId.length > 0) {\n                    return deviceId[0];\n                }\n                if (typeof deviceId === \"object\" && deviceId.ideal) {\n                    return deviceId.ideal;\n                }\n                return null;\n            };\n            // @ts-ignore: deprecated api\n            MediaStreamTrack.getSources(function (sources) {\n                var audioSource = null;\n                var videoSource = null;\n                sources.forEach(function (source) {\n                    if (source.kind === \"audio\") {\n                        audioSource = source.id;\n                    }\n                    else if (source.kind === \"video\") {\n                        videoSource = source.id;\n                    }\n                });\n                var audioSourceId = constraintToSourceId_1(props.audioConstraints);\n                if (audioSourceId) {\n                    audioSource = audioSourceId;\n                }\n                var videoSourceId = constraintToSourceId_1(props.videoConstraints);\n                if (videoSourceId) {\n                    videoSource = videoSourceId;\n                }\n                sourceSelected(optionalSource_1(audioSource), optionalSource_1(videoSource));\n            });\n        }\n    };\n    Webcam.prototype.handleUserMedia = function (err, stream) {\n        var props = this.props;\n        if (err || !stream) {\n            this.setState({ hasUserMedia: false });\n            props.onUserMediaError(err);\n            return;\n        }\n        this.stream = stream;\n        try {\n            if (this.video) {\n                this.video.srcObject = stream;\n            }\n            this.setState({ hasUserMedia: true });\n        }\n        catch (error) {\n            this.setState({\n                hasUserMedia: true,\n                src: window.URL.createObjectURL(stream)\n            });\n        }\n        props.onUserMedia(stream);\n    };\n    Webcam.prototype.render = function () {\n        var _this = this;\n        var _a = this, state = _a.state, props = _a.props;\n        var audio = props.audio, forceScreenshotSourceSize = props.forceScreenshotSourceSize, disablePictureInPicture = props.disablePictureInPicture, onUserMedia = props.onUserMedia, onUserMediaError = props.onUserMediaError, screenshotFormat = props.screenshotFormat, screenshotQuality = props.screenshotQuality, minScreenshotWidth = props.minScreenshotWidth, minScreenshotHeight = props.minScreenshotHeight, audioConstraints = props.audioConstraints, videoConstraints = props.videoConstraints, imageSmoothing = props.imageSmoothing, mirrored = props.mirrored, _b = props.style, style = _b === void 0 ? {} : _b, children = props.children, rest = __rest(props, [\"audio\", \"forceScreenshotSourceSize\", \"disablePictureInPicture\", \"onUserMedia\", \"onUserMediaError\", \"screenshotFormat\", \"screenshotQuality\", \"minScreenshotWidth\", \"minScreenshotHeight\", \"audioConstraints\", \"videoConstraints\", \"imageSmoothing\", \"mirrored\", \"style\", \"children\"]);\n        var videoStyle = mirrored ? __assign(__assign({}, style), { transform: (style.transform || \"\") + \" scaleX(-1)\" }) : style;\n        var childrenProps = {\n            getScreenshot: this.getScreenshot.bind(this),\n        };\n        return (react__WEBPACK_IMPORTED_MODULE_0__[\"createElement\"](react__WEBPACK_IMPORTED_MODULE_0__[\"Fragment\"], null,\n            react__WEBPACK_IMPORTED_MODULE_0__[\"createElement\"](\"video\", __assign({ autoPlay: true, disablePictureInPicture: disablePictureInPicture, src: state.src, muted: !audio, playsInline: true, ref: function (ref) {\n                    _this.video = ref;\n                }, style: videoStyle }, rest)),\n            children && children(childrenProps)));\n    };\n    Webcam.defaultProps = {\n        audio: false,\n        disablePictureInPicture: false,\n        forceScreenshotSourceSize: false,\n        imageSmoothing: true,\n        mirrored: false,\n        onUserMedia: function () { return undefined; },\n        onUserMediaError: function () { return undefined; },\n        screenshotFormat: \"image/webp\",\n        screenshotQuality: 0.92,\n    };\n    return Webcam;\n}(react__WEBPACK_IMPORTED_MODULE_0__[\"Component\"]));\n/* harmony default export */ __webpack_exports__[\"default\"] = (Webcam);\n\n\n/***/ }),\n\n/***/ \"react\":\n/*!**************************************************************************************!*\\\n  !*** external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\"} ***!\n  \\**************************************************************************************/\n/*! no static exports found */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_react__;\n\n/***/ })\n\n/******/ })[\"default\"];\n});\n//# sourceMappingURL=react-webcam.js.map","import { irepsDictionary } from \"@/utils/utils\";\n\nconst useImage = () => {\n\t// convert a base64 image file to image dom element\n\t\n\tfunction _createImg(photo) {\n\t\tconst img = new Image();\n\t\timg.src = photo;\n\t\treturn img;\n\t}\n\n\tfunction prefixFileName(url, prefix) {\n\t\tlet filename = url.split(\"%2F\").pop();\n\t\tfilename = `${prefix}${filename}`;\n\t\treturn `${url.split(\"%2F\").slice(0, -1).join(\"%2F\")}%2F${filename}`;\n\t}\n\n\tfunction _resizer(img, size) {\n\t\t// console.log(`resize used`)\n\t\tlet x = 0,\n\t\t\ty = 0,\n\t\t\tw = 500,\n\t\t\th = 500;\n\n\t\tif (img.naturalWidth > img.naturalHeight) {\n\t\t\tif (img.naturalWidth > size) {\n\t\t\t\tw = size;\n\t\t\t\th = (size * img.naturalHeight) / img.naturalWidth;\n\t\t\t}\n\t\t} else {\n\t\t\tif (img.naturalHeight > size) {\n\t\t\t\th = size;\n\t\t\t\tw = (size * img.naturalWidth) / img.naturalHeight;\n\t\t\t}\n\t\t}\n\t\tconsole.log(x, y, w, h);\n\t\treturn [x, y, w, h];\n\t}\n\n\tfunction _cropper(img, size) {\n\t\t// console.log(`cropper used`)\n\t\tlet x = 0,\n\t\t\ty = 0,\n\t\t\tw = size,\n\t\t\th = size;\n\n\t\tif (img.naturalWidth > img.naturalHeight) {\n\t\t\tw = (size * img.naturalWidth) / img.naturalHeight;\n\t\t\tx = -Math.abs(w - size) / 2;\n\t\t} else {\n\t\t\th = (size * img.naturalHeight) / img.naturalWidth;\n\t\t\ty = -Math.abs(h - size) / 2;\n\t\t}\n\t\t// console.log(x, y, w, h);\n\t\treturn [x, y, w, h];\n\t}\n\n\tasync function getBase64URL(file) {\n\t\tif (!file || !file.type.startsWith(\"image/\"))\n\t\t\tthrow new Error(\"Only images are accepted (jpeg, gif, png)\");\n\t\tconst reader = new FileReader();\n\t\treader.readAsDataURL(file);\n\n\t\treturn new Promise(resolve => {\n\t\t\treader.onload = e => {\n\t\t\t\tresolve(e.target.result);\n\t\t\t};\n\t\t});\n\t}\n\n\tfunction resizeImg(photo, size, crop = false, mediaMetadata) {\n\t\t// console.log(`mediaMetadata`, mediaMetadata);\n\t\tconst {\n\t\t\tmediaCategory,\n\t\t\tastNo,\n\t\t\terfNo,\n\t\t\tcreatedAtDatetime,\n\t\t\tcreatedByUser,\n\t\t\tcreatedAtLocation,\n\t\t} = mediaMetadata;\n\t\tconst canvas = document.createElement(\"canvas\");\n\t\t// console.log(`canvas`, canvas);\n\n\t\tconst ctx = canvas.getContext(\"2d\");\n\t\tconst img = _createImg(photo);\n\t\t// console.log(`img`, img);\n\n\t\tconst [x, y, w, h] = crop ? _cropper(img, size) : _resizer(img, size);\n\t\t// console.log(`x,y, w,h :`, x, y, w, h);\n\t\tcanvas.width = crop ? size : w;\n\t\tcanvas.height = crop ? size : h;\n\n\t\tctx.drawImage(img, x, y, w, h);\n\t\t// console.log(`ctx`, ctx);\n\n\t\tctx.fillRect(10, 10, 420, 260)\n\t\tctx.fillStyle = \"white\";\n\t\tctx.font = \"30px sans-serif\";\n\t\tctx.fillText(irepsDictionary.get(mediaCategory), 10, 50);\n\t\tif (astNo) {\n\t\t\tctx.fillText(`Ast No: ${astNo}`, 10, 250);\n\t\t}\n\t\tif (erfNo) {\n\t\t\tctx.fillText(`Erf No: ${erfNo}`, 10, 250);\n\t\t}\n\t\tctx.fillText(createdAtDatetime, 10, 100);\n\t\tctx.fillText(createdByUser, 10, 150);\n\t\tctx.fillText(\n\t\t\t`(${Number(createdAtLocation?.lat).toFixed(6).trim()}/${Number(createdAtLocation?.lng).toFixed(6).trim()})`,\n\t\t\t10,\n\t\t\t200\n\t\t);\n\t\treturn new Promise(resolve => {\n\t\t\tcanvas.toBlob(blob => {\n\t\t\t\tresolve(blob);\n\t\t\t}, \"image/jpeg\");\n\t\t});\n\t}\n\n\treturn { resizeImg, getBase64URL, prefixFileName };\n};\n\nexport default useImage;\n","import { IconContext } from \"react-icons\";\nimport { MdOutlineClose } from \"react-icons/md\";\n\nimport \"@/components/irepsInfoWindow/WindowCloseBtn.css\";\n\nconst WindowCloseBtn = props => {\n\tconst { handleClose, color } = props;\n\tconst clr = color ? color : '#f2f'\n\treturn (\n\t\t<div className=\"window-close-btn\">\n\t\t\t<button onClick={handleClose} className=\"close-btn\">\n\t\t\t\t<IconContext.Provider value={{ color: clr }}>\n\t\t\t\t\t<MdOutlineClose />\n\t\t\t\t</IconContext.Provider>\n\t\t\t</button>\n\t\t</div>\n\t);\n};\n\nexport default WindowCloseBtn;\n","import { useCallback, useContext, useEffect, useRef, useState } from \"react\";\r\nimport { toast } from \"react-toastify\";\r\nimport Webcam from \"react-webcam\";\r\nimport { ClipLoader } from \"react-spinners\";\r\nimport { format } from \"date-fns\";\r\nimport { BsSend } from \"react-icons/bs\";\r\n\r\n// css\r\nimport \"@/components/media/MediaActionCamera.css\";\r\n\r\n// custom hooks\r\nimport useGeoLocation from \"@/hooks/useGeolocation.jsx\";\r\nimport useStorage from \"@/hooks/useStorage.jsx\";\r\nimport useImage from \"@/hooks/useImage.jsx\";\r\n\r\n// contexts\r\nimport useAuthContext from \"@/hooks/useAuthContext.jsx\";\r\nimport { MediaContext } from \"@/contexts/MediaContext.jsx\";\r\n\r\n// components\r\nimport { constants, irepsDictionary, irepsIcons } from \"@/utils/utils\";\r\nimport MediaActionBtn from \"@/components/media/MediaActionBtn\";\r\nimport WindowCloseBtn from \"@/components/irepsInfoWindow/WindowCloseBtn\";\r\n\r\nconst MediaActionCamera = (props) => {\r\n\t// console.log(`props`, props);\r\n\tconst { data } = props;\r\n\t// console.log(`data`, data);\r\n\r\n\tconst videoConstraints = {\r\n\t\tfacingMode: { exact: \"environment\" },\r\n\t};\r\n\r\n\tconst { irepsKeyItem } = data;\r\n\r\n\tlet keyItem;\r\n\tlet id;\r\n\tif (irepsKeyItem === \"trns\") {\r\n\t\tkeyItem = \"asts\";\r\n\t\tid = data.data.astData.astId;\r\n\t}\r\n\tif (irepsKeyItem === \"erfs\") {\r\n\t\tkeyItem = \"erfs\";\r\n\t\tid = data.data.id;\r\n\t}\r\n\t// console.log(`keyItem`, keyItem);\r\n\t// console.log(`id`, id);\r\n\r\n\tconst webcamRef = useRef(null);\r\n\r\n\tconst { uploadFile, url, error: storageError } = useStorage(data);\r\n\t// console.log(`progress`, progress);\r\n\t// console.log(`url`, url);\r\n\t// console.log(`storageError`, storageError);\r\n\t// const [selectedDevice, setSelectedDevice] = useState(null);\r\n\t// console.log(`selectedDevice`, selectedDevice);\r\n\r\n\t// const [file, setFile] = useState(null);\r\n\tconst [imgFile, setImgFile] = useState(null);\r\n\t// console.log(`imgFile`, imgFile);\r\n\r\n\tconst [resizedBase64URL, setResizedBase64URL] = useState(null);\r\n\t// console.log(`resizedBase64URL`, resizedBase64URL);\r\n\r\n\tconst [isPending, setIsPending] = useState(null);\r\n\t// console.log(`isPending`, isPending);\r\n\r\n\tconst [mediaMetadata, setMediaMetadata] = useState({});\r\n\t// console.log(`mediaMetadata`, mediaMetadata);\r\n\r\n\t// video constraints\r\n\tconst [vc, setVc] = useState(videoConstraints);\r\n\t// console.log(`vc`, vc);\r\n\r\n\tconst { user } = useAuthContext();\r\n\r\n\tconst claims = user?.claims;\r\n\t// console.log(`claims`, claims);\r\n\r\n\tconst { resizeImg, getBase64URL } = useImage();\r\n\r\n\tconst { mediaData, setMediaData } = useContext(MediaContext);\r\n\t// console.log(`mediaData`, mediaData);\r\n\r\n\tconst { mediaCat, trnId } = mediaData;\r\n\t// console.log(`mediaCat`, mediaCat);\r\n\r\n\tconst { userLocation } = useGeoLocation();\r\n\r\n\tconst captureImage = useCallback(\r\n\t\t(e) => {\r\n\t\t\tconst imageSrc = webcamRef.current.getScreenshot();\r\n\t\t\tsetImgFile((prev) => imageSrc);\r\n\r\n\t\t\tconst metaData = {\r\n\t\t\t\t// erfId: data.data.id,\r\n\t\t\t\t// erfNo: data.data.erfNo,\r\n\t\t\t\t// contentType: file?.type,\r\n\t\t\t\t// TODO: revisit - mediaType should not be hardcoded\r\n\t\t\t\tmediaType: \"image/jpeg\",\r\n\t\t\t\t// TODO: revisit - mediaCategory should not be hardcoded\r\n\t\t\t\tmediaCategory: mediaCat, // eg meter no photo, meter serail no photo , etc\r\n\t\t\t\tcreatedByUser: user.displayName,\r\n\t\t\t\tcreatedByUid: user.uid,\r\n\t\t\t\tcreatedAtDatetime: format(new Date(), constants.dateFormat2),\r\n\t\t\t\tcreatedAtLocation: {\r\n\t\t\t\t\tlat: userLocation?.coordinates?.lat,\r\n\t\t\t\t\tlng: userLocation?.coordinates?.lng,\r\n\t\t\t\t},\r\n\t\t\t};\r\n\r\n\t\t\t// erf case\r\n\t\t\tif (irepsKeyItem === \"erfs\") {\r\n\t\t\t\tsetMediaMetadata({\r\n\t\t\t\t\t...metaData,\r\n\t\t\t\t\terfId: data.data.id,\r\n\t\t\t\t\terfNo: data.data.erfNo,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t// ast case from trn\r\n\t\t\telse if (irepsKeyItem === \"trns\") {\r\n\t\t\t\tsetMediaMetadata({\r\n\t\t\t\t\t...metaData,\r\n\t\t\t\t\tastId: data.data.astData.astId,\r\n\t\t\t\t\tastNo: data.data.astData.astNo,\r\n\t\t\t\t\ttrnId,\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log(`throw error`);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[\r\n\t\t\tdata.erfNo,\r\n\t\t\tdata.id,\r\n\t\t\tuser.displayName,\r\n\t\t\tuser.uid,\r\n\t\t\tuserLocation?.coordinates?.lat,\r\n\t\t\tuserLocation?.coordinates?.lng,\r\n\t\t]\r\n\t);\r\n\r\n\tconst closeMediaAction = (e) => {\r\n\t\tsetMediaData({\r\n\t\t\t...mediaData,\r\n\t\t\tactiveMediaAction: null,\r\n\t\t});\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\tresizeImg(imgFile, 1200, true, mediaMetadata).then((blob) => {\r\n\t\t\t// console.log(`blob`, blob);\r\n\t\t\tif (imgFile) {\r\n\t\t\t\tgetBase64URL(blob).then((resizedFile) => {\r\n\t\t\t\t\t// console.log(`resizedFile`, resizedFile);\r\n\t\t\t\t\tsetResizedBase64URL(resizedFile);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}, [imgFile, mediaData, getBase64URL, mediaMetadata, resizeImg]);\r\n\r\n\tconst uploadMedia = (e) => {\r\n\t\t// Check id data is ready for upload.\r\n\t\t// console.log(`uploading camera`, e);\r\n\r\n\t\tif (!mediaMetadata.createdAtLocation.lat) {\r\n\t\t\ttoast.error(`Cannot upload without user Gps coordinates.`, {\r\n\t\t\t\tposition: \"top-right\",\r\n\t\t\t});\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tsetIsPending(true);\r\n\t\tuploadFile(resizedBase64URL, keyItem, id, mediaMetadata, \"image\");\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\t// console.log(`url`, url);\r\n\t\tif (Boolean(url) || storageError) {\r\n\t\t\tsetIsPending(false);\r\n\t\t\t// remove file - this will remove image from MediaActionCamera window\r\n\t\t\tsetImgFile(null);\r\n\t\t\t// hide MediaActionCamera window\r\n\t\t\tsetMediaData({\r\n\t\t\t\t...mediaData,\r\n\t\t\t\tactiveMediaAction: null,\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (storageError) {\r\n\t\t\ttoast.error(`Storage Error : ${storageError}`, {\r\n\t\t\t\tposition: \"top-right\",\r\n\t\t\t});\r\n\t\t} // free memory when ever this component is unmounted\r\n\t\treturn () => {\r\n\t\t\tsetResizedBase64URL(null);\r\n\t\t\t// setBase64URL(null);\r\n\t\t};\r\n\t}, [url, storageError, mediaData, setMediaData]);\r\n\r\n\tconst discard = () => {\r\n\t\t// console.log(`discard`);\r\n\t\tsetImgFile(\"\");\r\n\t\tsetResizedBase64URL(\"\");\r\n\t};\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => {\r\n\t\t\tsetVc(videoConstraints);\r\n\t\t};\r\n\t}, []);\r\n\r\n\tconst chooseDevice = (e) => {\r\n\t\t// console.log(`e.currentTarget.id`, e.currentTarget.id);\r\n\t\tsetVc({\r\n\t\t\t...vc,\r\n\t\t\tfacingMode:\r\n\t\t\t\te.currentTarget.id === \"front\" ? \"user\" : { exact: \"environment\" },\r\n\t\t});\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"media-action-camera\">\r\n\t\t\t<div className=\"media-catergory\">\r\n\t\t\t\t<p className=\"media-cat\">\r\n\t\t\t\t\tTake {irepsDictionary.get(mediaData.mediaCat)} Photo\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t\t{resizedBase64URL ? (\r\n\t\t\t\t<div className=\"macpp resized\">\r\n\t\t\t\t\t{resizedBase64URL && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\tclassName=\"img-preview\"\r\n\t\t\t\t\t\t\t\twidth={150}\r\n\t\t\t\t\t\t\t\theight={150}\r\n\t\t\t\t\t\t\t\tsrc={resizedBase64URL}\r\n\t\t\t\t\t\t\t\talt=\"resizedBase64URL\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t) : (\r\n\t\t\t\t<div className=\"macpp original\">\r\n\t\t\t\t\t<Webcam\r\n\t\t\t\t\t\tclassName=\"webcam\"\r\n\t\t\t\t\t\twidth={400}\r\n\t\t\t\t\t\theight={400}\r\n\t\t\t\t\t\tref={webcamRef}\r\n\t\t\t\t\t\tvideoConstraints={vc}\r\n\t\t\t\t\t\tscreenshotFormat=\"image/jpeg\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t<div className=\"mac mac-control-bar\">\r\n\t\t\t\t<div className=\"maccb maccb-left\">\r\n\t\t\t\t\t{!imgFile && (\r\n\t\t\t\t\t\t<MediaActionBtn\r\n\t\t\t\t\t\t\tid={\"\"}\r\n\t\t\t\t\t\t\tactionClassname={\"\"}\r\n\t\t\t\t\t\t\ttitle={\"click to take a photo\"}\r\n\t\t\t\t\t\t\tclickHanderFunction={captureImage}\r\n\t\t\t\t\t\t\tactionIcon={irepsIcons.ICON_CAMERA_SHOOT}\r\n\t\t\t\t\t\t\tcolor={\"blue\"}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{/* discard the photo taken taken if not desired */}\r\n\t\t\t\t\t{imgFile && (\r\n\t\t\t\t\t\t<MediaActionBtn\r\n\t\t\t\t\t\t\tid={\"\"}\r\n\t\t\t\t\t\t\tactionClassname={\"\"}\r\n\t\t\t\t\t\t\ttitle={\"click to discard\"}\r\n\t\t\t\t\t\t\tclickHanderFunction={discard}\r\n\t\t\t\t\t\t\tactionIcon={irepsIcons.ICON_DELETE}\r\n\t\t\t\t\t\t\tcolor={\"brown\"}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<MediaActionBtn\r\n\t\t\t\t\t\t\tid={\"selfie\"}\r\n\t\t\t\t\t\t\tactionClassname={\"\"}\r\n\t\t\t\t\t\t\ttitle={\"SELFIE photo\"}\r\n\t\t\t\t\t\t\tclickHanderFunction={chooseDevice}\r\n\t\t\t\t\t\t\tactionIcon={irepsIcons.ICON_CAMERA_SELFIE}\r\n\t\t\t\t\t\t\tcolor={\"green\"}\r\n\t\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t\t{/* Choose selfie camera */}\r\n\t\t\t\t\t\t<MediaActionBtn\r\n\t\t\t\t\t\t\tid={\"front\"}\r\n\t\t\t\t\t\t\tactionClassname={\"\"}\r\n\t\t\t\t\t\t\ttitle={\"FRONT photo\"}\r\n\t\t\t\t\t\t\tclickHanderFunction={chooseDevice}\r\n\t\t\t\t\t\t\tactionIcon={irepsIcons.ICON_CAMERA_FRONT2}\r\n\t\t\t\t\t\t\tcolor={\"red\"}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"maccb maccb-right\">\r\n\t\t\t\t\t{resizedBase64URL && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t{claims.guest ? (\r\n\t\t\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tdisabled={!Boolean(imgFile)}\r\n\t\t\t\t\t\t\t\t\t// title={title}\r\n\t\t\t\t\t\t\t\t\tclassName=\"mab btn-submit-form\"\r\n\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\tonClick={uploadMedia}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{isPending ? (\r\n\t\t\t\t\t\t\t\t\t\t<ClipLoader\r\n\t\t\t\t\t\t\t\t\t\t\tcolor={\"#F86F03\"}\r\n\t\t\t\t\t\t\t\t\t\t\tloading={isPending < 100}\r\n\t\t\t\t\t\t\t\t\t\t\tsize={20}\r\n\t\t\t\t\t\t\t\t\t\t\taria-label=\"Loading Spinner\"\r\n\t\t\t\t\t\t\t\t\t\t\tdata-testid=\"loader\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<BsSend />\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<WindowCloseBtn handleClose={closeMediaAction} />\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default MediaActionCamera;\r\n\r\n{\r\n\t/* <button onClick={chooseDevice} className={`device${index}`} id={index}>\r\n\t<span className=\"label\">{`Camera_${index}`}</span>\r\n\t<IconContext.Provider value={{ color: \"yellow\" }}>\r\n\t\t<TbCameraSelfie />\r\n\t</IconContext.Provider>\r\n</button>; */\r\n}\r\n\r\n// <div className=\"mac mac-control-bar\">\r\n// \t<div className=\"maccb maccb-left\">\r\n// \t\t{!imgFile && (\r\n// \t\t\t<button onClick={captureImage}>\r\n// \t\t\t\t<IconContext.Provider value={{ color: \"blue\" }}>\r\n// \t\t\t\t\t<MdCamera />\r\n// \t\t\t\t</IconContext.Provider>\r\n// \t\t\t</button>\r\n// \t\t)}\r\n\r\n// \t\t{/* discard the photo taken taken if not desired */}\r\n// \t\t{imgFile && (\r\n// \t\t\t<button onClick={discard}>\r\n// \t\t\t\t<IconContext.Provider value={{ color: \"brown\" }}>\r\n// \t\t\t\t\t<VscDiscard />\r\n// \t\t\t\t</IconContext.Provider>\r\n// \t\t\t</button>\r\n// \t\t)}\r\n\r\n// \t\t{devices?.length > 1 &&\r\n// \t\t\tdevices?.map((device, index) => {\r\n// \t\t\t\treturn (\r\n// \t\t\t\t\t<button onClick={chooseDevice} className={`device${index}`} id={index}>\r\n// \t\t\t\t\t\t<span className=\"label\">{`Camera_${index}`}</span>\r\n// \t\t\t\t\t\t<IconContext.Provider value={{ color: \"yellow\" }}>\r\n// \t\t\t\t\t\t\t{/* {iconSelection[index]} */}\r\n// \t\t\t\t\t\t\t<TbCameraSelfie />\r\n// \t\t\t\t\t\t</IconContext.Provider>\r\n// \t\t\t\t\t</button>\r\n// \t\t\t\t);\r\n// \t\t\t})}\r\n// \t</div>\r\n\r\n// \t<div className=\"maccb maccb-right\">\r\n// \t\t{resizedBase64URL && (\r\n// \t\t\t<>\r\n// \t\t\t\t<button\r\n// \t\t\t\t\tdisabled={!Boolean(imgFile)}\r\n// \t\t\t\t\t// title={title}\r\n// \t\t\t\t\tclassName=\"form-btn btn-submit-form\"\r\n// \t\t\t\t\ttype=\"button\"\r\n// \t\t\t\t\tonClick={uploadMedia}\r\n// \t\t\t\t>\r\n// \t\t\t\t\t{isPending ? (\r\n// \t\t\t\t\t\t<ClipLoader\r\n// \t\t\t\t\t\t\tcolor={\"#F86F03\"}\r\n// \t\t\t\t\t\t\tloading={isPending < 100}\r\n// \t\t\t\t\t\t\tsize={20}\r\n// \t\t\t\t\t\t\taria-label=\"Loading Spinner\"\r\n// \t\t\t\t\t\t\tdata-testid=\"loader\"\r\n// \t\t\t\t\t\t/>\r\n// \t\t\t\t\t) : (\r\n// \t\t\t\t\t\t<BsSend />\r\n// \t\t\t\t\t)}\r\n// \t\t\t\t</button>\r\n// \t\t\t</>\r\n// \t\t)}\r\n\r\n// \t\t<button type=\"button\" className=\"mac-btn\" onClick={closeMediaAction}>\r\n// \t\t\tX\r\n// \t\t</button>\r\n// \t</div>\r\n// </div>;\r\n","import { toast } from \"react-toastify\";\nimport { ClipLoader, ScaleLoader } from \"react-spinners\";\nimport { useContext, useEffect, useRef, useState } from \"react\";\nimport { BsSend } from \"react-icons/bs\";\nimport { format } from \"date-fns\";\n\nimport \"@/components/media/MediaActionVoice.css\";\n\nimport useAuthContext from \"@/hooks/useAuthContext.jsx\";\nimport useGeoLocation from \"@/hooks/useGeolocation.jsx\";\nimport useStorage from \"@/hooks/useStorage.jsx\";\n\nimport { MediaContext } from \"@/contexts/MediaContext.jsx\";\n\nimport { constants, irepsIcons } from \"@/utils/utils\";\nimport WindowCloseBtn from \"@/components/irepsInfoWindow/WindowCloseBtn\";\nimport MediaActionBtn from \"@/components/media/MediaActionBtn\";\n\nconst mimeType = \"audio/webm\";\n\nconst MediaActionVoice = props => {\n\t// console.log(`MediaActionVoice props`, props);\n\tconst { data } = props;\n\n\tconst [permission, setPermission] = useState(false);\n\t// console.log(`permission`, permission);\n\n\tconst mediaRecorder = useRef(null);\n\n\tconst [recordingStatus, setRecordingStatus] = useState(\"inactive\");\n\t// console.log(`recordingStatus`, recordingStatus);\n\n\tconst [stream, setStream] = useState(null);\n\t// console.log(`stream`, stream);\n\n\tconst [audioChunks, setAudioChunks] = useState([]);\n\t// console.log(`audioChunks`, audioChunks);\n\n\tconst [audio, setAudio] = useState(null);\n\t// console.log(`audio`, audio);\n\n\tconst [audioBlob, setAudioBlob] = useState(null);\n\t// console.log(`audioBlob`, audioBlob);\n\n\tconst [isPending, setIsPending] = useState(null);\n\t// console.log(`isPending`, isPending);\n\n\tconst { uploadFile, url, error: storageError } = useStorage(data);\n\n\tconst [mediaMetadata, setMediaMetadata] = useState({});\n\t// console.log(`mediaMetadata`, mediaMetadata);\n\n\tconst { user } = useAuthContext();\n\n\tconst { mediaData, setMediaData } = useContext(MediaContext);\n\n\tconst { userLocation } = useGeoLocation();\n\n\tconst uploadMedia = e => {\n\t\t// Check id data is ready for upload.\n\t\t// console.log(`uploading voice`, e)\n\t\tif (!mediaMetadata.createdAtLocation.lat) {\n\t\t\ttoast.error(`Cannot upload without user Gps coordinates.`, {\n\t\t\t\tposition: \"top-right\",\n\t\t\t});\n\t\t\treturn null;\n\t\t}\n\t\tsetIsPending(true);\n\t\tuploadFile(\n\t\t\taudioBlob,\n\t\t\tdata.irepsKeyItem,\n\t\t\tdata.data.id,\n\t\t\tmediaMetadata,\n\t\t\t\"audio\"\n\t\t);\n\t};\n\n\tuseEffect(() => {\n\t\t// console.log(`url`, url);\n\t\tif (Boolean(url) || storageError) {\n\t\t\tsetIsPending(false);\n\t\t\t// hide MediaActionVoice window\n\t\t\tsetMediaData({\n\t\t\t\t...mediaData,\n\t\t\t\tactiveMediaAction: null,\n\t\t\t});\n\t\t}\n\t\tif (storageError) {\n\t\t\ttoast.error(`Storage Error : ${storageError}`, {\n\t\t\t\tposition: \"top-right\",\n\t\t\t});\n\t\t} // free memory when ever this component is unmounted\n\t\treturn () => {\n\t\t\tsetAudio(null);\n\t\t\t// setBase64URL(null);\n\t\t};\n\t}, [url, storageError, mediaData, setMediaData]);\n\n\tconst discard = e => {\n\t\tconsole.log(`discard`);\n\t\tsetAudio(null);\n\t\tsetAudioBlob(null);\n\t\tsetAudioChunks(null);\n\t};\n\n\tconst closeMediaAction = e => {\n\t\tsetMediaData({\n\t\t\t...mediaData,\n\t\t\tactiveMediaAction: null,\n\t\t});\n\t};\n\n\tconst getMicrophonePermission = async () => {\n\t\tif (\"MediaRecorder\" in window) {\n\t\t\ttry {\n\t\t\t\tconst streamData = await navigator.mediaDevices.getUserMedia({\n\t\t\t\t\taudio: true,\n\t\t\t\t\tvideo: false,\n\t\t\t\t});\n\t\t\t\tsetPermission(true);\n\t\t\t\tsetStream(streamData);\n\t\t\t} catch (err) {\n\t\t\t\talert(err.message);\n\t\t\t}\n\t\t} else {\n\t\t\talert(\"The MediaRecorder API is not supported in your browser.\");\n\t\t}\n\t};\n\n\tconst startRecording = async () => {\n\t\tsetRecordingStatus(\"recording\");\n\t\t//create new Media recorder instance using the stream\n\t\tconst media = new MediaRecorder(stream, { type: \"mime/mp4\" });\n\t\t//set the MediaRecorder instance to the mediaRecorder ref\n\t\tmediaRecorder.current = media;\n\t\t//invokes the start method to start the recording process\n\t\tmediaRecorder.current.start();\n\t\tlet localAudioChunks = [];\n\t\tmediaRecorder.current.ondataavailable = event => {\n\t\t\tif (typeof event.data === \"undefined\") return;\n\t\t\tif (event.data.size === 0) return;\n\t\t\tlocalAudioChunks.push(event.data);\n\t\t};\n\t\tsetAudioChunks(localAudioChunks);\n\t};\n\n\tconst stopRecording = () => {\n\t\t// console.log(`stop audio recording`);\n\t\tsetRecordingStatus(\"inactive\");\n\t\t//stops the recording instance\n\t\tmediaRecorder.current.stop();\n\t\tmediaRecorder.current.onstop = () => {\n\t\t\t// console.log(`stop audio recording  callback - audioChunks :`, audioChunks);\n\t\t\t//creates a blob file from the audiochunks data\n\t\t\tconst audioBlob = new Blob(audioChunks, { type: mimeType });\n\t\t\t//creates a playable URL from the blob file.\n\t\t\tconst audioUrl = URL.createObjectURL(audioBlob);\n\t\t\tsetAudio(audioUrl);\n\t\t\tsetAudioBlob(audioBlob);\n\t\t\t// setAudioChunks([]);\n\t\t\tsetMediaMetadata({\n\t\t\t\terfId: data.data.id,\n\t\t\t\terfNo: data.data.erfNo,\n\t\t\t\t// contentType: file?.type,\n\t\t\t\t// TODO: revisit - mediaType should not be hardcoded\n\t\t\t\tmediaType: mimeType,\n\t\t\t\t// TODO: revisit - mediaCategory should not be hardcoded\n\t\t\t\tmediaCategory: \"erfAudio\", // eg meter no photo, meter serail no photo , etc\n\t\t\t\tcreatedByUser: user.displayName,\n\t\t\t\tcreatedByUid: user.uid,\n\t\t\t\tcreatedAtDatetime: format(new Date(), constants.dateFormat2),\n\t\t\t\tcreatedAtLocation: {\n\t\t\t\t\tlat: userLocation?.coordinates?.lat,\n\t\t\t\t\tlng: userLocation?.coordinates?.lng,\n\t\t\t\t},\n\t\t\t});\n\t\t};\n\t};\n\n\treturn (\n\t\t<div className=\"media-action-voice\">\n\t\t\t<div className=\"recording-status\">\n\t\t\t\t{audio && recordingStatus !== \"recording\" && (\n\t\t\t\t\t// display audio player\n\t\t\t\t\t<div className=\"audio-player\">\n\t\t\t\t\t\t<audio src={audio} controls></audio>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t{recordingStatus === \"recording\" && (\n\t\t\t\t\t<>\n\t\t\t\t\t\t<ScaleLoader\n\t\t\t\t\t\t\tcolor={\"#F86F03\"}\n\t\t\t\t\t\t\tloading={isPending < 100}\n\t\t\t\t\t\t\tsize={20}\n\t\t\t\t\t\t\taria-label=\"Loading Spinner\"\n\t\t\t\t\t\t\tdata-testid=\"loader\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ScaleLoader\n\t\t\t\t\t\t\tcolor={\"#F86F03\"}\n\t\t\t\t\t\t\tloading={isPending < 100}\n\t\t\t\t\t\t\tsize={20}\n\t\t\t\t\t\t\taria-label=\"Loading Spinner\"\n\t\t\t\t\t\t\tdata-testid=\"loader\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t<div className=\"mac mac-control-bar\">\n\t\t\t\t<div className=\"maccb maccb-left\">\n\t\t\t\t\t{/* Btn to get permission to record audio */}\n\t\t\t\t\t{!permission && (\n\t\t\t\t\t\t<MediaActionBtn\n\t\t\t\t\t\t\tid={\"\"}\n\t\t\t\t\t\t\tactionClassname={\"\"}\n\t\t\t\t\t\t\ttitle={\"Get PERMISSION to record voice\"}\n\t\t\t\t\t\t\tclickHanderFunction={getMicrophonePermission}\n\t\t\t\t\t\t\tactionIcon={irepsIcons.ICON_PERMISSION}\n\t\t\t\t\t\t\tcolor={\"blue\"}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{/* Btn to discard recorded audio */}\n\t\t\t\t\t{audio && (\n\t\t\t\t\t\t<MediaActionBtn\n\t\t\t\t\t\t\tid={\"\"}\n\t\t\t\t\t\t\tactionClassname={\"\"}\n\t\t\t\t\t\t\ttitle={\"DISCARD recorded voice\"}\n\t\t\t\t\t\t\tclickHanderFunction={discard}\n\t\t\t\t\t\t\tactionIcon={irepsIcons.ICON_DELETE}\n\t\t\t\t\t\t\tcolor={\"blue\"}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{/* Btn to start voice recording */}\n\t\t\t\t\t{!audio && permission && (\n\t\t\t\t\t\t<MediaActionBtn\n\t\t\t\t\t\t\tid={\"\"}\n\t\t\t\t\t\t\tactionClassname={\"\"}\n\t\t\t\t\t\t\ttitle={\"START vocie recording\"}\n\t\t\t\t\t\t\tclickHanderFunction={startRecording}\n\t\t\t\t\t\t\tactionIcon={irepsIcons.ICON_START_RECORDING}\n\t\t\t\t\t\t\tcolor={\"blue\"}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{/* Btn to stop voice recording */}\n\t\t\t\t\t{recordingStatus === \"recording\" && (\n\t\t\t\t\t\t<MediaActionBtn\n\t\t\t\t\t\t\tid={\"\"}\n\t\t\t\t\t\t\tactionClassname={\"\"}\n\t\t\t\t\t\t\ttitle={\"STOP voice recording\"}\n\t\t\t\t\t\t\tclickHanderFunction={stopRecording}\n\t\t\t\t\t\t\tactionIcon={irepsIcons.ICON_STOP}\n\t\t\t\t\t\t\tcolor={\"blue\"}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"maccb maccb-right\">\n\t\t\t\t\t{audio && (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tdisabled={!audio}\n\t\t\t\t\t\t\t// title={title}\n\t\t\t\t\t\t\tclassName=\"mab\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tonClick={uploadMedia}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{isPending ? (\n\t\t\t\t\t\t\t\t<ClipLoader\n\t\t\t\t\t\t\t\t\tcolor={\"#F86F03\"}\n\t\t\t\t\t\t\t\t\tloading={isPending < 100}\n\t\t\t\t\t\t\t\t\tsize={20}\n\t\t\t\t\t\t\t\t\taria-label=\"Loading Spinner\"\n\t\t\t\t\t\t\t\t\tdata-testid=\"loader\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<BsSend />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t)}\n\n\t\t\t\t\t<WindowCloseBtn handleClose={closeMediaAction} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default MediaActionVoice;\n","import Webcam from \"react-webcam\";\nimport { toast } from \"react-toastify\";\nimport { ClipLoader } from \"react-spinners\";\nimport { useCallback, useContext, useEffect, useRef, useState } from \"react\";\nimport { BsSend } from \"react-icons/bs\";\nimport { format } from \"date-fns\";\n\nimport \"@/components/media/MediaActionVideo.css\";\n\nimport useAuthContext from \"@/hooks/useAuthContext.jsx\";\nimport useGeoLocation from \"@/hooks/useGeolocation.jsx\";\n\nimport { MediaContext } from \"@/contexts/MediaContext.jsx\";\n\nimport useStorage from \"@/hooks/useStorage\";\nimport { constants } from \"@/utils/utils\";\nimport MediaActionBtn from \"@/components/media/MediaActionBtn\";\nimport WindowCloseBtn from \"@/components/irepsInfoWindow/WindowCloseBtn\";\nimport { irepsIcons } from \"@/utils/utils\";\n\nconst videoConstraints = {\n\tfacingMode: \"user\",\n};\n\nconst mimeType = \"video/webm\";\n\nconst MediaActionVideo = props => {\n\t// console.log(`props`, props);\n\tconst { data } = props;\n\n\tconst webcamRef = useRef(null);\n\n\tconst mediaRecorderRef = useRef(null);\n\t// console.log(`mediaRecorderRef.current`, mediaRecorderRef.current);\n\n\tconst [recording, setRecording] = useState(false);\n\t// console.log(`recording`, recording);\n\n\tconst [recordedChunks, setRecordedChunks] = useState([]);\n\t// console.log(`recordedChunks`, recordedChunks);\n\n\tconst [video, setVideo] = useState(null);\n\t// console.log(`video`, video);\n\n\tconst [videoBlob, setVideoBlob] = useState(null);\n\t// console.log(`videoBlob`, videoBlob);\n\n\tconst { uploadFile, url, error: storageError } = useStorage(data);\n\n\tconst [isPending, setIsPending] = useState(null);\n\t// console.log(`isPending`, isPending);\n\n\tconst [mediaMetadata, setMediaMetadata] = useState({});\n\t// console.log(`mediaMetadata`, mediaMetadata);\n\n\t// video constraints\n\tconst [vc, setVc] = useState(videoConstraints);\n\n\tconst { user } = useAuthContext();\n\n\t// const { resizeImg, getBase64URL } = useImage();\n\n\tconst { mediaData, setMediaData } = useContext(MediaContext);\n\n\tconst { userLocation } = useGeoLocation();\n\n\tconst closeMediaAction = e => {\n\t\tsetMediaData({\n\t\t\t...mediaData,\n\t\t\tactiveMediaAction: null,\n\t\t});\n\t};\n\n\tconst uploadMedia = e => {\n\t\t// Check id data is ready for upload.\n\t\t// console.log(`uploading video e: `, e);\n\t\t// console.log(`uploading video : `, video);\n\t\t// console.log(`uploading recordedChunks : `, recordedChunks);\n\n\t\tif (!mediaMetadata.createdAtLocation.lat) {\n\t\t\ttoast.error(`Cannot upload without user Gps coordinates.`, {\n\t\t\t\tposition: \"top-right\",\n\t\t\t});\n\t\t\treturn null;\n\t\t}\n\t\tsetIsPending(true);\n\t\tuploadFile(\n\t\t\tvideoBlob,\n\t\t\tdata.irepsKeyItem,\n\t\t\tdata.data.id,\n\t\t\tmediaMetadata,\n\t\t\t\"video\"\n\t\t);\n\t};\n\n\tuseEffect(() => {\n\t\t// console.log(`url`, url);\n\t\tif (Boolean(url) || storageError) {\n\t\t\tsetIsPending(false);\n\t\t\t// remove file - this will remove image from MediaActionVideo window\n\t\t\tsetVideo(null);\n\t\t\tsetRecordedChunks([]);\n\t\t\t// hide MediaActionVideo window\n\t\t\tsetMediaData({\n\t\t\t\t...mediaData,\n\t\t\t\tactiveMediaAction: null,\n\t\t\t});\n\t\t}\n\t\tif (storageError) {\n\t\t\ttoast.error(`Storage Error : ${storageError}`, {\n\t\t\t\tposition: \"top-right\",\n\t\t\t});\n\t\t} // free memory when ever this component is unmounted\n\t\treturn () => {\n\t\t\tsetVideo(null);\n\t\t\tsetRecordedChunks([]);\n\t\t};\n\t}, [url, storageError, mediaData, setMediaData]);\n\n\tconst discard = e => {\n\t\tsetVideo(null);\n\t\tsetRecordedChunks([]);\n\t};\n\n\tconst chooseDevice = e => {\n\t\tconsole.log(`e.currentTarget.id`, e.currentTarget.id);\n\t\tsetVc({\n\t\t\t...vc,\n\t\t\tfacingMode:\n\t\t\t\te.currentTarget.id === \"selfie\" ? \"user\" : { exact: \"environment\" },\n\t\t});\n\t};\n\n\tconst handleDataAvailable = useCallback(\n\t\t({ data }) => {\n\t\t\tif (data.size > 0) {\n\t\t\t\tsetRecordedChunks(prev => prev.concat(data));\n\t\t\t}\n\t\t},\n\t\t[setRecordedChunks]\n\t);\n\n\tconst handleStartCaptureClick = useCallback(() => {\n\t\tsetRecording(true);\n\t\tmediaRecorderRef.current = new MediaRecorder(webcamRef?.current?.stream, {\n\t\t\tmimeType: mimeType,\n\t\t});\n\t\tmediaRecorderRef.current.addEventListener(\n\t\t\t\"dataavailable\",\n\t\t\thandleDataAvailable\n\t\t);\n\t\tmediaRecorderRef.current.start();\n\t}, [webcamRef, setRecording, mediaRecorderRef, handleDataAvailable]);\n\n\tconst handleStopCaptureClick = useCallback(() => {\n\t\tmediaRecorderRef?.current?.stop();\n\t\tsetRecording(false);\n\t\tsetMediaMetadata({\n\t\t\terfId: data.data.id,\n\t\t\terfNo: data.data.erfNo,\n\t\t\t// contentType: file?.type,\n\t\t\t// TODO: revisit - mediaType should not be hardcoded\n\t\t\tmediaType: mimeType,\n\t\t\t// TODO: revisit - mediaCategory should not be hardcoded\n\t\t\tmediaCategory: \"erfVideo\", // eg meter no photo, meter serail no photo , etc\n\t\t\tcreatedByUser: user.displayName,\n\t\t\tcreatedByUid: user.uid,\n\t\t\tcreatedAtDatetime: format(new Date(), constants.dateFormat2),\n\t\t\tcreatedAtLocation: {\n\t\t\t\tlat: userLocation?.coordinates?.lat,\n\t\t\t\tlng: userLocation?.coordinates?.lng,\n\t\t\t},\n\t\t});\n\t}, [\n\t\tmediaRecorderRef,\n\t\tsetRecording,\n\t\tdata.erfNo,\n\t\tdata.id,\n\t\tuser.displayName,\n\t\tuser.uid,\n\t\tuserLocation?.coordinates?.lat,\n\t\tuserLocation?.coordinates?.lng,\n\t]);\n\n\tuseEffect(() => {\n\t\tif (recordedChunks.length > 0) {\n\t\t\tconst blob = new Blob(recordedChunks, {\n\t\t\t\ttype: \"video/webm\",\n\t\t\t});\n\t\t\tconst url = URL.createObjectURL(blob);\n\t\t\tsetVideo(url);\n\t\t\tsetVideoBlob(blob);\n\t\t}\n\t}, [recordedChunks]);\n\n\treturn (\n\t\t<div className=\"media-action-camera\">\n\t\t\t{video ? (\n\t\t\t\t<div className=\"macpp \">\n\t\t\t\t\t<video controls src={video} autoplay></video>\n\t\t\t\t</div>\n\t\t\t) : (\n\t\t\t\t<div className=\"macpp original\">\n\t\t\t\t\t<Webcam\n\t\t\t\t\t\tclassName=\"webcam\"\n\t\t\t\t\t\twidth={400}\n\t\t\t\t\t\theight={400}\n\t\t\t\t\t\tref={webcamRef}\n\t\t\t\t\t\tvideoConstraints={vc}\n\t\t\t\t\t\tscreenshotFormat=\"image/jpeg\"\n\t\t\t\t\t\tvideo={\"true\"}\n\t\t\t\t\t\taudio={\"true\"}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t<div className=\"mac mac-control-bar\">\n\t\t\t\t<div className=\"maccb maccb-left\">\n\t\t\t\t\t{/* Start recording a video */}\n\t\t\t\t\t{!recording && !video && (\n\t\t\t\t\t\t<MediaActionBtn\n\t\t\t\t\t\t\tid={\"\"}\n\t\t\t\t\t\t\tactionClassname={\"\"}\n\t\t\t\t\t\t\ttitle={\"START recording\"}\n\t\t\t\t\t\t\tclickHanderFunction={handleStartCaptureClick}\n\t\t\t\t\t\t\tactionIcon={irepsIcons.ICON_VIDEO_RECORDING2}\n\t\t\t\t\t\t\tcolor={\"blue\"}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{/* Stop recording */}\n\t\t\t\t\t{recording && (\n\t\t\t\t\t\t<MediaActionBtn\n\t\t\t\t\t\t\tid={\"\"}\n\t\t\t\t\t\t\tactionClassname={\"\"}\n\t\t\t\t\t\t\ttitle={\"STOP recording\"}\n\t\t\t\t\t\t\tclickHanderFunction={handleStopCaptureClick}\n\t\t\t\t\t\t\tactionIcon={irepsIcons.ICON_STOP}\n\t\t\t\t\t\t\tcolor={\"brown\"}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{/* Choose front camera */}\n\t\t\t\t\t{!video && !recording && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<MediaActionBtn\n\t\t\t\t\t\t\t\tid={\"selfie\"}\n\t\t\t\t\t\t\t\tactionClassname={\"\"}\n\t\t\t\t\t\t\t\ttitle={\"SELFIE photo\"}\n\t\t\t\t\t\t\t\tclickHanderFunction={chooseDevice}\n\t\t\t\t\t\t\t\tactionIcon={irepsIcons.ICON_CAMERA_SELFIE}\n\t\t\t\t\t\t\t\tcolor={\"green\"}\n\t\t\t\t\t\t\t/>\n\n\t\t\t\t\t\t\t{/* Choose selfie camera */}\n\t\t\t\t\t\t\t<MediaActionBtn\n\t\t\t\t\t\t\t\tid={\"front\"}\n\t\t\t\t\t\t\t\tactionClassname={\"\"}\n\t\t\t\t\t\t\t\ttitle={\"FRONT photo\"}\n\t\t\t\t\t\t\t\tclickHanderFunction={chooseDevice}\n\t\t\t\t\t\t\t\tactionIcon={irepsIcons.ICON_CAMERA_FRONT2}\n\t\t\t\t\t\t\t\tcolor={\"orange\"}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{/* Discard video recording */}\n\t\t\t\t\t{video && (\n\t\t\t\t\t\t<MediaActionBtn\n\t\t\t\t\t\t\tid={\"discard\"}\n\t\t\t\t\t\t\tactionClassname={\"\"}\n\t\t\t\t\t\t\ttitle={\"DISCARD video\"}\n\t\t\t\t\t\t\tclickHanderFunction={discard}\n\t\t\t\t\t\t\tactionIcon={irepsIcons.ICON_DELETE}\n\t\t\t\t\t\t\tcolor={\"red\"}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"maccb maccb-right\">\n\t\t\t\t\t{video && (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tdisabled={!Boolean(video)}\n\t\t\t\t\t\t\t// title={title}\n\t\t\t\t\t\t\tclassName=\"mab btn-submit-form\"\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tonClick={uploadMedia}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{isPending ? (\n\t\t\t\t\t\t\t\t<ClipLoader\n\t\t\t\t\t\t\t\t\tcolor={\"#F86F03\"}\n\t\t\t\t\t\t\t\t\tloading={isPending < 100}\n\t\t\t\t\t\t\t\t\tsize={20}\n\t\t\t\t\t\t\t\t\taria-label=\"Loading Spinner\"\n\t\t\t\t\t\t\t\t\tdata-testid=\"loader\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t<BsSend />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t)}\n\t\t\t\t\t<WindowCloseBtn handleClose={closeMediaAction} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default MediaActionVideo;\n","export default \"__VITE_ASSET__yGOjw$UH__\"","import { useContext, useEffect, useRef, useState } from \"react\";\nimport { toast } from \"react-toastify\";\nimport { ClipLoader } from \"react-spinners\";\nimport { format } from \"date-fns\";\nimport { BsSend } from \"react-icons/bs\";\n\n// css\nimport \"@/components/media/MediaActionGallery.css\";\n\n// custome hooks\nimport useGeoLocation from \"@/hooks/useGeolocation.jsx\";\nimport useStorage from \"@/hooks/useStorage.jsx\";\nimport useImage from \"@/hooks/useImage.jsx\";\n\n// contexts\nimport useAuthContext from \"@/hooks/useAuthContext.jsx\";\nimport { MediaContext } from \"@/contexts/MediaContext.jsx\";\n\n// components\nimport { constants, irepsIcons } from \"@/utils/utils\";\nimport imagePlaceHolder from \"@/images/place_holder1.png\";\nimport MediaMBBtn from \"@/components/media/MediaMBBtn\";\nimport WindowCloseBtn from \"@/components/irepsInfoWindow/WindowCloseBtn\";\n\nconst MediaActionGallery = props => {\n\t// console.log(`props`, props);\n\tconst { data } = props;\n\n\tconst imgRef = useRef(null);\n\tconst resizeRef = useRef(null);\n\n\tconst [activeWindow, setActiveWindow] = useState(\"resized\");\n\tconst selectWindow = selected => {\n\t\tsetActiveWindow(selected);\n\t};\n\n\tconst [resizedBase64URL, setResizedBase64URL] = useState(null);\n\n\tconst [file, setFile] = useState(null);\n\n\tconst [isPending, setIsPending] = useState(null);\n\t// console.log(`isPending`, isPending);\n\n\tconst [mediaMetadata, setMediaMetadata] = useState({});\n\n\tconst { uploadFile, url, error: storageError } = useStorage(data);\n\n\tconst { user } = useAuthContext();\n\n\tconst { resizeImg, getBase64URL } = useImage();\n\n\tconst { mediaData, setMediaData } = useContext(MediaContext);\n\n\tconst { userLocation } = useGeoLocation();\n\n\tconst handleFile = e => {\n\t\tconst file = e.target.files[0];\n\t\tconst allowedType = [\"image/png\", \"image/jpeg\"];\n\t\tif (!file) return;\n\t\tif (!userLocation?.coordinates?.lat || !userLocation?.coordinates?.lng) {\n\t\t\ttoast.error(`User Gps Coordinates required when uploading an image`, {\n\t\t\t\tposition: \"top-right\",\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tif (!allowedType.includes(file.type)) {\n\t\t\ttoast.error(`File must be of type jpeg or png`, {\n\t\t\t\tposition: \"top-right\",\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tconst reader = new FileReader();\n\t\treader.onload = e => {\n\t\t\timgRef.current.src = e.target?.result;\n\t\t\tsetFile(e.target?.result);\n\t\t};\n\t\treader.readAsDataURL(file);\n\t\tsetMediaMetadata({\n\t\t\terfId: data.data.id,\n\t\t\terfNo: data.data.erfNo,\n\t\t\tcontentType: file?.type,\n\t\t\t// TODO: revisit - mediaType should not be hardcoded\n\t\t\tmediaType: file?.type,\n\t\t\t// TODO: revisit - mediaCategory should not be hardcoded\n\t\t\tmediaCategory: \"erfPhoto\", // eg meter no photo, meter serail no photo , etc\n\t\t\tcreatedByUser: user.displayName,\n\t\t\tcreatedByUid: user.uid,\n\t\t\tcreatedAtDatetime: format(new Date(), constants.dateFormat2),\n\t\t\tcreatedAtLocation: {\n\t\t\t\tlat: userLocation?.coordinates?.lat,\n\t\t\t\tlng: userLocation?.coordinates?.lng,\n\t\t\t},\n\t\t});\n\t};\n\n\tuseEffect(() => {\n\t\tresizeImg(file, 1200, true, mediaMetadata).then(blob => {\n\t\t\t// console.log(`blob`, blob);\n\t\t\tif (file) {\n\t\t\t\tgetBase64URL(blob).then(resizedFile => {\n\t\t\t\t\t// console.log(`resizedFile`, resizedFile);\n\t\t\t\t\tsetResizedBase64URL(resizedFile);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}, [file, getBase64URL, resizeImg, mediaMetadata]);\n\n\tconst uploadMedia = e => {\n\t\t// Check id data is ready for upload.\n\t\tif (!mediaMetadata.createdAtLocation.lat) {\n\t\t\ttoast.error(`Cannot upload without user Gps coordinates.`, {\n\t\t\t\tposition: \"top-right\",\n\t\t\t});\n\t\t\treturn null;\n\t\t}\n\t\tsetIsPending(true);\n\t\tuploadFile(\n\t\t\tresizedBase64URL,\n\t\t\tdata.irepsKeyItem,\n\t\t\tdata.data.id,\n\t\t\tmediaMetadata,\n\t\t\t\"image\"\n\t\t);\n\t};\n\n\tuseEffect(() => {\n\t\t// console.log(`url`, url);\n\t\tif (Boolean(url) || storageError) {\n\t\t\tsetIsPending(false);\n\t\t\tsetMediaData({\n\t\t\t\t...mediaData,\n\t\t\t\tactiveMediaAction: null,\n\t\t\t});\n\t\t}\n\t\tif (storageError) {\n\t\t\ttoast.error(`Storage Error : ${storageError}`, {\n\t\t\t\tposition: \"top-right\",\n\t\t\t});\n\t\t} // free memory when ever this component is unmounted\n\t\treturn () => {\n\t\t\tsetResizedBase64URL(null);\n\t\t\t// setBase64URL(null);\n\t\t};\n\t}, [url, storageError, mediaData, setMediaData]);\n\n\tconst closeMediaAction = e => {\n\t\tsetMediaData({\n\t\t\t...mediaData,\n\t\t\tactiveMediaAction: null,\n\t\t});\n\t};\n\n\tconst discardImg = e => {\n\t\tsetResizedBase64URL(null);\n\t\tsetFile(null);\n\t\timgRef.current.src = \"\";\n\t\timgRef.current.alt = \"\";\n\t\tresizeRef.current.src = \"\";\n\t\tresizeRef.current.alt = \"\";\n\t};\n\n\treturn (\n\t\t<div className=\"media-action-gallery\">\n\t\t\t<div className=\"mag\">\n\t\t\t\t<div className=\"mag-wrapper\">\n\t\t\t\t\t<div className=\"magw\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={`magpp original ${\n\t\t\t\t\t\t\t\tactiveWindow === \"original\" ? \"show\" : \"hide\"\n\t\t\t\t\t\t\t} `}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<p>Original Picture</p>\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tclassName=\"img-preview\"\n\t\t\t\t\t\t\t\tref={imgRef}\n\t\t\t\t\t\t\t\twidth={150}\n\t\t\t\t\t\t\t\theight={150}\n\t\t\t\t\t\t\t\tsrc={imagePlaceHolder}\n\t\t\t\t\t\t\t\talt=\"ireps pic\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={`magpp resized ${\n\t\t\t\t\t\t\t\tactiveWindow === \"resized\" ? \"show\" : \"hide\"\n\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<p>Resized Picture</p>\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tref={resizeRef}\n\t\t\t\t\t\t\t\tclassName=\"img-preview\"\n\t\t\t\t\t\t\t\twidth={150}\n\t\t\t\t\t\t\t\theight={150}\n\t\t\t\t\t\t\t\tsrc={resizedBase64URL || imagePlaceHolder}\n\t\t\t\t\t\t\t\talt=\"resizedBase64URL\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"mmb-btns\">\n\t\t\t\t\t\t{/* Btn to select original img window */}\n\t\t\t\t\t\t{file && (\n\t\t\t\t\t\t\t<MediaMBBtn\n\t\t\t\t\t\t\t\tselectWindow={discardImg}\n\t\t\t\t\t\t\t\tmmbIcon={irepsIcons.ICON_DISCARD}\n\t\t\t\t\t\t\t\tcolor={\"\"}\n\t\t\t\t\t\t\t\tlabel={\"discard\"}\n\t\t\t\t\t\t\t\ttitle={\"DISCARD Image / Reset\"}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{file && (\n\t\t\t\t\t\t\t<MediaMBBtn\n\t\t\t\t\t\t\t\tselectWindow={selectWindow}\n\t\t\t\t\t\t\t\tmmbIcon={irepsIcons.ICON_IMAGE1}\n\t\t\t\t\t\t\t\tcolor={\"\"}\n\t\t\t\t\t\t\t\tlabel={\"original\"}\n\t\t\t\t\t\t\t\ttitle={\"View Original Image\"}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{/* Btn to select resized img window */}\n\t\t\t\t\t\t{resizedBase64URL && (\n\t\t\t\t\t\t\t<MediaMBBtn\n\t\t\t\t\t\t\t\tselectWindow={selectWindow}\n\t\t\t\t\t\t\t\tmmbIcon={irepsIcons.ICON_IMAGE2}\n\t\t\t\t\t\t\t\tcolor={\"\"}\n\t\t\t\t\t\t\t\tlabel={\"resized\"}\n\t\t\t\t\t\t\t\ttitle={\"View Resized Image\"}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"mag mac-control-bar\">\n\t\t\t\t<div className=\"magcb magcb-left\">\n\t\t\t\t\t<form>\n\t\t\t\t\t\t<input type=\"file\" accept=\"image/*\" onChange={handleFile} />\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"magcb magcb-right\">\n\t\t\t\t\t{resizedBase64URL && (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tdisabled={!resizedBase64URL}\n\t\t\t\t\t\t\t\t// title={title}\n\t\t\t\t\t\t\t\tclassName=\"mab btn-submit-form\"\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\tonClick={uploadMedia}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{isPending ? (\n\t\t\t\t\t\t\t\t\t<ClipLoader\n\t\t\t\t\t\t\t\t\t\tcolor={\"#F86F03\"}\n\t\t\t\t\t\t\t\t\t\tloading={isPending < 100}\n\t\t\t\t\t\t\t\t\t\tsize={20}\n\t\t\t\t\t\t\t\t\t\taria-label=\"Loading Spinner\"\n\t\t\t\t\t\t\t\t\t\tdata-testid=\"loader\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<BsSend />\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)}\n\t\t\t\t\t<WindowCloseBtn handleClose={closeMediaAction} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n};\n\nexport default MediaActionGallery;\n","import { useContext } from \"react\";\n\n// css\nimport \"@/components/media/MediaAction.css\";\n\n// custom hooks\nimport { MediaContext } from \"@/contexts/MediaContext.jsx\";\n\n// components\nimport MediaActionCamera from \"@/components/media/MediaActionCamera\";\nimport MediaActionVoice from \"@/components/media/MediaActionVoice\";\nimport MediaActionVideo from \"@/components/media/MediaActionVideo\";\nimport MediaActionGallery from \"@/components/media/MediaActionGallery\";\n\nconst MediaAction = props => {\n\t// console.log(`props`, props)\n\tconst { mediaData } = useContext(MediaContext);\n\n\treturn (\n\t\t<div\n\t\t\tclassName={`media-action ${\n\t\t\t\tmediaData.activeMediaAction ? \"showMediaAction\" : \"hideMediaAction\"\n\t\t\t}  `}\n\t\t>\n\t\t\t{mediaData.activeMediaAction === \"camera\" && (\n\t\t\t\t<MediaActionCamera data={props.data} />\n\t\t\t)}\n\t\t\t{mediaData.activeMediaAction === \"voice\" && (\n\t\t\t\t<MediaActionVoice data={props.data} />\n\t\t\t)}\n\t\t\t{mediaData.activeMediaAction === \"video\" && (\n\t\t\t\t<MediaActionVideo data={props.data} />\n\t\t\t)}\n\t\t\t{mediaData.activeMediaAction === \"gallery\" && (\n\t\t\t\t<MediaActionGallery data={props.data} />\n\t\t\t)}\n\t\t</div>\n\t);\n};\n\nexport default MediaAction;\n"],"names":["__assign","t","i","n","p","__rest","s","e","scale","createAnimation","ScaleLoader","_a","_b","loading","_c","color","_d","speedMultiplier","_e","cssOverride","_f","height","_g","width","_h","radius","_j","margin","additionalprops","wrapper","style","cssValue","React.createElement","root","factory","module","require$$0","this","__WEBPACK_EXTERNAL_MODULE_react__","modules","installedModules","__webpack_require__","moduleId","exports","name","getter","value","mode","ns","key","object","property","__webpack_exports__","react__WEBPACK_IMPORTED_MODULE_0__","__extends","extendStatics","b","d","__","constraints","getUserMedia","resolve","reject","hasGetUserMedia","Webcam","_super","props","_this","state","nextProps","audioConstraintsChanged","videoConstraintsChanged","minScreenshotWidthChanged","minScreenshotHeightChanged","stream","track","screenshotDimensions","canvas","canvasWidth","canvasHeight","aspectRatio","ctx","sourceSelected","audioConstraints","videoConstraints","myRequestUserMediaId","optionalSource_1","id","constraintToSourceId_1","constraint","deviceId","sources","audioSource","videoSource","source","audioSourceId","videoSourceId","err","audio","disablePictureInPicture","mirrored","children","rest","videoStyle","childrenProps","ref","useImage","_createImg","photo","img","prefixFileName","url","prefix","filename","_resizer","size","x","w","h","_cropper","getBase64URL","file","reader","resizeImg","crop","mediaMetadata","mediaCategory","astNo","erfNo","createdAtDatetime","createdByUser","createdAtLocation","y","irepsDictionary","blob","WindowCloseBtn","handleClose","clr","jsx","IconContext","MdOutlineClose","MediaActionCamera","data","irepsKeyItem","keyItem","webcamRef","useRef","uploadFile","storageError","useStorage","imgFile","setImgFile","useState","resizedBase64URL","setResizedBase64URL","isPending","setIsPending","setMediaMetadata","vc","setVc","user","useAuthContext","claims","mediaData","setMediaData","useContext","MediaContext","mediaCat","trnId","userLocation","useGeoLocation","captureImage","useCallback","imageSrc","prev","metaData","format","constants","closeMediaAction","useEffect","resizedFile","uploadMedia","toast","discard","chooseDevice","jsxs","Fragment","MediaActionBtn","irepsIcons","ClipLoader","BsSend","mimeType","MediaActionVoice","permission","setPermission","mediaRecorder","recordingStatus","setRecordingStatus","setStream","audioChunks","setAudioChunks","setAudio","audioBlob","setAudioBlob","getMicrophonePermission","streamData","startRecording","media","localAudioChunks","event","stopRecording","audioUrl","MediaActionVideo","mediaRecorderRef","recording","setRecording","recordedChunks","setRecordedChunks","video","setVideo","videoBlob","setVideoBlob","handleDataAvailable","handleStartCaptureClick","handleStopCaptureClick","imagePlaceHolder","MediaActionGallery","imgRef","resizeRef","activeWindow","setActiveWindow","selectWindow","selected","setFile","handleFile","allowedType","discardImg","MediaMBBtn","MediaAction"],"mappings":"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","x_google_ignoreList":[0,1]}