import{j as e,r as l,A as E,i as R,u as _,w as F,o as q,q as O,c as G,d as K,e as H,f as z,F as m}from"./index-B2W70YXr.js";import{e as v,a as h,b as J,c as L,d as Q,F as V}from"./FilterUpdatedAtDatetime-o6a37QVt.js";import{u as X}from"./useTrns-DpjEOOia.js";import{a as Y}from"./useAsts-BXNxUWPz.js";import"./useErfs-nqTqG9Ui.js";try{let t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},s=new t.Error().stack;s&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[s]="2c3b90e8-1f84-4fa5-88ab-0eaba45896dc",t._sentryDebugIdIdentifier="sentry-dbid-2c3b90e8-1f84-4fa5-88ab-0eaba45896dc")}catch{}const Z=()=>e.jsx("div",{className:"filter-reports",children:e.jsxs("div",{className:"filter-report-body",children:[e.jsx(v,{title:"Meters Per User Stats",name:"users"}),e.jsx(v,{title:"Meters Type Per User Stats",name:"meterType"}),e.jsx(v,{title:"Meters Anomalies Per User Stats",name:"anomalies"})]})});function $(){for(var t="0123456789ABCDEF",s="#",a=0;a<6;a++)s+=t[Math.floor(Math.random()*16)];return s}const ee=t=>{const{astsContext:s,setAstsContext:a}=l.useContext(E),{astsStatsContext:o,setAstsStatsContext:c}=l.useContext(R),[i,S]=l.useState([]),[b,f]=l.useState(""),{getDocument:T}=X("users"),{user:U}=_(),{getAstsUsersStats:N,getMeterTypePerUserStats:D,getAnomalyPerUserStats:M}=Y(),{uid:P}=U;return l.useEffect(()=>{T(P).then(u=>{const{workbase:d}=u==null?void 0:u.doc;S(d),f("")})},[]),{error:b,getAsts:u=>{let d=F("erf.address.lmMetro","==",i);u?d=[d,...u]:d=[q(d,F("astData.astState.state","==","stores"))];const w=O(G(K,t),...d,H("metadata.updatedAtDatetime","desc"));f(""),z(w,x=>{var A;const r=[];x.docs.forEach(n=>{r.push({id:n.id,...n.data()})});const B=N(r),k=D(r),I=M(r),p={};r==null||r.forEach(n=>{p[n.metadata.createdByUid]=1+(p[n.metadata.createdByUid]||0)});const g=[];for(const n in p){const j=r.find(C=>{var y;return((y=C==null?void 0:C.metadata)==null?void 0:y.createdByUid)===n}),W=(p[n]/(r==null?void 0:r.length)*100).toFixed(2);g.push({uid:n,displayName:(A=j==null?void 0:j.metadata)==null?void 0:A.createdByUser,quantity:p[n],percentage:W,fillColor:$()})}a({...s,asts:r,statsCreatedAtDatetimeByUser:g}),c(n=>({...n,statsAstsUsers:B,meterTypePerUserStats:k,anomalyPerUserStats:I}))},x=>{console.log("firestore err",x.message),f(x.message)})}}},te=()=>{const{filtersContext:t,setFiltersContext:s}=l.useContext(m),{geographicArea:a}=t==null?void 0:t.filterCondition,o=!a,c=i=>{console.log("e.currentTarget.value",i.currentTarget.value),s({...t,filterCondition:{...t.filterCondition,geographicArea:i.currentTarget.value}})};return e.jsx("div",{className:"filter-geographic-area",children:e.jsxs("select",{className:"fga-select",onChange:c,children:[e.jsx("option",{selected:o,value:"",children:"Select Filter"}),e.jsx("option",{value:"Ward1",children:"Ward 1"}),e.jsx("option",{value:"Ward2",children:"Ward 2"}),e.jsx("option",{value:"Ward3",children:"Ward 3"}),e.jsx("option",{value:"Ward4",children:"Ward 4"}),e.jsx("option",{value:"Custom Area 1",children:"Custom Area 1"}),e.jsx("option",{value:"Custom Area 2",children:"Custom Area 2"}),e.jsx("option",{value:"Custom Area 3",children:"Custom Area 3"}),e.jsx("option",{value:"Custom Area 4",children:"Custom Area 4"})]})})},se=()=>{const{filtersContext:t,setFiltersContext:s}=l.useContext(m),{astCreation:a}=t==null?void 0:t.filterCondition,o=!a,c=i=>{s({...t,filterCondition:{...t.filterCondition,astCreation:i.currentTarget.value}})};return e.jsx("div",{className:"filter-ast-creation-process",children:e.jsxs("select",{className:"fga-select",onChange:c,children:[e.jsx("option",{selected:o,value:"",children:"Select Filter"}),e.jsx("option",{value:"audit",children:"Audits"}),e.jsx("option",{value:"installation",children:"Installations"})]})})},ae=()=>{const{filtersContext:t,setFiltersContext:s}=l.useContext(m),{astState:a}=t==null?void 0:t.filterCondition,o=!a,c=i=>{s({...t,filterCondition:{...t.filterCondition,astState:i.currentTarget.value}})};return e.jsx("div",{className:"filter-ast-state",children:e.jsxs("select",{className:"fas-select",onChange:c,children:[e.jsx("option",{selected:o,value:"",children:"Select Filter"}),e.jsx("option",{value:"stores",children:"Stores"}),e.jsx("option",{value:"checkedOutPending",children:"Checked Out Pending"}),e.jsx("option",{value:"checkedOut",children:"Checked Out"}),e.jsx("option",{value:"field",children:"Field"}),e.jsx("option",{value:"service",children:"Service"}),e.jsx("option",{value:"disconnected",children:"Disconnected"}),e.jsx("option",{value:"decommissioned",children:"Decommissioned"})]})})},re=()=>{const{filtersContext:t,setFiltersContext:s}=l.useContext(m),{astMeterType:a}=t==null?void 0:t.filterCondition,o=!a,c=i=>{s({...t,filterCondition:{...t.filterCondition,astMeterType:i.currentTarget.value}})};return e.jsx("div",{className:"meter-type",children:e.jsxs("select",{className:"mt-select",onChange:c,children:[e.jsx("option",{selected:o,value:"",children:"Select Filter"}),e.jsx("option",{value:"pre-paid",children:"Pre-paid"}),e.jsx("option",{value:"conventional",children:"Conventional"})]})})},ne=()=>{const{getAsts:t}=ee("asts");return e.jsxs("div",{className:"filter-data-filter",children:[e.jsxs("div",{className:"filter-items",children:[e.jsx(h,{title:"Filter-CreatedAtDatetime",name:"dateRange",value:"created",children:e.jsx(J,{})}),e.jsx(h,{title:"Filter-UpdatedAtDatetime",name:"dateRange",value:"updated",children:e.jsx(L,{})}),e.jsx(h,{title:"Filter-Ast Creation",name:"astCreation",value:"astCreation",children:e.jsx(se,{})}),e.jsx(h,{title:"Filter-Meter Type",name:"astMeterType",value:"astMeterType",children:e.jsx(re,{})}),e.jsx(h,{title:"Filter-Ast State",name:"astState",value:"astState",children:e.jsx(ae,{})}),e.jsx(h,{title:"Filter-Geographic Area",name:"geographicArea",value:"geographicArea",children:e.jsx(te,{})})]}),e.jsx(Q,{getData:t})]})},oe=t=>{const{active:s,irepsKeyItem:a}=t;return e.jsxs("div",{className:"filters-body",children:[s==="reportFilters"?e.jsx(ne,{irepsKeyItem:a}):"",s==="reportStats"?e.jsx(Z,{irepsKeyItem:a}):""]})},pe=t=>{const{irepsKeyItem:s}=t,[a,o]=l.useState("reportFilters");return e.jsxs("div",{className:"filters",children:[e.jsx(V,{active:a,setActive:o,irepsKeyItem:s}),e.jsx(oe,{active:a,setActive:o,irepsKeyItem:s})]})};export{pe as default};
//# sourceMappingURL=Filters-DqPHWlT_.js.map
