import{j as e,r as l,A as w,i as q,u as I,w as S,o as O,q as G,c as K,d as _,e as H,f as $,F as p}from"./index-CyIbrq5N.js";import{e as f,a as x,b as z,c as J,d as L,F as Q}from"./FilterUpdatedAtDatetime-tSWAHTj-.js";import{u as V}from"./useTrns-VJPHtcEx.js";import{a as X}from"./useAsts-otpA_u-i.js";import"./useErfs-CrZDnWty.js";const Y=()=>e.jsx("div",{className:"filter-reports",children:e.jsxs("div",{className:"filter-report-body",children:[e.jsx(f,{title:"Meters Per User Stats",name:"users"}),e.jsx(f,{title:"Meters Type Per User Stats",name:"meterType"}),e.jsx(f,{title:"Meters Anomalies Per User Stats",name:"anomalies"})]})});function Z(){for(var t="0123456789ABCDEF",s="#",r=0;r<6;r++)s+=t[Math.floor(Math.random()*16)];return s}const ee=t=>{const{astsContext:s,setAstsContext:r}=l.useContext(w),{astsStatsContext:o,setAstsStatsContext:c}=l.useContext(q),[i,y]=l.useState([]),[N,j]=l.useState(""),{getDocument:T}=V("users"),{user:U}=I(),{getAstsUsersStats:M,getMeterTypePerUserStats:P,getAnomalyPerUserStats:B}=X(),{uid:b}=U;return l.useEffect(()=>{T(b).then(u=>{const{workbase:d}=u==null?void 0:u.doc;y(d),j("")})},[]),{error:N,getAsts:u=>{let d=S("erf.address.lmMetro","==",i);u?d=[d,...u]:d=[O(d,S("astData.astState.state","==","stores"))];const D=G(K(_,t),...d,H("metadata.updatedAtDatetime","desc"));j(""),$(D,m=>{var A;const a=[];m.docs.forEach(n=>{a.push({id:n.id,...n.data()})});const W=M(a),k=P(a),R=B(a),h={};a==null||a.forEach(n=>{h[n.metadata.createdByUid]=1+(h[n.metadata.createdByUid]||0)});const g=[];for(const n in h){const C=a.find(v=>{var F;return((F=v==null?void 0:v.metadata)==null?void 0:F.createdByUid)===n}),E=(h[n]/(a==null?void 0:a.length)*100).toFixed(2);g.push({uid:n,displayName:(A=C==null?void 0:C.metadata)==null?void 0:A.createdByUser,quantity:h[n],percentage:E,fillColor:Z()})}r({...s,asts:a,statsCreatedAtDatetimeByUser:g}),c(n=>({...n,statsAstsUsers:W,meterTypePerUserStats:k,anomalyPerUserStats:R}))},m=>{console.log("firestore err",m.message),j(m.message)})}}},te=()=>{const{filtersContext:t,setFiltersContext:s}=l.useContext(p),{geographicArea:r}=t==null?void 0:t.filterCondition,o=!r,c=i=>{console.log("e.currentTarget.value",i.currentTarget.value),s({...t,filterCondition:{...t.filterCondition,geographicArea:i.currentTarget.value}})};return e.jsx("div",{className:"filter-geographic-area",children:e.jsxs("select",{className:"fga-select",onChange:c,children:[e.jsx("option",{selected:o,value:"",children:"Select Filter"}),e.jsx("option",{value:"Ward1",children:"Ward 1"}),e.jsx("option",{value:"Ward2",children:"Ward 2"}),e.jsx("option",{value:"Ward3",children:"Ward 3"}),e.jsx("option",{value:"Ward4",children:"Ward 4"}),e.jsx("option",{value:"Custom Area 1",children:"Custom Area 1"}),e.jsx("option",{value:"Custom Area 2",children:"Custom Area 2"}),e.jsx("option",{value:"Custom Area 3",children:"Custom Area 3"}),e.jsx("option",{value:"Custom Area 4",children:"Custom Area 4"})]})})},se=()=>{const{filtersContext:t,setFiltersContext:s}=l.useContext(p),{astCreation:r}=t==null?void 0:t.filterCondition,o=!r,c=i=>{s({...t,filterCondition:{...t.filterCondition,astCreation:i.currentTarget.value}})};return e.jsx("div",{className:"filter-ast-creation-process",children:e.jsxs("select",{className:"fga-select",onChange:c,children:[e.jsx("option",{selected:o,value:"",children:"Select Filter"}),e.jsx("option",{value:"audit",children:"Audits"}),e.jsx("option",{value:"installation",children:"Installations"})]})})},re=()=>{const{filtersContext:t,setFiltersContext:s}=l.useContext(p),{astState:r}=t==null?void 0:t.filterCondition,o=!r,c=i=>{s({...t,filterCondition:{...t.filterCondition,astState:i.currentTarget.value}})};return e.jsx("div",{className:"filter-ast-state",children:e.jsxs("select",{className:"fas-select",onChange:c,children:[e.jsx("option",{selected:o,value:"",children:"Select Filter"}),e.jsx("option",{value:"stores",children:"Stores"}),e.jsx("option",{value:"checkedOutPending",children:"Checked Out Pending"}),e.jsx("option",{value:"checkedOut",children:"Checked Out"}),e.jsx("option",{value:"field",children:"Field"}),e.jsx("option",{value:"service",children:"Service"}),e.jsx("option",{value:"disconnected",children:"Disconnected"}),e.jsx("option",{value:"decommissioned",children:"Decommissioned"})]})})},ae=()=>{const{filtersContext:t,setFiltersContext:s}=l.useContext(p),{astMeterType:r}=t==null?void 0:t.filterCondition,o=!r,c=i=>{s({...t,filterCondition:{...t.filterCondition,astMeterType:i.currentTarget.value}})};return e.jsx("div",{className:"meter-type",children:e.jsxs("select",{className:"mt-select",onChange:c,children:[e.jsx("option",{selected:o,value:"",children:"Select Filter"}),e.jsx("option",{value:"pre-paid",children:"Pre-paid"}),e.jsx("option",{value:"conventional",children:"Conventional"})]})})},ne=()=>{const{getAsts:t}=ee("asts");return e.jsxs("div",{className:"filter-data-filter",children:[e.jsxs("div",{className:"filter-items",children:[e.jsx(x,{title:"Filter-CreatedAtDatetime",name:"dateRange",value:"created",children:e.jsx(z,{})}),e.jsx(x,{title:"Filter-UpdatedAtDatetime",name:"dateRange",value:"updated",children:e.jsx(J,{})}),e.jsx(x,{title:"Filter-Ast Creation",name:"astCreation",value:"astCreation",children:e.jsx(se,{})}),e.jsx(x,{title:"Filter-Meter Type",name:"astMeterType",value:"astMeterType",children:e.jsx(ae,{})}),e.jsx(x,{title:"Filter-Ast State",name:"astState",value:"astState",children:e.jsx(re,{})}),e.jsx(x,{title:"Filter-Geographic Area",name:"geographicArea",value:"geographicArea",children:e.jsx(te,{})})]}),e.jsx(L,{getData:t})]})},oe=()=>e.jsx("div",{className:"filter-columns",children:e.jsxs("label",{className:"fc-select-all",children:[e.jsx("span",{children:"Select all"}),e.jsx("input",{name:"All",type:"radio"})]})}),ie=t=>{const{active:s,irepsKeyItem:r}=t;return e.jsxs("div",{className:"filters-body",children:[s==="reportFilters"?e.jsx(ne,{irepsKeyItem:r}):"",s==="reportStats"?e.jsx(Y,{irepsKeyItem:r}):""," ",s==="columnFilters"?e.jsx(oe,{irepsKeyItem:r}):""]})},me=t=>{const{irepsKeyItem:s}=t,[r,o]=l.useState("reportFilters");return e.jsxs("div",{className:"filters",children:[e.jsx(Q,{active:r,setActive:o,irepsKeyItem:s}),e.jsx(ie,{active:r,setActive:o,irepsKeyItem:s})]})};export{me as default};
