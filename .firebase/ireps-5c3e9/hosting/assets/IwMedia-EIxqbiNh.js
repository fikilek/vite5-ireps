import{r as o,bt as h,D as A,bu as B,l as T,a1 as k,a9 as x,j as e,bv as z,I as d,bw as S,bx as $,by as O,bz as R,bA as U,bB as H,bC as V,bD as W,w as Y,Y as q,bE as G}from"./index-CyIbrq5N.js";import J from"./MediaAction-Crna9SyW.js";import{I as K}from"./IrepsInfoWindow-C2Qnxqhe.js";const L=()=>{var p,b,v,M,N,g,y,I;const{mediaData:s,setMediaData:t}=o.useContext(h);console.log("mediaData",s);const{deleteDocument:r,response:a}=A("media"),{deleteFile:m,success:l}=B(),i=s==null?void 0:s.data[s==null?void 0:s.displayPosition],f=(p=s==null?void 0:s.data[s==null?void 0:s.displayPosition])==null?void 0:p.url,j=(v=(b=s==null?void 0:s.data)==null?void 0:b.metadata)==null?void 0:v.mediaCatergory,P=(N=(M=s==null?void 0:s.data[s==null?void 0:s.displayPosition])==null?void 0:M.metadata)==null?void 0:N.createdByUser,n=(y=(g=s==null?void 0:s.data[s==null?void 0:s.displayPosition])==null?void 0:g.metadata)==null?void 0:y.createdAtDatetime;let u="";n&&(u=T(n==null?void 0:n.toDate(),k.dateFormat2));const w=async C=>{const F=C.currentTarget.id;try{let c=$(O,i.url);await m(c,i.id),await r(F),t({...s,displayPosition:0})}catch(c){console.log(`Error deleting image ${c}`),x.error(`Error deleting image ${c}`,{position:"top-right"})}};return o.useEffect(()=>{a.error&&x.error(a.error,{position:"top-right"}),a.document&&l&&x.success(`Doc ${a.document} succesfully delete`,{position:"bottom-left"})},[a,l]),e.jsxs("div",{className:"media-main-display",children:[e.jsx(z,{hl1:P,hr3:u}),e.jsx("div",{className:"main-display-container",children:(I=s==null?void 0:s.data)!=null&&I.length?e.jsx("div",{className:"image",children:e.jsx("img",{src:f,alt:j,width:"100%",height:"100%"})}):e.jsx("p",{children:"No Image"})}),i&&e.jsx("button",{id:i==null?void 0:i.id,className:"mmd-delete-btn",onClick:w,children:e.jsx(d.Provider,{value:{color:"blue",className:"global-class-name"},children:e.jsx(S,{})})})]})},Q=()=>e.jsxs("div",{className:"media-body",children:[e.jsx(L,{}),e.jsx(R,{})]}),E=s=>{const{filterTitle:t}=s;return e.jsxs("div",{className:"media-filter",children:[e.jsx("div",{className:"title",children:t}),e.jsxs("div",{className:"media-filter-btn",children:[e.jsx("button",{className:"mfb mfb-photos",title:"take a photo with camera",children:e.jsx(d.Provider,{value:{color:"blue",fontSize:"3rem"},children:e.jsx(U,{})})}),e.jsx("span",{children:"3"})]}),e.jsxs("div",{className:"media-filter-btn",children:[e.jsx("button",{className:"mfb mfb-voice-clips",title:"make a voice clip",children:e.jsx(d.Provider,{value:{color:"blue",fontSize:"3rem"},children:e.jsx(H,{})})}),e.jsx("span",{children:"2"})]}),e.jsxs("div",{className:"media-filter-btn",children:[e.jsx("button",{className:"mfb mfb-video-clips",title:"make a video clip",children:e.jsx(d.Provider,{value:{color:"blue",fontSize:"3rem"},children:e.jsx(V,{})})}),e.jsx("span",{children:"1"})]})]})},X=()=>{const{mediaData:s,setMediaData:t}=o.useContext(h),r=s.data.length;return e.jsxs("div",{className:"media-filters",children:[e.jsxs("p",{className:"title",children:["Total Media ",r]}),e.jsxs("div",{className:"filters",children:[e.jsx(E,{filterTitle:"Erf"}),e.jsx(E,{filterTitle:"Asts"})]})]})},Z=s=>{const{data:t}=s;return e.jsxs("div",{className:"media-footer",children:[e.jsx(X,{}),e.jsx(W,{data:t})]})},_=s=>{const{data:t}=s,{mediaData:r,setMediaData:a}=o.useContext(h),m=useMemo(()=>Y("metadata.erfId","==",t.id),[t.id]),{data:l,error:i,isPending:f,success:j}=q("media",[m]);return o.useEffect(()=>{t&&a({...r,data:l})},[l]),o.useEffect(()=>{t&&a({...r,erfData:t})},[t]),e.jsxs("div",{className:"media",children:[e.jsx(Q,{data:t}),e.jsx(Z,{data:t}),e.jsx(J,{data:t})]})},te=s=>{const{data:t}=s;return e.jsx(K,{fhl1:"Media",fhl3:e.jsxs("span",{children:["Erf No: ",e.jsx("span",{className:"data-emphasis",children:t.erfNo})]}),fhr1:e.jsx(G,{}),children:e.jsx(_,{data:t})})};export{te as default};
