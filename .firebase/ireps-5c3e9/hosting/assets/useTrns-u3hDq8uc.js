import{au as z,u as G,k as h,aa as j,d as k,az as V,aA as L,h as P,r as T,T as W,b as K,w as $,q as Z,e as J,c as Q,f as X,aB as Y,am as o,an as n,av as R,aC as y,j as c,m as N,n as D,I as O,p as _}from"./index-DTpsEHRa.js";let U;const x=new Uint8Array(16);function ee(){if(!U&&(U=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!U))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return U(x)}const q=[];for(let i=0;i<256;++i)q.push((i+256).toString(16).slice(1));function re(i,u=0){return q[i[u+0]]+q[i[u+1]]+q[i[u+2]]+q[i[u+3]]+"-"+q[i[u+4]]+q[i[u+5]]+"-"+q[i[u+6]]+q[i[u+7]]+"-"+q[i[u+8]]+q[i[u+9]]+"-"+q[i[u+10]]+q[i[u+11]]+q[i[u+12]]+q[i[u+13]]+q[i[u+14]]+q[i[u+15]]}const te=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),E={randomUUID:te};function S(i,u,l){if(E.randomUUID&&!u&&!i)return E.randomUUID();i=i||{};const f=i.random||(i.rng||ee)();return f[6]=f[6]&15|64,f[8]=f[8]&63|128,re(f)}function g(i){return z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 13.5V4a2 2 0 0 1 2-2h8.5L20 7.5V20a2 2 0 0 1-2 2h-5.5"},child:[]},{tag:"polyline",attr:{points:"14 2 14 8 20 8"},child:[]},{tag:"path",attr:{d:"M10.42 12.61a2.1 2.1 0 1 1 2.97 2.97L7.95 21 4 22l.99-3.95 5.43-5.44Z"},child:[]}]})(i)}const ae=i=>{const{user:u}=G();return{updateDocument:async(p,s)=>{p={...p,"metadata.updatedAtDatetime":h.now(),"metadata.updatedByUser":u.displayName,"metadata.updatedByUid":u.uid,updateHistory:!0};const t=j(k,i,s);try{return await V(t,p),{success:!0}}catch(a){return console.log("ERROR: ",a.message),{success:!1,msg:a.message}}},getDocument:async p=>{const s=j(k,i,p),t=await L(s);try{return t.exists()?{success:!0,doc:{id:t.id,...t.data()}}:{success:!1,msg:"Document does not exist"}}catch(a){return console.log("No such document!"),{success:!1,msg:a.message}}}}},se=()=>({getTrnTypesStats:l=>{const f={};l==null||l.forEach(s=>{f[s.metadata.trnType]=1+(f[s.metadata.trnType]||0)});const p=[];for(const s in f){const t=(f[s]/(l==null?void 0:l.length)*100).toFixed(2);p.push({trntype:s,quantity:f[s],percentage:t,fillColor:P()})}return{stats:p,total:l==null?void 0:l.length}},getTrnTypePerUserStats:l=>{const f={};l==null||l.forEach(a=>{f[a.metadata.trnType]=1+(f[a.metadata.trnType]||0)});const p=[];for(const a in f){const e=l.filter(r=>r.metadata.trnType===a);p.push({trnType:a,trns:e,total:e==null?void 0:e.length})}const s=[];p==null||p.forEach(a=>{var r;const e={};(r=a.trns)==null||r.forEach(d=>{e[d.metadata.createdByUid]=1+(e[d.metadata.createdByUid]||0)}),s.push({...a,users:e})});const t=[];return s==null||s.forEach(a=>{var m;const{users:e,total:r}=a;let d={};for(const A in e){const w=l==null?void 0:l.find(v=>{var M;return((M=v==null?void 0:v.metadata)==null?void 0:M.createdByUid)===A}),I=(e[A]/r*100).toFixed(2);d[A]={uid:A,displayName:(m=w==null?void 0:w.metadata)==null?void 0:m.createdByUser,quantity:e[A],percentage:I,fillColor:P()}}a={...a,usersObj:d},t.push(a)}),{stats:t,total:l==null?void 0:l.length}}}),de=i=>{const{trnsContext:u,setTrnsContext:l}=T.useContext(W),{setTrnsStatsContext:f}=T.useContext(K),[p,s]=T.useState([]),[t,a]=T.useState(""),{getDocument:e}=ae("users"),{user:r}=G(),{getTrnTypesStats:d,getTrnTypePerUserStats:m}=se(),{uid:A}=r;return T.useEffect(()=>{e(A).then(w=>{const{workbase:I}=w==null?void 0:w.doc,v=$("erf.address.lmMetro","==",I);if(!v)return;const M=Z(Q(k,i),v,J("metadata.updatedAtDatetime","desc"));a(""),X(M,C=>{const B=[];C.docs.forEach(b=>{B.push({id:b.id,...b.data()})}),s(B);const H=d(B),F=m(B);l({...u,trns:B,newTrnsData:!0}),f(b=>({...b,statsTrnType:H,trnTypePerUserStats:F}))},C=>{console.log("firestore err",C.message),a(C.message)}),a("")})},[]),{trns:p,error:t}},ie=()=>{const{user:i}=G();de("trns");const u=S(),l={meter:{checkin:{metadata:{updatedAtDatetime:h.now(),updatedByUser:i.displayName,updatedByUid:i.uid,createdAtDatetime:h.now(),createdByUser:i.displayName,createdByUid:i.uid,trnType:"checkin",trnNo:"",trnId:S(),trnState:"draft"},astData:{astId:S(),astNo:"",astCatergory:"meter",astState:"stores",astManufacturer:"",astName:"",meter:{phase:"",type:""}},location:{address:"",gps:{lat:"",lng:""}}},audit:{access:{meterAccess:"",noAccessReason:""},metadata:{updatedAtDatetime:h.now(),updatedByUser:i.displayName,updatedByUid:i.uid,createdAtDatetime:h.now(),createdByUser:i.displayName,createdByUid:i.uid,trnHistory:0,trnType:"audit",trnNo:"",trnId:S(),trnState:"draft"},astData:{astId:S(),astNo:"",astCatergory:"meter",astState:{state:"service",location:""},astManufacturer:"",astName:"",meter:{phase:"",type:"",keypad:{isThereKeypad:"",keypadAccess:"",serialNo:"",comment:""},cb:{isThereCb:"",size:"",comment:""},seal:{meterSealed:"",sealNo:"",comment:""}}},location:{address:"",gps:{lat:"",lng:""},premises:"",insideBox:""},anomalies:{anomaly:"",anomalyDetail:""},erf:{erfNo:"",erfId:"",erfAdr:""},serviceConnection:{configuration:"",offGridSupply:""},tidStatus:{status:"",statusComment:""}},tid:{access:{meterAccess:"",noAccessReason:""},metadata:{updatedAtDatetime:h.now(),updatedByUser:i.displayName,updatedByUid:i.uid,createdAtDatetime:Y(),createdByUser:i.displayName,createdByUid:i.uid,trnHistory:0,trnType:"tid",trnNo:"",trnId:S(),trnState:"draft"},astData:{astId:"",astNo:"",astCatergory:"meter"},tidOperation:{tidDone:"",comment:""},tidBefore:{tariff:"",krn:""},tidAfter:{tariff:"",krn:""}},installation:{access:{meterAccess:"",noAccessReason:""},installationData:{installationDate:new Date,sgc:""},metadata:{updatedAtDatetime:h.now(),updatedByUser:i.displayName,updatedByUid:i.uid,createdAtDatetime:h.now(),createdByUser:i.displayName,createdByUid:i.uid,trnHistory:0,trnType:"installation",trnId:u,trnState:"draft",createdThrough:{creatorTrnName:"installation",creatorTrnNo:"trnNo",creatorTrnId:u}},astData:{astId:"",astNo:"",astCatergory:"meter",astState:{state:"service",location:""},astManufacturer:"",astName:"",meter:{phase:"",type:"",keypad:{keypadInstalled:"",serialNo:"",comment:""},cb:{cbInstalled:"",size:"",comment:""},seal:{meterSealed:"",sealNo:"",comment:""}}},location:{address:"",gps:{lat:"",lng:""},premises:"",insideBox:""},anomalies:{anomaly:"MeterOk",anomalyDetail:"Operationally Ok"},erf:{erfNo:"",erfId:"",erfAdr:"",propertyType:""},serviceConnection:{configuration:""}},inspection:{access:{meterAccess:"",noAccessReason:""},metadata:{updatedAtDatetime:h.now(),updatedByUser:i.displayName,updatedByUid:i.uid,createdAtDatetime:h.now(),createdByUser:i.displayName,createdByUid:i.uid,trnHistory:0,trnType:"inspection",trnNo:"",trnId:S(),trnState:"draft"},inspectionData:{newMeter:""},astData:{astNo:"",astState:"",astManufacturer:"",astName:"",meter:{phase:"",type:"",keypad:{isThereKeypad:"",keypadAccess:"",serialNo:"",comment:""},cb:{isThereCb:"",size:"",comment:""},seal:{meterSealed:"",sealNo:"",comment:""}}},location:{address:"",gps:{lat:"",lng:""},premises:"",insideBox:""},anomalies:{anomaly:"",anomalyDetail:""},erf:{erfNo:"",erfId:"",erfAddress:""},serviceConnection:{configuration:""}}}},f={meter:{checkin:o().shape({astData:o().shape({astNo:n().required("Required"),astName:n().required("Required"),astManufacturer:n().required("Required"),astState:n().required("Required"),meter:o().shape({phase:n().required("Required"),type:n().required("Required")})}),location:o().shape({address:n().required("Required"),gps:o().shape({lat:R().required("Required"),lng:R().required("Required")})})}),audit:o().shape({access:o().shape({meterAccess:n().required("Required").notOneOf(["choose",""],"Required"),noAccessReason:n().when("meterAccess",(s,t)=>{var a;if(s[0]==="no")return(a=t==null?void 0:t.required("no access reason required"))==null?void 0:a.notOneOf(["choose",""],"Required");if(s[0]==="yes")return t.notRequired().oneOf(["","choose"],"Must Be 'choose' ")})}),astData:y((s,{context:t})=>o().shape({astNo:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required"):e}),astManufacturer:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required"):e}),astName:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required"):e}),meter:o().shape({phase:n().when("astNo",(a,e)=>{var m;const{astNo:r}=t.astData,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r===""||r===null||r===void 0?e==null?void 0:e.notRequired():(m=e==null?void 0:e.defined("Required"))==null?void 0:m.oneOf(["single","three"],"Required")}),type:n().when("astNo",(a,e)=>{var m;const{astNo:r}=t.astData,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r===""||r===null||r===void 0?e==null?void 0:e.notRequired():(m=e==null?void 0:e.defined("Required"))==null?void 0:m.oneOf(["pre-paid","conventional"],"Required")}),cb:o().shape({isThereCb:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;if(r==="no")return e.notRequired();if(r==="yes")return e.required("Required").oneOf(["yes","no"],"yes or no").notOneOf(["choose",""],"Required")}),size:R().when("isThereCb",(a,e)=>{const{isThereCb:r}=t.astData.meter.cb,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r==="yes"?e.required("Required").notOneOf([""],"Required"):r==="no"?e.oneOf([""],"Must Be Blank"):e}),comment:n().when("isThereCb",(a,e)=>{const{isThereCb:r}=t.astData.meter.cb,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r==="no"?e.required("Value Required").notOneOf(["choose"],"Required").defined("Required"):e})}),seal:o().shape({meterSealed:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;if(r==="no")return e.notRequired();if(r==="yes")return e.required("Required").oneOf(["yes","no"],"yes or no").notOneOf(["choose",""],"Required")}),sealNo:n().when(["meterSealed","comment"],([a,e],r)=>{const{meterAccess:d}=t.access;return d==="no"?r.notRequired():e==="seal no hard to read"||e==="seal has no seal no"||a==="no"?r.oneOf([""],"Must Be Blank"):a==="yes"?r.required("Required"):r}),comment:n().when("meterSealed",(a,e)=>{const{meterSealed:r,sealNo:d}=t.astData.meter.seal,{meterAccess:m}=t.access;return m==="no"?e.notRequired():r==="yes"&&d===""?e.required("Required").defined("Required").notOneOf(["choose"],"Required"):e})})})})),location:y((s,{context:t})=>o().shape({address:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="yes"?e.required("Required"):e.notRequired()}),gps:o().shape({lat:R().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="yes"?e.required("Required"):e.notRequired()}),lng:R().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="yes"?e.required("Required"):e.notRequired()})}),placement:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").oneOf(["Pole Top","Pole Bottom","Kiosk","Meter Room","Indoors","Boundary Wall (Outside)","Boundary Wall (Inside)"],"Required"):e.notRequired()})})),anomalies:y((s,{context:t})=>o().shape({anomaly:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").notOneOf(["choose",""],"Required"):e}),anomalyDetail:n().when("anomaly",(a,e)=>{const{anomaly:r}=t==null?void 0:t.anomalies,{meterAccess:d}=t==null?void 0:t.access;return d==="no"||r===""||r==="choose"||r===null||r===void 0?e.notRequired():e.required("Required").notOneOf(["choose"],"Required")})})),serviceConnection:y((s,{context:t})=>o().shape({configuration:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").oneOf(["Connected","Disconnected (By Credit Control)","Disconnected (By Municipality)","Blocked By Municipality","Old Meter (Not In Use)","Incomplete Service Point"],"Required").notOneOf(["choose",""],"Required"):e}),offGridSupply:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").oneOf(["yes","no"],"Required").notOneOf(["choose",""],"Required"):e})}))}),tid:o().shape({access:o().shape({meterAccess:n().required("Required").notOneOf(["choose",""],"Required"),noAccessReason:n().when("meterAccess",(s,t)=>{var a;if(s[0]==="no")return(a=t==null?void 0:t.required("no access reason required"))==null?void 0:a.notOneOf(["choose",""],"Required");if(s[0]==="yes")return t.notRequired().oneOf(["","choose"],"Must Be 'choose' ")})}),tidOperation:y((s,{context:t})=>o().shape({tidDone:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="yes"?e.required("Required").notOneOf(["choose",""],"Required"):e.notRequired()}),comment:n().when("tidDone",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"||a==="no"?e.notRequired():a[0]==="yes"?e.required("Required").notOneOf(["choose"],"Required"):e})})),tidBefore:y((s,{context:t})=>o().shape({tariff:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access,{tidDone:d}=t.tidOperation;if(r==="yes"&&d==="yes")return e.required("Required").notOneOf(["choose"],"Required");if(r==="yes"&&(d==="no"||d===""||d==="choose"))return e.notRequired()}),krn:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access,{tidDone:d}=t.tidOperation;if(r==="yes"&&d==="yes")return e.required("Required").notOneOf(["choose"],"Required");if(r==="yes"&&(d==="no"||d===""||d==="choose"))return e.notRequired()})})),tidAfter:y((s,{context:t})=>o().shape({tariff:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access,{tidDone:d}=t.tidOperation;if(r==="yes"&&d==="yes")return e.required("Required").notOneOf(["choose"],"Required");if(r==="yes"&&(d==="no"||d===""||d==="choose"))return e.notRequired()}),krn:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access,{tidDone:d}=t.tidOperation;if(r==="yes"&&d==="yes")return e.required("Required").notOneOf(["choose"],"Required");if(r==="yes"&&(d==="no"||d===""||d==="choose"))return e.notRequired()})}))}),installation:o().shape({access:o().shape({meterAccess:n().required("Required").notOneOf(["choose",""],"Required"),noAccessReason:n().when("meterAccess",(s,t)=>{var a;if(s[0]==="no")return(a=t==null?void 0:t.required("no access reason required"))==null?void 0:a.notOneOf(["choose",""],"Required");if(s[0]==="yes")return t.notRequired().oneOf(["","choose"],"Must Be 'choose' ")})}),installationData:y((s,{context:t})=>o().shape({sgc:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").notOneOf(["choose",""],"Required"):e})})),astData:y((s,{context:t})=>o().shape({astNo:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required"):e}),astManufacturer:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required"):e}),astName:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required"):e}),meter:o().shape({phase:n().when("astNo",(a,e)=>{var m;const{astNo:r}=t.astData,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r===""||r===null||r===void 0?e==null?void 0:e.notRequired():(m=e==null?void 0:e.defined("Required"))==null?void 0:m.oneOf(["single","three"],"Required")}),type:n().when("astNo",(a,e)=>{var m;const{astNo:r}=t.astData,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r===""||r===null||r===void 0?e==null?void 0:e.notRequired():(m=e==null?void 0:e.defined("Required"))==null?void 0:m.oneOf(["pre-paid","conventional"],"Required")}),keypad:o().shape({keypadInstalled:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").oneOf(["yes","no"],"Required").notOneOf(["choose",""],"Required"):e}),serialNo:n().when("keypadInstalled",(a,e)=>{const{keypadInstalled:r}=t.astData.meter.keypad,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r==="yes"?e.required("Required"):r==="no"?e.oneOf([""],"Must Be Blank"):e}),comment:n().when("keypadInstalled",(a,e)=>{const{keypadInstalled:r}=t.astData.meter.keypad,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r==="no"?e.required("Required").notOneOf(["choose"],"Required"):e})}),cb:o().shape({cbInstalled:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").oneOf(["yes","no"],"Required").notOneOf(["choose",""],"Required"):e}),size:R().when("cbInstalled",(a,e)=>{const{cbInstalled:r}=t.astData.meter.cb,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r==="yes"?e.required("Required").notOneOf([""],"Required"):r==="no"?e.oneOf([""],"Must Be Blank"):e}),comment:n().when("cbInstalled",(a,e)=>{const{cbInstalled:r}=t.astData.meter.cb,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r==="no"?e.required("Value Required").notOneOf(["choose"],"Required").defined("Required"):e})}),seal:o().shape({sealInstalled:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").oneOf(["yes","no"],"Required").notOneOf(["choose",""],"Required"):e}),sealNo:n().when("sealInstalled",(a,e)=>{const{sealInstalled:r}=t.astData.meter.seal,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r==="yes"?e.required("Required"):r==="no"?e.oneOf([""],"Must Be Blank"):e}),comment:n().when("sealInstalled",(a,e)=>{const{sealInstalled:r}=t.astData.meter.seal,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r==="no"?e.required("Required").notOneOf(["choose"],"Required"):e})})})})),location:y((s,{context:t})=>o().shape({address:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="yes"?e.required("Required"):e.notRequired()}),gps:o().shape({lat:R().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="yes"?e.required("Required"):e.notRequired()}),lng:R().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="yes"?e.required("Required"):e.notRequired()})}),premises:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").oneOf(["inside","outside"],"Required"):e.notRequired()}),insideBox:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").oneOf(["yes","no"],"Required"):e.notRequired()})})),anomalies:y((s,{context:t})=>o().shape({anomaly:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").notOneOf(["choose",""],"Required"):e}),anomalyDetail:n().when("anomaly",(a,e)=>{const{anomaly:r}=t.anomalies,{meterAccess:d}=t.access;return d==="no"||r===""||r==="choose"||r===null||r===void 0?e.notRequired():e.required("Required").notOneOf(["choose",""],"Required")})})),serviceConnection:y((s,{context:t})=>o().shape({configuration:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").oneOf(["overhead","underground"],"Required").notOneOf(["choose",""],"Required"):e})}))}),inspection:o().shape({access:o().shape({meterAccess:n().required("Required").notOneOf(["choose",""],"Required"),noAccessReason:n().when("meterAccess",(s,t)=>{var a;if(s[0]==="no")return(a=t==null?void 0:t.required("no access reason required"))==null?void 0:a.notOneOf(["choose",""],"Required");if(s[0]==="yes")return t.notRequired().oneOf(["","choose"],"Must Be 'choose' ")})}),inspectionData:y((s,{context:t})=>o().shape({newMeter:n().when("meterAccess",(a,e)=>{var d;const{meterAccess:r}=t.access;return r==="no"?e.notRequired().oneOf(["","choose"],"Must Be 'choose' "):r==="yes"?(d=e==null?void 0:e.required("required"))==null?void 0:d.notOneOf(["choose",""],"Required"):e})})),astData:y((s,{context:t})=>o().shape({astNo:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required"):e}),astManufacturer:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required"):e}),astName:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required"):e}),meter:o().shape({phase:n().when("astNo",(a,e)=>{var m;const{astNo:r}=t.astData,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r===""||r===null||r===void 0?e==null?void 0:e.notRequired():(m=e==null?void 0:e.defined("Required"))==null?void 0:m.oneOf(["single","three"],"Required")}),type:n().when("astNo",(a,e)=>{var m;const{astNo:r}=t.astData,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r===""||r===null||r===void 0?e==null?void 0:e.notRequired():(m=e==null?void 0:e.defined("Required"))==null?void 0:m.oneOf(["pre-paid","conventional"],"Required")}),keypad:o().shape({keypadAccess:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;if(r==="no")return e.notRequired();if(r==="yes")return e.required("Required").oneOf(["yes","no"],"yes or no").notOneOf(["choose",""],"Required")}),serialNo:n().when("keypadAccess",(a,e)=>{const{keypadAccess:r}=t.astData.meter.keypad,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r==="yes"?e.required("Required"):r==="no"?e.oneOf([""],"Must Be Blank"):e}),comment:n().when("keypadAccess",(a,e)=>{const{keypadAccess:r}=t.astData.meter.keypad,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r==="no"?e.required("Required").notOneOf(["choose"],"Required"):e})}),cb:o().shape({isThereCb:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;if(r==="no")return e.notRequired();if(r==="yes")return e.required("Required").oneOf(["yes","no"],"yes or no").notOneOf(["choose",""],"Required")}),size:R().when("isThereCb",(a,e)=>{const{isThereCb:r}=t.astData.meter.cb,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r==="yes"?e.required("Required").notOneOf([""],"Required"):r==="no"?e.oneOf([""],"Must Be Blank"):e}),comment:n().when("isThereCb",(a,e)=>{const{isThereCb:r}=t.astData.meter.cb,{meterAccess:d}=t.access;return d==="no"?e.notRequired():r==="no"?e.required("Value Required").notOneOf(["choose"],"Required").defined("Required"):e})}),seal:o().shape({meterSealed:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;if(r==="no")return e.notRequired();if(r==="yes")return e.required("Required").oneOf(["yes","no"],"yes or no").notOneOf(["choose",""],"Required")}),sealNo:n().when(["meterSealed","comment"],([a,e],r)=>{const{meterAccess:d}=t.access;return d==="no"?r.notRequired():e==="seal no hard to read"||e==="seal has no seal no"||a==="no"?r.oneOf([""],"Must Be Blank"):a==="yes"?r.required("Required"):r}),comment:n().when("meterSealed",(a,e)=>{var A,w;const{meterSealed:r,sealNo:d}=(w=(A=t==null?void 0:t.astData)==null?void 0:A.meter)==null?void 0:w.seal,{meterAccess:m}=t==null?void 0:t.access;return m==="no"?e.notRequired():r==="yes"&&d===""?e.required("Required").defined("Required").notOneOf(["choose"],"Required"):e})})})})),location:y((s,{context:t})=>o().shape({address:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="yes"?e.required("Required"):e.notRequired()}),gps:o().shape({lat:R().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="yes"?e.required("Required"):e.notRequired()}),lng:R().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="yes"?e.required("Required"):e.notRequired()})}),premises:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").oneOf(["inside","outside"],"Required"):e.notRequired()}),insideBox:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").oneOf(["yes","no"],"Required"):e.notRequired()})})),anomalies:y((s,{context:t})=>o().shape({anomaly:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").notOneOf(["choose",""],"Required"):e}),anomalyDetail:n().when("anomaly",(a,e)=>{const{anomaly:r}=t==null?void 0:t.anomalies,{meterAccess:d}=t==null?void 0:t.access;return d==="no"||r===""||r==="choose"||r===null||r===void 0?e.notRequired():e.required("Required").notOneOf(["choose"],"Required")})})),serviceConnection:y((s,{context:t})=>o().shape({configuration:n().when("meterAccess",(a,e)=>{const{meterAccess:r}=t.access;return r==="no"?e.notRequired():r==="yes"?e.required("Required").oneOf(["overhead","underground"],"Required").notOneOf(["choose",""],"Required"):e})}))})}},p={meter:{audit:[{field:"id",headerName:"System Id",width:200,hide:!0},{headerName:"Created",children:[{field:"metadata.createdByUser",headerName:"Created By",width:150,hide:!1},{field:"metadata.createdAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:s=>{const a=new h(s.value.seconds,s.value.nanoseconds).toDate();return c.jsx(N,{date:a,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:s=>s.data.metadata.createdAtDatetime,hide:!1}]},{headerName:"Updated",children:[{field:"metadata.updatedByUser",headerName:"Updated By",width:150,hide:!1},{field:"metadata.updatedAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:s=>{const a=new h(s.value.seconds,s.value.nanoseconds).toDate();return c.jsx(N,{date:a,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:s=>s.data.metadata.updatedAtDatetime,hide:!1}]},{headerName:"Ast Data",children:[{field:"astData.astCatergory",columnGroupShow:"open",headerName:"Ast Cat",width:150,hide:!1},{field:"astData.astNo",columnGroupShow:"closed",headerName:"Ast No",width:150,hide:!1},{field:"astData.astManufacturer",columnGroupShow:"open",headerName:"Manufacturer",width:150,hide:!1},{field:"astData.astName",columnGroupShow:"open",headerName:"Ast Name",width:150,hide:!1}]},{field:"",headerName:"Edit",cellRenderer:s=>c.jsx(D,{data:s,children:c.jsx(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:c.jsx(g,{})})}),cellRendererParams:{modalName:"meter-audit",validationSchema:f.meter.audit,width:"3rem"},width:80},{headerName:"Erf (Where ast belongs)",children:[{field:"erf.erfNo",headerName:"Erf No",width:110,cellRenderer:s=>c.jsx(D,{data:s,children:c.jsxs(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:[c.jsx(_,{})," ",s.value]})}),cellRendererParams:{modalName:"iwShowOnMap",tableBtnClass:"table-btn-icon"},hide:!1},{field:"erf.address.street",headerName:"Street Address",width:200,hide:!1},{field:"erf.address.systemAdr",headerName:"Erf Address (Google)",width:200,hide:!1}]},{field:"metadata.trnState",headerName:"State",width:100},{field:"metadata.trnType",headerName:"Trn Type",valueGetter:s=>{const{trnType:t}=s.data.metadata;return t},width:120},{headerName:"Access",children:[{field:"access.meterAccess",headerName:"Access?",width:120},{field:"access.noAccessReason",headerName:"No Access Reason",width:200}]},{headerName:"Ast Specific",children:[{field:"astData.meter.type",headerName:"Meter Type",width:150,hide:!1},{field:"astData.meter.phase",headerName:"Meter Phase",width:150,hide:!1}]},{headerName:"Anomalies",children:[{field:"anomalies.anomaly",columnGroupShow:"open",headerName:"Anomaly",width:150},{field:"anomalies.anomalyDetail",columnGroupShow:"open",headerName:"Anomaly Detail",width:300}]}],tid:[{field:"id",headerName:"System Id",width:200,hide:!0},{headerName:"Created",children:[{field:"metadata.createdByUser",headerName:"Created By",width:150,hide:!1},{field:"metadata.createdAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:s=>{const a=new h(s.value.seconds,s.value.nanoseconds).toDate();return c.jsx(N,{date:a,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:s=>s.data.metadata.createdAtDatetime,hide:!1}]},{headerName:"Updated",children:[{field:"metadata.updatedByUser",headerName:"Updated By",width:150,hide:!1},{field:"metadata.updatedAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:s=>{const a=new h(s.value.seconds,s.value.nanoseconds).toDate();return c.jsx(N,{date:a,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:s=>s.data.metadata.updatedAtDatetime,hide:!1}]},{headerName:"Ast Data",children:[{field:"astData.astNo",headerName:"Ast No",width:150,hide:!1}]},{field:"",headerName:"Edit",cellRenderer:s=>c.jsx(D,{data:s,children:c.jsx(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:c.jsx(g,{})})}),cellRendererParams:{modalName:"meter-tid",validationSchema:f.meter.tid,width:"3rem"},width:80},{field:"metadata.trnState",headerName:"State",width:100,hide:!1},{field:"metadata.trnType",headerName:"Trn Type",valueGetter:s=>{const{trnType:t}=s.data.metadata;return t},width:120},{headerName:"Access",children:[{field:"access.meterAccess",headerName:"Access",width:100,hide:!1},{field:"access.noAccessReason",headerName:"No Access Reason",width:220,hide:!1}]},{headerName:"Tid Operation",children:[{field:"tidOperation.tidDone",headerName:"Tid Done?",width:150,hide:!1},{field:"tidOperation.comment",headerName:"Comment",width:200,hide:!1}]},{headerName:"Tid Before",children:[{field:"tidBefore.tariff",headerName:"Tariff",width:150,hide:!1},{field:"tidBefore.krn",headerName:"KRN",width:150,hide:!1}]},{headerName:"Tid After",children:[{field:"tidAfter.tariff",headerName:"Tariff",width:150,hide:!1},{field:"tidAfter.krn",headerName:"KRN",width:150,hide:!1}]}],installation:[{field:"id",headerName:"System Id",width:200,hide:!0},{headerName:"Created",children:[{field:"metadata.createdByUser",headerName:"Created By",width:150,hide:!1},{field:"metadata.createdAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:s=>{const a=new h(s.value.seconds,s.value.nanoseconds).toDate();return c.jsx(N,{date:a,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:s=>s.data.metadata.createdAtDatetime,hide:!1}]},{headerName:"Updated",children:[{field:"metadata.updatedByUser",headerName:"Updated By",width:150,hide:!1},{field:"metadata.updatedAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:s=>{const a=new h(s.value.seconds,s.value.nanoseconds).toDate();return c.jsx(N,{date:a,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:s=>s.data.metadata.updatedAtDatetime,hide:!1}]},{headerName:"Ast Data",children:[{field:"astData.astCatergory",columnGroupShow:"open",headerName:"Ast Cat",width:150,hide:!1},{field:"astData.astNo",columnGroupShow:"closed",headerName:"Ast No",width:150,hide:!1},{field:"astData.astManufacturer",columnGroupShow:"open",headerName:"Manufacturer",width:150,hide:!1},{field:"astData.astName",columnGroupShow:"open",headerName:"Ast Name",width:150,hide:!1}]},{field:"",headerName:"Edit",cellRenderer:s=>c.jsx(D,{data:s,children:c.jsx(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:c.jsx(g,{})})}),cellRendererParams:{modalName:"meter-installation",validationSchema:f.meter.installation,width:"3rem"},width:80},{field:"erf.erfNo",headerName:"Erf No",width:110,cellRenderer:s=>c.jsx(D,{data:s,children:c.jsxs(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:[c.jsx(_,{})," ",s.value]})}),cellRendererParams:{modalName:"iwShowOnMap",tableBtnClass:"table-btn-icon"},hide:!1},{field:"metadata.trnState",headerName:"State",width:100},{field:"metadata.trnType",headerName:"Trn Type",valueGetter:s=>{const{trnType:t}=s.data.metadata;return t},width:120},{headerName:"Access",children:[{field:"access.meterAccess",headerName:"Access?",width:120},{field:"access.noAccessReason",headerName:"No Access Reason",width:200}]},{headerName:"Ast Specific",children:[{field:"astData.meter.type",headerName:"Meter Type",width:150,hide:!1},{field:"astData.meter.phase",headerName:"Meter Phase",width:150,hide:!1}]},{headerName:"Ast Location",children:[{field:"location.address",columnGroupShow:"closed",headerName:"Ast Address",width:450},{field:"location.premises",columnGroupShow:"closed",headerName:"Premises",width:120},{field:"location.insideBox",columnGroupShow:"closed",headerName:"InsideBox",width:120}]}],inspection:[{field:"id",headerName:"System Id",width:200,hide:!0},{headerName:"Created",children:[{field:"metadata.createdByUser",headerName:"Created By",width:150,hide:!1},{field:"metadata.createdAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:s=>{const a=new h(s.value.seconds,s.value.nanoseconds).toDate();return c.jsx(N,{date:a,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:s=>s.data.metadata.createdAtDatetime,hide:!1}]},{headerName:"Updated",children:[{field:"metadata.updatedByUser",headerName:"Updated By",width:150,hide:!1},{field:"metadata.updatedAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:s=>{const a=new h(s.value.seconds,s.value.nanoseconds).toDate();return c.jsx(N,{date:a,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:s=>s.data.metadata.updatedAtDatetime,hide:!1}]},{headerName:"Ast Data",children:[{field:"astData.astCatergory",columnGroupShow:"open",headerName:"Ast Cat",width:150,hide:!1},{field:"astData.astNo",columnGroupShow:"closed",headerName:"Ast No",width:150,hide:!1},{field:"astData.astManufacturer",columnGroupShow:"open",headerName:"Manufacturer",width:150,hide:!1},{field:"astData.astName",columnGroupShow:"open",headerName:"Ast Name",width:150,hide:!1}]},{field:"",headerName:"Edit",cellRenderer:s=>c.jsx(D,{data:s,children:c.jsx(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:c.jsx(g,{})})}),cellRendererParams:{modalName:"meter-inspection",validationSchema:f.meter.inspection,width:"3rem"},width:80},{headerName:"Erf (Where ast belongs)",children:[{field:"erf.erfNo",headerName:"Erf No",width:110,cellRenderer:s=>c.jsx(D,{data:s,children:c.jsxs(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:[c.jsx(_,{})," ",s.value]})}),cellRendererParams:{modalName:"iwShowOnMap",tableBtnClass:"table-btn-icon"},hide:!1},{field:"erf.address.systemAdr",headerName:"Erf Address (Google)",width:300,hide:!1}]},{field:"metadata.trnState",headerName:"State",width:100},{field:"metadata.trnType",headerName:"Trn Type",valueGetter:s=>{const{trnType:t}=s.data.metadata;return t},width:120},{headerName:"Access",children:[{field:"access.meterAccess",headerName:"Access?",width:120},{field:"access.noAccessReason",headerName:"No Access Reason",width:200}]},{headerName:"Ast Specific",children:[{field:"astData.meter.type",headerName:"Meter Type",width:150,hide:!1},{field:"astData.meter.phase",headerName:"Meter Phase",width:150,hide:!1}]},{headerName:"Anomalies",children:[{field:"anomalies.anomaly",columnGroupShow:"open",headerName:"Anomaly",width:150},{field:"anomalies.anomalyDetail",columnGroupShow:"open",headerName:"Anomaly Detail",width:300}]},{headerName:"Ast Location",children:[{field:"location.address",columnGroupShow:"closed",headerName:"Ast Address",width:450},{field:"location.premises",columnGroupShow:"closed",headerName:"Premises",width:120},{field:"location.insideBox",columnGroupShow:"closed",headerName:"InsideBox",width:120}]}]},all:{all:[{field:"id",headerName:"System Id",width:200,hide:!0},{headerName:"Created",children:[{field:"metadata.createdByUser",headerName:"Created By",width:150},{field:"metadata.createdAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:s=>{const a=new h(s.value.seconds,s.value.nanoseconds).toDate();return c.jsx(N,{date:a,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:s=>s.data.metadata.createdAtDatetime,hide:!1}]},{headerName:"Last Updated",children:[{field:"metadata.updatedByUser",headerName:"Updated By",width:150},{field:"metadata.updatedAtDatetime",columnGroupShow:"open",headerName:"Date Created",width:150,cellRenderer:s=>{const a=new h(s.value.seconds,s.value.nanoseconds).toDate();return c.jsx(N,{date:a,dateFormat:"yyyy-MMM-dd HH:mm"})},valueGetter:s=>s.data.metadata.updatedAtDatetime,hide:!1}]},{headerName:"Meter Description",children:[{field:"astData.astNo",headerName:"Meter No",width:150,hide:!1}]},{field:"",headerName:"Edit Trn",cellRenderer:s=>{var a,e;const t=(e=(a=s==null?void 0:s.data)==null?void 0:a.metadata)==null?void 0:e.trnType;return c.jsx(D,{data:s,modalName:`meter-${t}`,children:c.jsx(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:c.jsx(g,{})})})},cellRendererParams:{validationSchema:f.meter.audit,width:"3rem"},width:100,filter:!1},{headerName:"Erf (Where Meter Belongs)",children:[{field:"erf.erfNo",headerName:"Erf No",width:110,cellRenderer:s=>c.jsx(D,{data:s,children:c.jsxs(O.Provider,{value:{color:"blue",fontSize:"1rem"},children:[c.jsx(_,{})," ",s.value]})}),cellRendererParams:{modalName:"iwShowOnMap",tableBtnClass:"table-btn-icon"},hide:!1,filter:!1},{field:"erf.address.street",headerName:"Street Address",width:300,hide:!1},{field:"erf.address.systemAdr",headerName:"Google Address",width:300,hide:!1}]},{field:"metadata.trnState",headerName:"Form State",width:120},{field:"metadata.trnType",headerName:"Trn Type",valueGetter:s=>{const{trnType:t}=s.data.metadata;return t},width:120},{headerName:"Access",children:[{field:"access.meterAccess",headerName:"Access?",width:120},{field:"access.noAccessReason",headerName:"No Access Reason",width:200}]}]}};return{trnsNewFormData:l,trnsValidationSchema:f,trnsTableFields:p}};export{se as a,ie as b,ae as u,S as v};
