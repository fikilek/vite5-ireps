import{r as f,j as i,a9 as N,J as D,u as g,aa as w,k as C,l as x,B as R,a1 as v,t as E,s as y}from"./index-DJBUruBi.js";import{M,C as j,A as T,T as U}from"./ag-theme-quartz-V47p7KAO.js";try{let t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},r=new t.Error().stack;r&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[r]="49c782ad-2397-4550-8589-c73b57723395",t._sentryDebugIdIdentifier="sentry-dbid-49c782ad-2397-4550-8589-c73b57723395")}catch{}M.registerModules([j]);const S=t=>{const{rowData:r,colDefs:a}=t,c=f.useMemo(()=>({sortable:!0,filter:!0,resizable:!0,floatingFilter:!0,suppressMovable:!0}),[]),s=l=>l.data.id,o={"row-disabled":l=>{var d,e;return console.log("params?.data?.disabled",(d=l==null?void 0:l.data)==null?void 0:d.disabled),(e=l==null?void 0:l.data)==null?void 0:e.disabled}};return i.jsx("div",{className:"ag-theme-quartz table table-users",children:i.jsx(T,{rowData:r,columnDefs:a,defaultColDef:c,pagination:!0,noRowsOverlayComponent:U,getRowId:s,rowClassRules:o,reactiveCustomComponents:!0})})},p=t=>{var h;const{roles:r}=(h=t==null?void 0:t.data)==null?void 0:h.customClaims,{customClaims:a,setCustomClaims:c}=f.useContext(N),[s,o]=f.useState({}),{uid:l}=t==null?void 0:t.data,d=a==null?void 0:a.uid;f.useEffect(()=>{l===d&&a.roles?o(a.roles):o(r)},[a]);const{openModal:e}=D(),{user:n}=g();l===n.uid||t.data.disabled;const u=b=>{c({uid:l,roles:s}),e({modalName:"editUserRoles",payload:t.data})};return i.jsx("div",{className:"table-users-roles",children:w&&w.map(b=>{console.log("role",b);const m=s[b.key]?"hasRole":"";return i.jsx("button",{className:`table-btn ${m}`,title:b.name,onClick:u,children:b.abbreviation},b.name)})})},A=t=>{const{value:r,options:a,onValueChange:c}=t,s=C(),o=x(s,"disableUserAcc"),l=d=>{c(d.target.value),t.api.redrawRows(),o({uid:t.data.uid,action:d.target.value==="disabled"}).then(e=>{R.success(`User acc [${t.data.displayName}] succesfully ${d.target.value==="disabled"?"DISABLED":"ENABLED"}  `,{position:"bottom-left"})}).catch(e=>{console.log("Error:",e.message)})};return i.jsx("div",{className:"table-user-acc-disable-select",children:i.jsx("select",{value:r,className:"table-btn",onChange:l,children:a&&a.map(d=>i.jsx("option",{value:d,children:d},d))})})},I=t=>{const[r,a]=f.useState([]),{user:c}=g(),{data:s}=v("users",null),o=C(),l=x(o,"listAllUsers");return f.useEffect(()=>{c&&l().then(e=>{var u;let n=[];(u=e==null?void 0:e.data)==null||u.forEach(h=>{const b=s.find(m=>h.uid===m.id);b&&n.push({...h,companyName:b.companyName,workbase:b.workbase,phoneNumber:b.phoneNumber})}),a(n)})},[s,c]),{usersTableFields:[{field:"uid",headerName:"users Id",width:250,hide:!0},{field:"disabled",headerName:"Acc Status?",width:150,editable:!0,cellEditor:A,cellEditorParams:{options:["enabled","disabled"]},valueGetter:e=>e.data.disabled?"disabled":"enabled",valueSetter:e=>(e.data.disabled=e.newValue==="disabled",!0),cellStyle:e=>{const{uid:n}=e.data;return n===c.uid?{color:"grey",fontWeight:"700",pointerEvents:"none",cursor:"none",borderLeft:"0.3rem solid grey"}:""}},{field:"workbase",headerName:"Workbase",width:180,cellRenderer:e=>i.jsx(E,{data:e,children:e.value}),cellRendererParams:{modalName:"workbases",width:"8rem"}},{field:"metadata.creationTime",headerName:"Date Created",width:180,cellRenderer:e=>{var u;const n=new Date((u=e.data.metadata)==null?void 0:u.creationTime);return i.jsx(y,{date:n,dateFormat:"yyyy-MMM-dd HH:mm"})}},{field:"metadata.lastSignInTime",headerName:"Last Signin",width:180,cellRenderer:e=>{var u;const n=new Date((u=e.data.metadata)==null?void 0:u.lastSignInTime);return i.jsx(y,{date:n,dateFormat:"yyyy-MMM-dd HH:mm"})}},{field:"displayName",headerName:"Display Name",width:170},{field:"email",headerName:"Email Adr",width:200},{field:"emailVerified",headerName:"Email Verified",width:150,cellRenderer:e=>i.jsx("p",{children:e.data.emailVerified?"Yes":"No"})},{field:"customClaims.roles",headerName:"Roles",width:220,cellRenderer:p,valueGetter:e=>e.value},{field:"phoneNumber",headerName:"Phone Number",width:150},{field:"companyName",headerName:"Company Name",width:170}],users:r}},V=()=>{const{usersTableFields:t,users:r}=I(),[a,c]=f.useState([]),{customClaims:s}=f.useContext(N);return f.useEffect(()=>{c(r)},[r]),f.useEffect(()=>{if(!s)return;const o=a.find(n=>n.uid===(s==null?void 0:s.uid)),l={...o,customClaims:{...o==null?void 0:o.customClaims,roles:s==null?void 0:s.roles}},d=a.findIndex(n=>n.uid===(s==null?void 0:s.uid));if(d===-1)return;const e=a==null?void 0:a.with(d,l);c(e)},[s]),i.jsx("div",{className:"table",children:i.jsx(S,{rowData:a,colDefs:t})})};export{V as default};
//# sourceMappingURL=Users-D9ENvjPb.js.map
