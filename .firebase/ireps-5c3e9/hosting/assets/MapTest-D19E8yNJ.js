import{r as d,s as m,c as y,q as M,e as w,w as b,f as E,j as o,t as j,P as x,d as I,y as _,z as k}from"./index-CTrsszhs.js";import{u as B}from"./useAstsMap-BCbHQV1x.js";import{u as D}from"./useErfs-Do9Wfvlc.js";import{M as z}from"./index.esm-B1q71lAr.js";import{z as p}from"./za_kzn_umgungundlovu_mpofana_w1-CZ0tBZXl.js";import"./useTrns-B_NpY6rq.js";try{let r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new r.Error().stack;n&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[n]="00b12aa8-fe75-438c-bc5b-c35ec409400e",r._sentryDebugIdIdentifier="sentry-dbid-00b12aa8-fe75-438c-bc5b-c35ec409400e")}catch{}const A=()=>{var u,i;const[r,n]=d.useState(),t=m();let c=y(I,"erfs");const f=d.useMemo(()=>M(c,b("address.lmMetro","==","Mpofana LM"),b("address.ward","==","1"),w("metadata.updatedAtDatetime","desc")),[c]);return d.useEffect(()=>{E(f,e=>{const s=[];e.docs.forEach(a=>{s.push({id:a.id,...a.data()})}),n(s)},e=>{console.log("firestore err",e.message)})},[]),(u=t==null?void 0:t.data)==null||u.loadGeoJson(p,p),(i=t.data)==null||i.setStyle(e=>({fillOpacity:0,strokeWeight:.1,strokeColor:"blue"})),d.useEffect(()=>{C().then(e=>{let s=new window.google.maps.LatLngBounds;e.features[0].geometry.coordinates[0][0].forEach(a=>{s.extend({lat:a[1],lng:a[0]})}),t==null||t.fitBounds(s)})},[t]),o.jsx("div",{children:o.jsx(P,{erfs:r})})},C=async()=>await(await fetch(p)).json(),P=r=>{const{erfs:n}=r,t=m(),[c,f]=d.useState({}),u=d.useRef(null);d.useEffect(()=>{t&&(u.current||(u.current=new z({map:t})))},[t]),d.useEffect(()=>{var e,s;(e=u.current)==null||e.clearMarkers(),(s=u.current)==null||s.addMarkers(Object.values(c))},[c]);const i=(e,s)=>{e&&c[s]||!e&&!c[s]||f(a=>{if(e)return{...a,[s]:e};{const l={...a};return delete l[s],l}})};return o.jsx(o.Fragment,{children:n==null?void 0:n.map(e=>{var s,a,l,g;return o.jsx(j,{position:{lat:(a=(s=e==null?void 0:e.address)==null?void 0:s.gps)==null?void 0:a.latitude,lng:(g=(l=e==null?void 0:e.address)==null?void 0:l.gps)==null?void 0:g.longitude},ref:h=>i(h,e.id),children:o.jsx(x,{background:"#FBBC04",glyphColor:"#000",borderColor:"#000"})},e.id)})})},O=()=>(D(),B(),o.jsx("div",{className:"map-test",children:o.jsx(_,{apiKey:"AIzaSyDKsugznrX_Zh0u73iZ0HsOo47QTE8KRjc",onLoad:()=>console.log("Maps API has loaded."),onError:()=>console.log("There was an error on iREPS Map"),children:o.jsx(k,{defaultZoom:13,defaultCenter:{lat:-33.860664,lng:151.208138},gestureHandling:"greedy",disableDefaultUI:!1,mapId:"eab81cec6c21fbbc",children:o.jsx(A,{})})})}));export{O as default};
//# sourceMappingURL=MapTest-D19E8yNJ.js.map
