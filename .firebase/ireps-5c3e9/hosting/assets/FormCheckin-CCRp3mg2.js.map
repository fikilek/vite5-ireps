{"version":3,"file":"FormCheckin-CCRp3mg2.js","sources":["../../src/components/forms/formTrn/checkin/FormCheckin.jsx"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { Formik, Form, useFormikContext } from \"formik\";\nimport { useCallback } from \"react\";\nimport { toast } from \"react-toastify\";\n\n// css\nimport \"@/components/forms/formTrn/checkin/FormCheckin.css\";\n\n// custom hooks\nimport { useFirestore } from \"@/hooks/useFirestore.jsx\";\nimport useModal from \"@/hooks/useModal.jsx\";\n\n// components\nimport FormikControl from \"@/components/forms/formik/FormikControl\";\nimport FormSection from \"@/components/forms/formSection/FormSection\";\nimport { formSelectOptions } from \"@/utils/utils\";\nimport FormFooter from \"@/components/forms/formFooter/FormFooter\";\nimport HeaderGeneric from \"@/components/header/HeaderGeneric\";\nimport MapReverseGeocodingApp from \"@/components/maps/MapReverseGeocodingApp\";\nimport MediaMobileWrapper from \"@/components/media/MediaMobileWrapper\";\nimport FormCloseBtn from \"@/components/forms/formBtns/FormCloseBtn\";\nimport { updateFormState } from \"@/utils/utils\";\n\nconst FormCheckin = (props) => {\n\t// console.log(`props`, props);\n\n\tconst { data, validationSchema } = props?.data;\n\t// console.log(`data`, data);\n\n\t// const { erfNo, erfId, address } = data.erf;\n\n\t// destructure trn id\n\tconst { trnId } = data.metadata;\n\t// console.log(`trnId`, trnId);\n\n\tconst { closeModal } = useModal();\n\n\tconst [active, setActive] = useState(null);\n\n\tconst { response, setDocument } = useFirestore(\"trns\");\n\t// console.log(`response`, response)\n\n\tconst [trnState, setTrnState] = useState(data?.metadata?.trnState)\n\t// console.log(`trnState`, trnState)\n\n\tconst onSubmit = useCallback(\n\t\t(values) => {\n\t\t\tconsole.log(`values`, values);\n\t\t\tsetDocument({\n\t\t\t...values,\n\t\t\t\tmetadata: {\n\t\t\t\t\t...values.metadata,\n\t\t\t\t\ttrnState\n\t\t\t\t}\n\t\t\t}\n\t\t\t, values.metadata.trnId);\n\t\t},\n\t\t[setDocument, trnState]\n\t);\n\n\tuseEffect(() => {\n\t\t// console.log(`response`, response);\n\t\tif (response.success) {\n\t\t\t// deleteItem(key);\n\t\t\tcloseModal();\n\t\t\ttoast(`Transaction UPDATED successfully!`, {\n\t\t\t\tposition: \"bottom-left\",\n\t\t\t\tautoClose: 5000,\n\t\t\t\thideProgressBar: false,\n\t\t\t\tcloseOnClick: true,\n\t\t\t\tpauseOnHover: true,\n\t\t\t\tdraggable: true,\n\t\t\t\tprogress: undefined,\n\t\t\t\ttheme: \"light\",\n\t\t\t});\n\t\t}\n\t}, [response]);\n\n\treturn data ? (\n\t\t<div className=\"form-wrapper\">\n\t\t\t<div className=\"form-container trn form-meter-audit\">\n\t\t\t\t<Formik\n\t\t\t\t\tinitialValues={data}\n\t\t\t\t\tonSubmit={onSubmit}\n\t\t\t\t\tvalidationSchema={validationSchema}\n\t\t\t\t\tvalidateOnMount={true}\n\t\t\t\t>\n\t\t\t\t\t{(formik) => {\n\t\t\t\t\t\t// const disabled = !(formik.isValid && formik.dirty);\n\t\t\t\t\t\t// console.log(`formik.errors`, formik.errors);\n\t\t\t\t\t\t// console.log(`formik.isValid`, formik.isValid);\n\t\t\t\t\t\t// console.log(`disabled`, disabled);\n\t\t\t\t\t\t// console.log(`formik.values`, formik.values);\n\n\t\t\t\t\t\tupdateFormState(formik, setTrnState)\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<Form>\n\t\t\t\t\t\t\t\t<div className=\"trn-form\">\n\t\t\t\t\t\t\t\t\t<HeaderGeneric\n\t\t\t\t\t\t\t\t\t\thl1={\n\t\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t\tMeter <span className=\"text-emphasis2\">Audit</span> Form\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t// hl2={\n\t\t\t\t\t\t\t\t\t\t// \t<span className=\"text-emphasis2\">\n\t\t\t\t\t\t\t\t\t\t// \t\t{trnState}\n\t\t\t\t\t\t\t\t\t\t// \t</span>\n\t\t\t\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t\t\t\t// hr1={\n\t\t\t\t\t\t\t\t\t\t// \t<span>\n\t\t\t\t\t\t\t\t\t\t// \t\tErf:<span className=\"text-emphasis2\">{erfNo}</span>\n\t\t\t\t\t\t\t\t\t\t// \t</span>\n\t\t\t\t\t\t\t\t\t\t// }\n\t\t\t\t\t\t\t\t\t\thr2={\n\t\t\t\t\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t\t\t\t\tMeter:\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-emphasis2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{formik.values.astData.astNo}\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<FormCloseBtn />\n\t\t\t\t\t\t\t\t\t</HeaderGeneric>\n\n\t\t\t\t\t\t\t\t\t{/* meter description */}\n\t\t\t\t\t\t\t\t\t<FormSection\n\t\t\t\t\t\t\t\t\t\tsectionData={{\n\t\t\t\t\t\t\t\t\t\t\tsectionName: \"meterDescription\",\n\t\t\t\t\t\t\t\t\t\t\tformik: formik,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tactive={active}\n\t\t\t\t\t\t\t\t\t\tsetActive={setActive}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<div className=\"form-row-wrapper\">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"row-1 form-row\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<FormikControl\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontrol=\"inputBarcodeScan\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"Meter No\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname={`astData.astNo`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<FormikControl\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontrol=\"mediaButton\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"meter no media\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname={`astData.media.astNo`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tml1=\"asts\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"row-50-50\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<FormikControl\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontrol=\"select\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"meter phase?\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname={`astData.meter.phase`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={formSelectOptions.meterPhaseOptions}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<FormikControl\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontrol=\"select\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"meter type?\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname={`astData.meter.type`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\toptions={formSelectOptions.meterTypeOptions}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t<FormikControl\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontrol=\"input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"manufacturer\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tname={`astData.astManufacturer`}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"row-5 form-row\">\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t\t<FormikControl\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontrol=\"input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"product name\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tname={`astData.astName`}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</FormSection>\n\n\t\t\t\t\t\t\t\t\t{/* meter location */}\n\t\t\t\t\t\t\t\t\t<FormSection\n\t\t\t\t\t\t\t\t\t\tsectionData={{\n\t\t\t\t\t\t\t\t\t\t\tsectionName: \"meterLocation\",\n\t\t\t\t\t\t\t\t\t\t\tformik: formik,\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tactive={active}\n\t\t\t\t\t\t\t\t\t\tsetActive={setActive}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<div className=\"form-row-wrapper\">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"row-2 form-row\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<FormikControl\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontrol=\"rgcButton\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"click for meter address\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname={`location.address`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Meter Address\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"row-50-50\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<FormikControl\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treadOnly={true}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontrol=\"input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"gps(lat)\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname={`location.gps.lat`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<FormikControl\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treadOnly={true}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontrol=\"input\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tlabel=\"gps(lng)\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tname={`location.gps.lng`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</FormSection>\n\n\n\n\n\n\n\t\t\t\t\t\t\t\t\t{formik.values.metadata.trnState === \"submitted\" ? (\n\t\t\t\t\t\t\t\t\t\t\"\"\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<FormFooter formik={formik} signState={response} />\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</Form>\n\t\t\t\t\t\t);\n\t\t\t\t\t}}\n\t\t\t\t</Formik>\n\t\t\t\t<MapReverseGeocodingApp geocoding={\"ast\"} />\n\t\t\t\t<MediaMobileWrapper\n\t\t\t\t\tdata={{\n\t\t\t\t\t\t...props.data,\n\t\t\t\t\t\tirepsKeyItem: \"trns\",\n\t\t\t\t\t\tdisplayMode: \"popup\",\n\t\t\t\t\t\ttrnId,\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t) : (\n\t\t<p>wait</p>\n\t);\n};\nexport default FormCheckin;\n"],"names":["FormCheckin","props","data","validationSchema","trnId","closeModal","useModal","active","setActive","useState","response","setDocument","useFirestore","trnState","setTrnState","_a","onSubmit","useCallback","values","useEffect","toast","jsxs","jsx","Formik","formik","updateFormState","Form","HeaderGeneric","FormCloseBtn","FormSection","FormikControl","formSelectOptions","FormFooter","MapReverseGeocodingApp","MediaMobileWrapper"],"mappings":"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"}