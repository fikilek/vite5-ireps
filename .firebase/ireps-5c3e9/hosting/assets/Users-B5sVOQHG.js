import{r as m,j as o,a5 as y,D as v,u as C,a6 as w,a7 as x,a8 as g,a9 as D,Y as E,n as M,m as N}from"./index-BjVKhCAv.js";import{M as j,C as U,A as T,T as S}from"./ag-theme-quartz-C9odMXne.js";j.registerModules([U]);const p=a=>{const{rowData:u,colDefs:s}=a,i=m.useMemo(()=>({sortable:!0,filter:!0,resizable:!0,floatingFilter:!0,suppressMovable:!0}),[]),t=d=>d.data.id,n={"row-disabled":d=>{var l;return(l=d==null?void 0:d.data)==null?void 0:l.disabled}};return o.jsx("div",{className:"ag-theme-quartz table table-users",children:o.jsx(T,{rowData:u,columnDefs:s,defaultColDef:i,pagination:!0,noRowsOverlayComponent:S,getRowId:t,rowClassRules:n,reactiveCustomComponents:!0})})},A=a=>{var b;const{roles:u}=(b=a==null?void 0:a.data)==null?void 0:b.customClaims,{customClaims:s,setCustomClaims:i}=m.useContext(y),[t,n]=m.useState({}),{uid:d}=a==null?void 0:a.data,l=s==null?void 0:s.uid;m.useEffect(()=>{d===l&&s.roles?n(s.roles):n(u)},[s]);const{openModal:e}=v(),{user:r}=C(),c=!!(d===r.uid||a.data.disabled),f=h=>{i({uid:d,roles:t}),e({modalName:"editUserRoles",payload:a.data})};return o.jsx("div",{className:"table-users-roles",children:w&&w.map(h=>{const R=t[h.key]?"hasRole":"";return o.jsx("button",{className:`table-btn ${R}`,title:h.name,disabled:c,onClick:f,children:h.abreviation},h.name)})})},k=a=>{const{value:u,options:s,onValueChange:i}=a,t=x(),n=g(t,"disableUserAcc"),d=l=>{i(l.target.value),a.api.redrawRows(),n({uid:a.data.uid,action:l.target.value==="disabled"}).then(e=>{D.success(`User acc [${a.data.displayName}] succesfully ${l.target.value==="disabled"?"DISABLED":"ENABLED"}  `,{position:"bottom-left"})}).catch(e=>{console.log("Error:",e.message)})};return o.jsx("div",{className:"table-user-acc-disable-select",children:o.jsx("select",{value:u,className:"table-btn",onChange:d,children:s&&s.map(l=>o.jsx("option",{value:l,children:l},l))})})},F=a=>{const[u,s]=m.useState([]),{user:i}=C(),{data:t}=E("users",null),n=x(),d=g(n,"listAllUsers");return m.useEffect(()=>{i&&d().then(e=>{var c;let r=[];(c=e==null?void 0:e.data)==null||c.forEach(f=>{const b=t.find(h=>f.uid===h.id);b&&r.push({...f,companyName:b.companyName,workbase:b.workbase,phoneNumber:b.phoneNumber})}),s(r)})},[t,i]),{usersTableFields:[{field:"uid",headerName:"users Id",width:250,hide:!0},{field:"disabled",headerName:"Acc Status?",width:150,editable:!0,cellEditor:k,cellEditorParams:{options:["enabled","disabled"]},valueGetter:e=>e.data.disabled?"disabled":"enabled",valueSetter:e=>(e.data.disabled=e.newValue==="disabled",!0),cellStyle:e=>{const{uid:r}=e.data;return r===i.uid?{color:"grey",fontWeight:"700",pointerEvents:"none",cursor:"none",borderLeft:"0.3rem solid grey"}:""}},{field:"workbase",headerName:"Workbase",width:180,cellRenderer:e=>o.jsx(M,{data:e,children:e.value}),cellRendererParams:{modalName:"workbases",width:"8rem"}},{field:"metadata.creationTime",headerName:"Date Created",width:180,cellRenderer:e=>{var c;const r=new Date((c=e.data.metadata)==null?void 0:c.creationTime);return o.jsx(N,{date:r,dateFormat:"yyyy-MMM-dd HH:mm"})}},{field:"metadata.lastSignInTime",headerName:"Last Signin",width:180,cellRenderer:e=>{var c;const r=new Date((c=e.data.metadata)==null?void 0:c.lastSignInTime);return o.jsx(N,{date:r,dateFormat:"yyyy-MMM-dd HH:mm"})}},{field:"displayName",headerName:"Display Name",width:170},{field:"email",headerName:"Email Adr",width:200},{field:"emailVerified",headerName:"Email Verified",width:150,cellRenderer:e=>o.jsx("p",{children:e.data.emailVerified?"Yes":"No"})},{field:"customClaims.roles",headerName:"Roles",width:220,cellRenderer:A,valueGetter:e=>e.value},{field:"phoneNumber",headerName:"Phone Number",width:150},{field:"companyName",headerName:"Company Name",width:170}],users:u}},B=()=>{const{usersTableFields:a,users:u}=F(),[s,i]=m.useState([]),{customClaims:t}=m.useContext(y);return m.useEffect(()=>{i(u)},[u]),m.useEffect(()=>{if(!t)return;const n=s.find(r=>r.uid===(t==null?void 0:t.uid)),d={...n,customClaims:{...n==null?void 0:n.customClaims,roles:t==null?void 0:t.roles}},l=s.findIndex(r=>r.uid===(t==null?void 0:t.uid));if(l===-1)return;const e=s==null?void 0:s.with(l,d);i(e)},[t]),o.jsx("div",{className:"table",children:o.jsx(p,{rowData:s,colDefs:a})})};export{B as default};
